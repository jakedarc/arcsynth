/*! For license information please see bundle.js.LICENSE.txt */
(()=>{var e,n,t,r,o={56:(e,n,t)=>{"use strict";e.exports=function(e){var n=t.nc;n&&e.setAttribute("nonce",n)}},72:e=>{"use strict";var n=[];function t(e){for(var t=-1,r=0;r<n.length;r++)if(n[r].identifier===e){t=r;break}return t}function r(e,r){for(var i={},a=[],c=0;c<e.length;c++){var s=e[c],l=r.base?s[0]+r.base:s[0],u=i[l]||0,d="".concat(l," ").concat(u);i[l]=u+1;var f=t(d),m={css:s[1],media:s[2],sourceMap:s[3],supports:s[4],layer:s[5]};if(-1!==f)n[f].references++,n[f].updater(m);else{var p=o(m,r);r.byIndex=c,n.splice(c,0,{identifier:d,updater:p,references:1})}a.push(d)}return a}function o(e,n){var t=n.domAPI(n);return t.update(e),function(n){if(n){if(n.css===e.css&&n.media===e.media&&n.sourceMap===e.sourceMap&&n.supports===e.supports&&n.layer===e.layer)return;t.update(e=n)}else t.remove()}}e.exports=function(e,o){var i=r(e=e||[],o=o||{});return function(e){e=e||[];for(var a=0;a<i.length;a++){var c=t(i[a]);n[c].references--}for(var s=r(e,o),l=0;l<i.length;l++){var u=t(i[l]);0===n[u].references&&(n[u].updater(),n.splice(u,1))}i=s}}},113:e=>{"use strict";e.exports=function(e,n){if(n.styleSheet)n.styleSheet.cssText=e;else{for(;n.firstChild;)n.removeChild(n.firstChild);n.appendChild(document.createTextNode(e))}}},314:e=>{"use strict";e.exports=function(e){var n=[];return n.toString=function(){return this.map(function(n){var t="",r=void 0!==n[5];return n[4]&&(t+="@supports (".concat(n[4],") {")),n[2]&&(t+="@media ".concat(n[2]," {")),r&&(t+="@layer".concat(n[5].length>0?" ".concat(n[5]):""," {")),t+=e(n),r&&(t+="}"),n[2]&&(t+="}"),n[4]&&(t+="}"),t}).join("")},n.i=function(e,t,r,o,i){"string"==typeof e&&(e=[[null,e,void 0]]);var a={};if(r)for(var c=0;c<this.length;c++){var s=this[c][0];null!=s&&(a[s]=!0)}for(var l=0;l<e.length;l++){var u=[].concat(e[l]);r&&a[u[0]]||(void 0!==i&&(void 0===u[5]||(u[1]="@layer".concat(u[5].length>0?" ".concat(u[5]):""," {").concat(u[1],"}")),u[5]=i),t&&(u[2]?(u[1]="@media ".concat(u[2]," {").concat(u[1],"}"),u[2]=t):u[2]=t),o&&(u[4]?(u[1]="@supports (".concat(u[4],") {").concat(u[1],"}"),u[4]=o):u[4]="".concat(o)),n.push(u))}},n}},365:(e,n,t)=>{"use strict";t.d(n,{A:()=>c});var r=t(601),o=t.n(r),i=t(314),a=t.n(i)()(o());a.push([e.id,'/* Global Styles */\n\n:root {\n    --color-primary: #4a90e2;\n    --color-primary-hover: #357abd;\n    --color-secondary: #6c757d;\n    --color-secondary-hover: #5a6268;\n    --color-success: #28a745;\n    --color-success-hover: #218838;\n    --color-danger: #e74c3c;\n    --bg-primary: #1a1a1a;\n    --bg-secondary: #2a2a2a;\n    --bg-tertiary: #3a3a3a;\n    --border-color: #3a3a3a;\n    --border-color-light: #4a4a4a;\n    --text-primary: #fff;\n    --text-secondary: #ccc;\n    --text-muted: #888;\n    --scrollbar-track: #2a2a2a;\n    --scrollbar-thumb: #4a4a4a;\n    --scrollbar-thumb-hover: #5a5a5a;\n    --spacing-xs: 0.25rem;\n    --spacing-sm: 0.5rem;\n    --spacing-md: 1rem;\n    --spacing-lg: 1.5rem;\n    --spacing-xl: 2rem;\n    --border-radius-sm: 3px;\n    --border-radius: 4px;\n    --border-radius-lg: 6px;\n    --border-radius-xl: 8px;\n    --font-size-xs: 0.7rem;\n    --font-size-sm: 0.8rem;\n    --font-size-md: 0.9rem;\n    --font-size-base: 1rem;\n    --font-size-lg: 1.1rem;\n    --font-size-xl: 1.2rem;\n}\n\n* {\n    margin: 0;\n    padding: 0;\n    box-sizing: border-box;\n    scrollbar-width: thin;\n    scrollbar-color: var(--scrollbar-thumb) var(--scrollbar-track);\n}\n\nbody {\n    font-family: -apple-system, BlinkMacSystemFont, \'Segoe UI\', Roboto, sans-serif;\n    background: var(--bg-primary);\n    color: var(--text-primary);\n    height: 100vh;\n    overflow: hidden;\n}\n\n/* Scrollbars */\n::-webkit-scrollbar {\n    width: 8px;\n    height: 8px;\n}\n\n::-webkit-scrollbar-track {\n    background: var(--scrollbar-track);\n    border-radius: var(--border-radius);\n}\n\n::-webkit-scrollbar-thumb {\n    background: var(--scrollbar-thumb);\n    border-radius: var(--border-radius);\n    border: 1px solid var(--border-color);\n}\n\n::-webkit-scrollbar-thumb:hover {\n    background: var(--scrollbar-thumb-hover);\n}\n\n::-webkit-scrollbar-corner {\n    background: var(--scrollbar-track);\n}\n\n/* Layout */\n\n#app {\n    display: flex;\n    flex-direction: column;\n    height: 100vh;\n}\n\n.header {\n    display: flex;\n    justify-content: space-between;\n    align-items: center;\n    padding: var(--spacing-md) var(--spacing-xl);\n    background: var(--bg-secondary);\n    border-bottom: 1px solid var(--border-color);\n}\n\n.header h1 {\n    font-size: 1.5rem;\n    font-weight: 300;\n}\n\n.header-controls {\n    display: flex;\n    align-items: center;\n    gap: 1rem;\n}\n\n.main-content {\n    display: flex;\n    flex: 1;\n    overflow: hidden;\n}\n\n.tab-nav {\n    width: 200px;\n    background: var(--bg-secondary);\n    border-right: 1px solid var(--border-color);\n    overflow-y: auto;\n}\n\n.editor-area {\n    flex: 1;\n    overflow-y: auto;\n    padding: var(--spacing-xl);\n}\n\n#content-container:focus {\n    outline: none;\n}\n\n/* Components */\n\n/* Buttons */\nbutton {\n    background: var(--color-primary);\n    color: var(--text-primary);\n    border: none;\n    padding: var(--spacing-sm) var(--spacing-md);\n    border-radius: var(--border-radius);\n    cursor: pointer;\n    font-size: var(--font-size-md);\n    font-weight: 400;\n    transition: background 0.2s;\n}\n\n.btn-secondary {\n    background: var(--color-secondary);\n}\n\n.btn-success {\n    background: var(--color-success);\n}\n\n.program-buttons button {\n    margin-right: var(--spacing-sm);\n}\n\n/* Tabs */\n.tab {\n    display: block;\n    width: 100%;\n    padding: 1rem;\n    background: none;\n    border: none;\n    color: #ccc;\n    text-align: left;\n    cursor: pointer;\n    border-bottom: 1px solid #3a3a3a;\n    transition: background 0.2s;\n}\n\n.nav-buttons {\n    display: flex;\n    flex-direction: column;\n    gap: 0.5rem;\n    margin: 1rem;\n}\n\n/* Sections */\n.section {\n    margin-bottom: var(--spacing-xl);\n    padding: var(--spacing-lg);\n    background: var(--bg-secondary);\n    border-radius: var(--border-radius-xl);\n}\n\n.section h3 {\n    margin-bottom: var(--spacing-md);\n    font-weight: 400;\n    color: var(--color-primary);\n}\n\n.subsection {\n    margin-top: var(--spacing-lg);\n    border-top: 1px solid var(--border-color);\n    padding-top: var(--spacing-md);\n}\n\n.subsection-header {\n    display: flex;\n    align-items: center;\n    cursor: pointer;\n    margin-bottom: 1rem;\n    user-select: none;\n}\n\n.subsection-header h4 {\n    margin: 0;\n    font-weight: 400;\n    color: var(--text-secondary);\n    font-size: var(--font-size-md);\n}\n\n.subsection-toggle {\n    margin-right: var(--spacing-sm);\n    color: var(--text-muted);\n    transition: transform 0.2s;\n    font-size: var(--font-size-sm);\n}\n\n.subsection-content {\n    overflow: hidden;\n    transition: max-height 0.3s ease-out;\n}\n\n/* Controls */\n.controls-grid {\n    display: grid;\n    grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));\n    gap: 1rem;\n}\n\n.control {\n    display: flex;\n    flex-direction: column;\n    align-items: center;\n    padding: var(--spacing-md);\n    background: var(--bg-primary);\n    border-radius: var(--border-radius-lg);\n    border: 1px solid var(--border-color);\n}\n\n.control-label {\n    margin-bottom: var(--spacing-sm);\n    font-size: var(--font-size-md);\n    text-align: center;\n}\n\n.control-input {\n    width: 100%;\n    background: var(--bg-tertiary);\n    border: 1px solid var(--border-color-light);\n    color: var(--text-primary);\n    padding: var(--spacing-sm);\n    border-radius: var(--border-radius);\n    text-align: center;\n}\n\n/* Knobs */\n.knob {\n    width: 60px;\n    height: 60px;\n    border-radius: 50%;\n    background: var(--bg-tertiary);\n    border: 3px solid var(--color-primary);\n    position: relative;\n    cursor: pointer;\n}\n\n.knob::after {\n    content: \'\';\n    position: absolute;\n    top: 5px;\n    left: 50%;\n    width: 2px;\n    height: 20px;\n    background: var(--color-primary);\n    transform-origin: bottom;\n    transform: translateX(-50%);\n}\n\n.knob-text-display {\n    background: none;\n    border: none;\n    padding: 0.25rem;\n    font-size: 12px;\n    min-width: 60px;\n    overflow-wrap: break-word;\n}\n\n/* Sliders */\n.slider {\n    width: 100%;\n    height: 6px;\n    border-radius: var(--border-radius-sm);\n    background: var(--bg-tertiary);\n    outline: none;\n}\n\n.slider::-webkit-slider-thumb {\n    appearance: none;\n    width: 18px;\n    height: 18px;\n    border-radius: 50%;\n    background: var(--color-primary);\n    cursor: pointer;\n}\n\n.slider::-moz-range-thumb {\n    width: 18px;\n    height: 18px;\n    border-radius: 50%;\n    background: var(--color-primary);\n    cursor: pointer;\n    border: none;\n}\n\n/* Modals */\n.modal {\n    position: fixed;\n    top: 0;\n    left: 0;\n    width: 100%;\n    height: 100%;\n    background: rgb(0 0 0 / 80%);\n    display: flex;\n    justify-content: center;\n    align-items: center;\n    z-index: 1000;\n}\n\n.modal-content {\n    background: #2a2a2a;\n    border-radius: 8px;\n    width: 95vw;\n    max-width: 1400px;\n    height: 85vh;\n    max-height: 900px;\n    display: flex;\n    flex-direction: column;\n    box-shadow: 0 4px 20px rgb(0 0 0 / 50%);\n}\n\n.modal-header {\n    display: flex;\n    justify-content: space-between;\n    align-items: center;\n    padding: 1rem;\n    border-bottom: 1px solid #444;\n    background: #333;\n    border-radius: 8px 8px 0 0;\n}\n\n.modal-header h2 {\n    margin: 0;\n    color: #f0f0f0;\n    font-size: 1.2rem;\n}\n\n.close-modal {\n    background: none;\n    border: none;\n    color: #ccc;\n    font-size: 1.5rem;\n    cursor: pointer;\n    padding: 0.25rem 0.5rem;\n    border-radius: 4px;\n    transition: background 0.2s;\n}\n\n.modal-body {\n    flex: 1;\n    overflow: hidden;\n    padding: 1rem;\n}\n\n/* Notifications */\n.notification-container {\n    position: fixed;\n    top: 20px;\n    right: 20px;\n    z-index: 2000;\n    display: flex;\n    flex-direction: column;\n    gap: 10px;\n}\n\n.notification {\n    background: #333;\n    color: #fff;\n    padding: 12px 16px;\n    border-radius: 6px;\n    border-left: 4px solid #e74c3c;\n    box-shadow: 0 4px 12px rgb(0 0 0 / 30%);\n    min-width: 250px;\n    max-width: 350px;\n    font-size: 0.9rem;\n    opacity: 0;\n    transform: translateX(100%);\n    transition: all 0.3s ease-in-out;\n}\n\n/* Status Messages */\n.status-message {\n    padding: 10px;\n    border-radius: 4px;\n    margin-top: 10px;\n    font-size: 0.9rem;\n}\n\n/* Specific Areas */\n\n/* Welcome */\n.welcome {\n    text-align: center;\n    margin-top: 4rem;\n}\n\n.welcome h2 {\n    margin-bottom: 1rem;\n    font-weight: 300;\n}\n\n.welcome p {\n    margin-bottom: 2rem;\n    opacity: 0.8;\n}\n\n.welcome-actions {\n    display: flex;\n    justify-content: center;\n    gap: 1rem;\n}\n\n/* MIDI Status */\n.midi-status {\n    display: flex;\n    align-items: center;\n    gap: 1rem;\n}\n\n#midi-status {\n    font-size: 0.9rem;\n    opacity: 0.8;\n}\n\n/* ADSR */\n.adsr-display {\n    padding: 0.5rem;\n    grid-column: span 2;\n}\n\n.adsr-display svg {\n    border-radius: 4px;\n}\n\n/* Mod Matrix */\n.mod-matrix-grid {\n    display: grid;\n    grid-template-columns: auto 1fr 1fr 1fr 1fr;\n    gap: 0.5rem;\n    align-items: center;\n    background: #1e1e1e;\n    border: 1px solid #3a3a3a;\n    border-radius: 4px;\n    padding: 1rem;\n    grid-column: span 4;\n}\n\n.mod-matrix-header,\n.mod-matrix-slot-label {\n    color: #ccc;\n    padding: 0.5rem;\n    text-align: center;\n    font-weight: 500;\n    font-size: 0.8rem;\n    border-radius: 3px;\n}\n\n.mod-matrix-header {\n    background: #3a3a3a;\n}\n\n.mod-matrix-slot-label {\n    background: #2a2a2a;\n    min-width: 40px;\n}\n\n\n/* MIDI Monitor */\n.midi-monitor {\n    position: fixed;\n    bottom: 0;\n    right: 0;\n    width: 400px;\n    max-height: 300px;\n    background: #2a2a2a;\n    border: 1px solid #3a3a3a;\n    border-bottom: none;\n    border-right: none;\n    z-index: 1000;\n}\n\n.midi-monitor-header {\n    display: flex;\n    justify-content: space-between;\n    align-items: center;\n    padding: 0.5rem 1rem;\n    background: #3a3a3a;\n    border-bottom: 1px solid #4a4a4a;\n}\n\n.midi-monitor-header h3 {\n    font-size: 0.9rem;\n    font-weight: 400;\n    margin: 0;\n}\n\n.midi-monitor-controls {\n    display: flex;\n    align-items: center;\n    gap: 0.5rem;\n}\n\n.midi-monitor-controls button {\n    padding: 0.25rem 0.5rem;\n    font-size: 0.8rem;\n}\n\n.midi-monitor-content {\n    height: 250px;\n    overflow-y: auto;\n    padding: 0.5rem;\n}\n\n#midi-log {\n    font-family: Consolas, Monaco, monospace;\n    font-size: 0.8rem;\n    line-height: 1.3;\n}\n\n.midi-message {\n    margin-bottom: 0.25rem;\n    padding: 0.25rem;\n    border-radius: 3px;\n    word-break: break-all;\n}\n\n.midi-timestamp {\n    color: #888;\n    font-size: 0.75rem;\n}\n\n.midi-data {\n    color: #ccc;\n}\n\n.midi-direction {\n    font-weight: bold;\n}\n\n.midi-raw {\n    color: #999;\n    font-size: 0.7rem;\n}\n\n/* MIDI Tester */\n.midi-tester-container {\n    display: grid;\n    grid-template-columns: 1.2fr 0.8fr;\n    gap: 2rem;\n    height: 100%;\n    min-height: 0;\n}\n\n.midi-tester-panel,\n.midi-monitor-panel {\n    background: #333;\n    border-radius: 8px;\n    padding: 1rem;\n    display: flex;\n    flex-direction: column;\n    height: 100%;\n    overflow: hidden;\n    min-height: 0;\n}\n\n.midi-tester-panel {\n    overflow-y: auto;\n}\n\n.midi-tester-panel h3,\n.midi-monitor-panel h3 {\n    margin: 0 0 1rem;\n    color: #f0f0f0;\n    font-size: 1.1rem;\n}\n\n.tester-tabs {\n    display: flex;\n    gap: 0.25rem;\n    margin-bottom: 1rem;\n    border-bottom: 1px solid #444;\n}\n\n.tester-tab {\n    background: #444;\n    border: none;\n    color: #ccc;\n    padding: 0.5rem 1rem;\n    cursor: pointer;\n    border-radius: 4px 4px 0 0;\n    transition: all 0.2s;\n    font-size: 0.9rem;\n}\n\n.tester-content {\n    display: none;\n    flex: 1;\n    overflow-y: auto;\n    min-height: 0;\n}\n\n.tester-row {\n    display: flex;\n    align-items: center;\n    gap: 1rem;\n    margin-bottom: 1rem;\n    flex-wrap: wrap;\n}\n\n.tester-row label {\n    color: #ccc;\n    font-size: 0.9rem;\n    min-width: 80px;\n    display: block;\n    margin-bottom: 5px;\n    font-weight: 500;\n}\n\n.tester-row input[type="number"],\n.tester-row input[type="range"],\n.tester-row select,\n.tester-row textarea {\n    background: #444;\n    border: 1px solid #555;\n    border-radius: 4px;\n    color: #fff;\n    padding: 0.5rem;\n    font-size: 0.9rem;\n}\n\n.tester-row input[type="number"] {\n    width: 80px;\n}\n\n.tester-row input[type="range"] {\n    flex: 1;\n    min-width: 200px;\n}\n\n.tester-row textarea {\n    font-family: monospace;\n    resize: vertical;\n    flex: 1;\n    width: 100%;\n    box-sizing: border-box;\n}\n\n.tester-row small {\n    color: #999;\n    font-size: 0.8rem;\n    width: 100%;\n}\n\n.sysex-row {\n    flex-direction: column;\n    align-items: stretch;\n}\n\n.sysex-row label {\n    min-width: auto;\n    margin-bottom: 0.5rem;\n}\n\n.monitor-header {\n    display: flex;\n    justify-content: space-between;\n    align-items: center;\n    margin-bottom: 1rem;\n}\n\n.monitor-controls {\n    display: flex;\n    align-items: center;\n    gap: 1rem;\n}\n\n.monitor-controls button {\n    background: #6c757d;\n    padding: 0.5rem 1rem;\n    font-size: 0.9rem;\n}\n\n.monitor-checkbox {\n    display: flex;\n    align-items: center;\n    gap: 0.25rem;\n    font-size: 0.8rem;\n    color: #ccc;\n    cursor: pointer;\n}\n\n.monitor-checkbox input[type="checkbox"] {\n    margin: 0;\n    cursor: pointer;\n}\n\n.modal-midi-log {\n    background: #1a1a1a;\n    border: 1px solid #444;\n    border-radius: 4px;\n    padding: 0.5rem;\n    flex: 1;\n    min-height: 0;\n    overflow-y: auto;\n    font-family: Consolas, Monaco, monospace;\n    font-size: 0.8rem;\n    line-height: 1.3;\n    color: #ccc;\n}\n\n.midi-log-entry {\n    margin-bottom: 0.25rem;\n}\n\n/* SysEx Mapper */\n.baseline-controls {\n    display: flex;\n    gap: 10px;\n    margin-top: 10px;\n}\n\n.param-test-section label {\n    display: block;\n    margin-bottom: 5px;\n    font-weight: 500;\n}\n\n/* States & Modifiers */\n\n/* Button States */\n\n/* Button States */\nbutton:hover {\n    background: var(--color-primary-hover);\n}\n\nbutton:disabled {\n    background: var(--color-secondary);\n    cursor: not-allowed;\n}\n\nbutton:focus {\n    outline: none;\n}\n\nbutton:focus-visible {\n    outline: 2px solid var(--color-primary);\n    outline-offset: 2px;\n}\n\n.btn-secondary:hover {\n    background: var(--color-secondary-hover);\n}\n\n.btn-success:hover {\n    background: var(--color-success-hover);\n}\n\n#receive-baseline.disabled,\n#receive-baseline:disabled {\n    background: #666;\n    opacity: 0.6;\n    cursor: not-allowed;\n}\n\n#receive-baseline.disabled:hover,\n#receive-baseline:disabled:hover {\n    background: #666;\n    transform: none;\n}\n\n/* Button Modifiers */\n.btn-large {\n    padding: 1rem 2rem;\n    font-size: 1rem;\n    font-weight: 500;\n    border-radius: 6px;\n}\n\n.btn-active {\n    transform: translateY(1px);\n}\n\n.btn-active-success {\n    background: #27ae60;\n    box-shadow: 0 0 10px rgb(39 174 96 / 30%);\n}\n\n.btn-active-danger {\n    background: #e74c3c;\n    box-shadow: 0 0 10px rgb(231 76 60 / 30%);\n}\n\n/* Tab States */\n.tab:hover {\n    background: #3a3a3a;\n}\n\n.tab.active {\n    background: #4a90e2;\n    color: #fff;\n}\n\n/* Subsection States */\n.subsection-toggle.expanded {\n    transform: rotate(90deg);\n}\n\n.subsection-content.collapsed {\n    max-height: 0;\n}\n\n.subsection-content.expanded {\n    max-height: 1000px; /* Adjust as needed */\n}\n\n/* Modal States */\n.modal.hidden {\n    display: none;\n}\n\n.close-modal:hover {\n    background: #555;\n    color: #fff;\n}\n\n/* Notification States */\n.notification.show {\n    opacity: 1;\n    transform: translateX(0);\n}\n\n.notification.success {\n    border-left-color: #27ae60;\n}\n\n.notification.info {\n    border-left-color: #4a90e2;\n}\n\n.notification.warning {\n    border-left-color: #f39c12;\n}\n\n.notification.error {\n    border-left-color: #e74c3c;\n}\n\n/* Status States */\n.status-message.success {\n    background: rgb(39 174 96 / 10%);\n    border: 1px solid #27ae60;\n    color: #27ae60;\n}\n\n.status-message.info {\n    background: rgb(74 144 226 / 10%);\n    border: 1px solid #4a90e2;\n    color: #4a90e2;\n}\n\n.status-message.error {\n    background: rgb(231 76 60 / 10%);\n    border: 1px solid #e74c3c;\n    color: #e74c3c;\n}\n\n/* MIDI States */\n.midi-message.outgoing {\n    background: rgb(74 144 226 / 10%);\n    border-left: 3px solid #4a90e2;\n}\n\n.midi-message.incoming {\n    background: rgb(81 207 102 / 10%);\n    border-left: 3px solid #51cf66;\n}\n\n.midi-message.outgoing .midi-direction {\n    color: #4a90e2;\n}\n\n.midi-message.incoming .midi-direction {\n    color: #51cf66;\n}\n\n/* Tester States */\n.midi-monitor-content.hidden {\n    display: none;\n}\n\n.tester-tab:hover {\n    background: #555;\n    color: #fff;\n}\n\n.tester-tab.active {\n    background: #4a90e2;\n    color: #fff;\n}\n\n.tester-content.active {\n    display: block;\n}\n\n/* Utilities */\n\n.flex-column {\n    display: flex;\n    flex-direction: column;\n}\n\n.flex-column-center {\n    display: flex;\n    flex-direction: column;\n    align-items: center;\n}\n\n.flex-column-center-gap {\n    display: flex;\n    flex-direction: column;\n    align-items: center;\n    gap: var(--spacing-sm);\n}\n\n.flex-row {\n    display: flex;\n    flex-direction: row;\n}\n\n.flex-row-center {\n    display: flex;\n    flex-direction: row;\n    align-items: center;\n}\n\n.dialog-overlay {\n    position: fixed;\n    top: 0;\n    left: 0;\n    width: 100%;\n    height: 100%;\n    background-color: rgb(0 0 0 / 70%);\n    display: flex;\n    justify-content: center;\n    align-items: center;\n    z-index: 10000;\n}\n\n.dialog-content {\n    background: var(--bg-secondary);\n    padding: 20px;\n    border-radius: var(--border-radius-xl);\n    color: var(--text-primary);\n    min-width: 400px;\n}\n\n.btn-margin-top {\n    margin-top: var(--spacing-md);\n}\n\n.gap-sm {\n    gap: var(--spacing-sm);\n}\n\n.gap-md {\n    gap: var(--spacing-md);\n}\n\n.text-center {\n    text-align: center;\n}\n\n.font-mono {\n    font-family: Consolas, Monaco, monospace;\n}',""]);const c=a},501:()=>{function e(e,n){return function(e){if(Array.isArray(e))return e}(e)||function(e,n){var t=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=t){var r,o,i,a,c=[],s=!0,l=!1;try{if(i=(t=t.call(e)).next,0===n){if(Object(t)!==t)return;s=!1}else for(;!(s=(r=i.call(t)).done)&&(c.push(r.value),c.length!==n);s=!0);}catch(e){l=!0,o=e}finally{try{if(!s&&null!=t.return&&(a=t.return(),Object(a)!==a))return}finally{if(l)throw o}}return c}}(e,n)||o(e,n)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function n(e,n){var t="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!t){if(Array.isArray(e)||(t=o(e))||n&&e&&"number"==typeof e.length){t&&(e=t);var r=0,i=function(){};return{s:i,n:function(){return r>=e.length?{done:!0}:{done:!1,value:e[r++]}},e:function(e){throw e},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var a,c=!0,s=!1;return{s:function(){t=t.call(e)},n:function(){var e=t.next();return c=e.done,e},e:function(e){s=!0,a=e},f:function(){try{c||null==t.return||t.return()}finally{if(s)throw a}}}}function t(e){return t="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},t(e)}function r(e){return function(e){if(Array.isArray(e))return i(e)}(e)||function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(e)||o(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function o(e,n){if(e){if("string"==typeof e)return i(e,n);var t={}.toString.call(e).slice(8,-1);return"Object"===t&&e.constructor&&(t=e.constructor.name),"Map"===t||"Set"===t?Array.from(e):"Arguments"===t||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(t)?i(e,n):void 0}}function i(e,n){(null==n||n>e.length)&&(n=e.length);for(var t=0,r=Array(n);t<n;t++)r[t]=e[t];return r}function a(e,n){for(var t=0;t<n.length;t++){var r=n[t];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,c(r.key),r)}}function c(e){var n=function(e){if("object"!=t(e)||!e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,"string");if("object"!=t(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"==t(n)?n:n+""}var s=function(){return o=function e(){!function(e,n){if(!(e instanceof n))throw new TypeError("Cannot call a class as a function")}(this,e),this.currentConfig=null,this.currentTab=null,this.controlValues=new Map,this.subsectionStates=new Map,this.helpMode=!1,this.currentTooltip=null,this.boundHandleControlMouseEnter=this.handleControlMouseEnter.bind(this),this.boundHandleControlMouseLeave=this.handleControlMouseLeave.bind(this)},i=[{key:"loadConfig",value:function(e){this.currentConfig=e,this.controlValues.clear(),this.savedPatchName=void 0,this.createTabs(),e.tabs&&e.tabs.length>0&&this.showTab(e.tabs[0].id),e.midiChannel&&window.midiManager.setChannel(e.midiChannel);var n=document.getElementById("get-patch");n&&(n.style.display="block");var t=document.getElementById("reset-all-defaults");t&&(t.style.display="block");var r=document.getElementById("send-all-parameters");r&&(r.style.display="block")}},{key:"initializeAllControlValues",value:function(){var e=this;this.currentConfig&&this.currentConfig.tabs&&this.currentConfig.tabs.forEach(function(n){n.sections&&n.sections.forEach(function(n){n.controls&&Array.isArray(n.controls)&&n.controls.forEach(function(n){if(n.id&&!e.controlValues.has(n.id)){var t=e.calculateDefaultValue(n);e.controlValues.set(n.id,t)}}),n.template&&e.expandTemplate(n.template).forEach(function(n){if(n.id&&!e.controlValues.has(n.id)){var t=e.calculateDefaultValue(n);e.controlValues.set(n.id,t)}}),n.subsections&&Array.isArray(n.subsections)&&n.subsections.forEach(function(n){n.controls&&Array.isArray(n.controls)&&n.controls.forEach(function(n){if(n.id&&!e.controlValues.has(n.id)){var t=e.calculateDefaultValue(n);e.controlValues.set(n.id,t)}})})})})}},{key:"createTabs",value:function(){var e=this,n=document.getElementById("tab-container");n.innerHTML="",this.currentConfig&&this.currentConfig.tabs&&this.currentConfig.tabs.forEach(function(t){var r=document.createElement("button");r.className="tab",r.textContent=t.name,r.dataset.tabId=t.id,r.onclick=function(){return e.showTab(t.id)},n.appendChild(r)})}},{key:"showTab",value:function(e){var n=this.currentConfig.tabs.find(function(n){return n.id===e});if(n){document.getElementById("editor-area").scrollTop=0,this.currentTab=n,document.querySelectorAll(".tab").forEach(function(e){return e.classList.remove("active")});var t=document.querySelector('button[data-tab-id="'.concat(e,'"]'));t&&t.classList.add("active"),this.renderTabContent(n)}}},{key:"renderTabContent",value:function(e){var n=this,t=document.getElementById("content-container");if(t.innerHTML="",e.sections){e.sections.forEach(function(e){var r=n.createSection(e);t.appendChild(r)}),this.helpMode&&this.addHelpEventListeners();var r=this.controlValues.get("patch_name");void 0!==r&&this.updatePatchNameUnsavedIndicator(r)}}},{key:"createSection",value:function(e){var n=this,t=document.createElement("div");t.className="section";var r=document.createElement("h3");if(r.textContent=e.name,t.appendChild(r),e.controls){var o=document.createElement("div");o.className=e.template||"table"===e.layout?"mod-matrix-grid":"controls-grid",e.controls.forEach(function(e){var t=n.createControl(e);o.appendChild(t)}),t.appendChild(o)}if(e.template){var i=document.createElement("div");i.className="mod-matrix-grid",this.expandTemplate(e.template).forEach(function(e){var t=n.createControl(e);i.appendChild(t)}),t.appendChild(i)}return e.subsections&&e.subsections.forEach(function(r){var o=n.createSubsection(r,e.id);t.appendChild(o)}),t}},{key:"createSubsection",value:function(e,n){var t,r=this,o=document.createElement("div");o.className="subsection";var i=e.id||"".concat(n,"_").concat(e.name.replace(/\s+/g,"_").toLowerCase()),a="".concat(this.currentTab.id,"_").concat(i),c=document.createElement("div");c.className="subsection-header";var s=document.createElement("span");s.className="subsection-toggle",s.textContent="▶";var l=document.createElement("h4");l.textContent=e.name,c.appendChild(s),c.appendChild(l),o.appendChild(c);var u=document.createElement("div");if(u.className="subsection-content collapsed",null!==(t=this.subsectionStates.get(a))&&void 0!==t&&t&&(u.classList.remove("collapsed"),u.classList.add("expanded"),s.classList.add("expanded")),e.controls){var d=document.createElement("div");d.className="controls-grid",e.controls.forEach(function(e){var n=r.createControl(e);d.appendChild(n)}),u.appendChild(d)}return o.appendChild(u),c.addEventListener("click",function(){u.classList.contains("expanded")?(u.classList.remove("expanded"),u.classList.add("collapsed"),s.classList.remove("expanded"),r.subsectionStates.set(a,!1)):(u.classList.remove("collapsed"),u.classList.add("expanded"),s.classList.add("expanded"),r.subsectionStates.set(a,!0))}),o}},{key:"getControlClass",value:function(e){return e.readonly&&"text"===e.type?"Slot"===e.value||"Source 1"===e.value||"Source 2"===e.value||"Destination"===e.value||"FX Destination"===e.value||"Depth"===e.value?"mod-matrix-header":"mod-matrix-slot-label":"control"}},{key:"createControl",value:function(e){var n=document.createElement("div");n.className=this.getControlClass(e);var t,r=this.getControlClass(e);if(!r.includes("header")&&!r.includes("slot-label")){var o=document.createElement("div");o.className="control-label",o.textContent=e.name,n.appendChild(o)}switch(e.type){case"knob":t=this.createKnob(e);break;case"slider":default:t=this.createSlider(e);break;case"select":t=this.createSelect(e);break;case"button":t=this.createButton(e);break;case"text":t=this.createTextInput(e);break;case"adsr_display":t=this.createADSRDisplay(e)}if(n.appendChild(t),e.unit){var i=document.createElement("div");i.className="control-unit",i.textContent=e.unit,n.appendChild(i)}return n}},{key:"createKnob",value:function(e){var n,t=this,r=document.createElement("div");r.className="flex-column-center-gap";var o=document.createElement("div");o.className="knob",o._controlConfig=e,e.midi&&"cc"===e.midi.type&&void 0!==e.midi.number?o.setAttribute("data-cc",e.midi.number):e.midi&&"cc_pair"===e.midi.type&&void 0!==e.midi.msb&&void 0!==e.midi.lsb?o.setAttribute("data-cc-pair","".concat(e.midi.msb,",").concat(e.midi.lsb)):e.midi&&"nrpn"===e.midi.type&&void 0!==e.midi.msb&&void 0!==e.midi.lsb&&o.setAttribute("data-nrpn","".concat(e.midi.msb,":").concat(e.midi.lsb));var i=null!==(n=this.controlValues.get(e.id))&&void 0!==n?n:this.calculateDefaultValue(e),a=(i-(e.min||0))/((e.max||127)-(e.min||0))*100/100*270-135;o.style.transform="rotate(".concat(a,"deg)"),this.controlValues.set(e.id,i);var c=document.createElement("input");c.type="number",c.className="control-input";var s=this.convertInternalToDisplay(e,i);c.value=s,c.min=e.displayMin||e.min||0,c.max=e.displayMax||e.max||127,c.step=e.displayStep||e.step||1;var l=!1,u=0,d=i;o.addEventListener("mousedown",function(e){l=!0,u=e.clientY,d=parseFloat(c.value),document.addEventListener("mousemove",f),document.addEventListener("mouseup",m),e.preventDefault()});var f=function(n){var r,i;if(l){var a,s=u-n.clientY,f=e.displayMin||e.min||0,m=e.displayMax||e.max||127,p=m-f,v=e.displayStep||e.step||1;a="cc_pair"===(null===(r=e.midi)||void 0===r?void 0:r.type)||v<1?p>200?p/150:Math.min(v,1):p/100;var h=Math.max(f,Math.min(m,d+s*a)),y=(null===(i=v.toString().split(".")[1])||void 0===i?void 0:i.length)||0;h=Math.round(h/v)*v,h=Number(h.toFixed(y));var g=t.convertDisplayToInternal(e,h);g!==t.controlValues.get(e.id)&&t.updateControlValue(e,g,o,c)}},m=function(){l=!1,document.removeEventListener("mousemove",f),document.removeEventListener("mouseup",m)};return c.addEventListener("input",function(n){var r=parseFloat(n.target.value),i=e.displayMin||e.min||0,a=e.displayMax||e.max||127;if(!isNaN(r)&&r>=i&&r<=a){var s,l=e.displayStep||e.step||1,u=(null===(s=l.toString().split(".")[1])||void 0===s?void 0:s.length)||0;r=Math.round(r/l)*l,r=Number(r.toFixed(u));var d=t.convertDisplayToInternal(e,r);t.updateControlValue(e,d,o,c)}}),o.addEventListener("dblclick",function(){var n=t.calculateDefaultValue(e);t.updateControlValue(e,n,o,c)}),r.appendChild(o),r.appendChild(c),r}},{key:"createSlider",value:function(e){var n,t=this,r=document.createElement("div");r.className="flex-column-center-gap",r.style.width="100%";var o=document.createElement("input");o.type="range",o.className="slider",o.min=e.min||0,o.max=e.max||127,o.step=e.step||1,o._controlConfig=e,e.midi&&"cc"===e.midi.type&&void 0!==e.midi.number?o.setAttribute("data-cc",e.midi.number):e.midi&&"cc_pair"===e.midi.type&&void 0!==e.midi.msb&&void 0!==e.midi.lsb?o.setAttribute("data-cc-pair","".concat(e.midi.msb,",").concat(e.midi.lsb)):e.midi&&"nrpn"===e.midi.type&&void 0!==e.midi.msb&&void 0!==e.midi.lsb&&o.setAttribute("data-nrpn","".concat(e.midi.msb,":").concat(e.midi.lsb));var i=null!==(n=this.controlValues.get(e.id))&&void 0!==n?n:this.calculateDefaultValue(e);o.value=i,this.controlValues.set(e.id,i);var a=document.createElement("input");return a.type="number",a.className="control-input",a.value=i,a.min=e.min||0,a.max=e.max||127,a.step=e.step||1,a.style.width="80px",a.classList.add("text-center"),o.addEventListener("input",function(n){var r=parseFloat(n.target.value);a.value=r,t.updateControlValue(e,r)}),a.addEventListener("input",function(n){var r=parseFloat(n.target.value);if(!isNaN(r)&&r>=(e.min||0)&&r<=(e.max||127)){var i,a=e.step||1,c=(null===(i=a.toString().split(".")[1])||void 0===i?void 0:i.length)||0;r=Math.round(r/a)*a,r=Number(r.toFixed(c)),o.value=r,t.updateControlValue(e,r)}}),o.addEventListener("dblclick",function(){var n=t.calculateDefaultValue(e);o.value=n,a.value=n,t.updateControlValue(e,n)}),r.appendChild(o),r.appendChild(a),r}},{key:"createSelectAsKnob",value:function(e){var n,t=this,o=document.createElement("div");o.className="flex-column-center-gap";var i=document.createElement("div");i.className="knob",i._controlConfig=e,e.midi&&"cc"===e.midi.type&&void 0!==e.midi.number?i.setAttribute("data-cc",e.midi.number):e.midi&&"cc_pair"===e.midi.type&&void 0!==e.midi.msb&&void 0!==e.midi.lsb?i.setAttribute("data-cc-pair","".concat(e.midi.msb,",").concat(e.midi.lsb)):e.midi&&"nrpn"===e.midi.type&&void 0!==e.midi.msb&&void 0!==e.midi.lsb&&i.setAttribute("data-nrpn","".concat(e.midi.msb,":").concat(e.midi.lsb));var a=[],c=[];if(e.options)a=r(e.options),c=e.midiValues?r(e.midiValues):e.options.map(function(e,n){return n});else for(var s=e.min||0,l=e.max||127,u=s;u<=l;u++)a.push(u.toString()),c.push(u);var d=null!==(n=this.controlValues.get(e.id))&&void 0!==n?n:this.calculateDefaultValue(e),f=c.indexOf(d),m=f/(a.length-1)*100/100*270-135;i.style.transform="rotate(".concat(m,"deg)"),this.controlValues.set(e.id,d);var p=document.createElement("div");p.className="control-input knob-text-display",p.classList.add("text-center"),p.style.minHeight="20px",p.style.fontSize="12px",p.style.color="var(--text-secondary)",p.textContent=a[f]||a[0];var v=!1,h=0,y=f;i.addEventListener("mousedown",function(n){v=!0,h=n.clientY,y=c.indexOf(t.controlValues.get(e.id)),document.addEventListener("mousemove",g),document.addEventListener("mouseup",b),n.preventDefault()});var g=function(n){if(v){var r=h-n.clientY,o=a.length/100,s=Math.max(0,Math.min(a.length-1,Math.round(y+r*o))),l=c[s],u=a[s];if(l!==t.controlValues.get(e.id)){var d=s/(a.length-1)*100/100*270-135;i.style.transform="rotate(".concat(d,"deg)"),p.textContent=u,t.updateControlValue(e,l)}}},b=function(){v=!1,document.removeEventListener("mousemove",g),document.removeEventListener("mouseup",b)};return i.addEventListener("dblclick",function(){var n=t.calculateDefaultValue(e),r=c.indexOf(n),o=a[r],s=r/(a.length-1)*100/100*270-135;i.style.transform="rotate(".concat(s,"deg)"),p.textContent=o,t.updateControlValue(e,n)}),o.appendChild(i),o.appendChild(p),o}},{key:"createSelect",value:function(e){var n=this;if("knob"===e.display)return this.createSelectAsKnob(e);var t=document.createElement("div");t.className="select-container",t.className="select-container flex-column-center",t.style.gap="var(--spacing-xs)";var o=document.createElement("button");o.className="select-arrow",o.textContent="◀",o.style.fontSize="14px",o.style.padding="4px 10px",o.style.background="#3a3a3a",o.style.border="1px solid #555",o.style.color="#ccc",o.style.cursor="pointer",o.style.borderRadius="3px";var i=document.createElement("select");i.className="control-input",i._controlConfig=e,e.midi&&"cc"===e.midi.type&&void 0!==e.midi.number?i.setAttribute("data-cc",e.midi.number):e.midi&&"cc_pair"===e.midi.type&&void 0!==e.midi.msb&&void 0!==e.midi.lsb?i.setAttribute("data-cc-pair","".concat(e.midi.msb,",").concat(e.midi.lsb)):e.midi&&"nrpn"===e.midi.type&&void 0!==e.midi.msb&&void 0!==e.midi.lsb&&i.setAttribute("data-nrpn","".concat(e.midi.msb,":").concat(e.midi.lsb));var a=document.createElement("button");a.className="select-arrow",a.textContent="▶",a.style.fontSize="14px",a.style.padding="4px 10px",a.style.background="#3a3a3a",a.style.border="1px solid #555",a.style.color="#ccc",a.style.cursor="pointer",a.style.borderRadius="3px";var c=[],s=[];if(e.options){var l;c=r(e.options),s=e.midiValues?r(e.midiValues):e.options.map(function(e,n){return n}),e.options.forEach(function(n,t){var r=document.createElement("option");r.value=e.midiValues?e.midiValues[t]:t,r.textContent=n,i.appendChild(r)});var u=this.calculateDefaultValue(e),d=null!==(l=this.controlValues.get(e.id))&&void 0!==l?l:u;i.value=d,this.controlValues.set(e.id,d)}else{for(var f,m=e.min||0,p=e.max||127,v=m;v<=p;v++){var h=document.createElement("option");h.value=v,h.textContent=v.toString(),i.appendChild(h),c.push(v.toString()),s.push(v)}var y=this.calculateDefaultValue(e),g=null!==(f=this.controlValues.get(e.id))&&void 0!==f?f:y;i.value=g,this.controlValues.set(e.id,g)}var b=function(){var e=s.indexOf(parseInt(i.value));o.disabled=e<=0,a.disabled=e>=s.length-1,o.disabled?(o.style.opacity="0.3",o.style.cursor="default"):(o.style.opacity="1",o.style.cursor="pointer"),a.disabled?(a.style.opacity="0.3",a.style.cursor="default"):(a.style.opacity="1",a.style.cursor="pointer")};o.addEventListener("click",function(t){if(t.preventDefault(),!o.disabled){var r=s.indexOf(parseInt(i.value));if(r>0){var a=s[r-1];i.value=a,n.updateControlValue(e,a),b()}}}),a.addEventListener("click",function(t){if(t.preventDefault(),!a.disabled){var r=s.indexOf(parseInt(i.value));if(r<s.length-1){var o=s[r+1];i.value=o,n.updateControlValue(e,o),b()}}}),i.addEventListener("change",function(t){n.updateControlValue(e,parseInt(t.target.value)),b()}),i.addEventListener("dblclick",function(){var t=n.calculateDefaultValue(e);i.value=t,n.updateControlValue(e,t),b()});var w=document.createElement("div");return w.style.display="flex",w.style.justifyContent="center",w.style.gap="0.25rem",w.appendChild(o),w.appendChild(a),b(),t.appendChild(i),t.appendChild(w),t}},{key:"createButton",value:function(e){var n,t=this,r=document.createElement("button");r.textContent=e.name,r.className="control-input",r._controlConfig=e,e.midi&&"cc"===e.midi.type&&void 0!==e.midi.number?r.setAttribute("data-cc",e.midi.number):e.midi&&"cc_pair"===e.midi.type&&void 0!==e.midi.msb&&void 0!==e.midi.lsb?r.setAttribute("data-cc-pair","".concat(e.midi.msb,",").concat(e.midi.lsb)):e.midi&&"nrpn"===e.midi.type&&void 0!==e.midi.msb&&void 0!==e.midi.lsb&&r.setAttribute("data-nrpn","".concat(e.midi.msb,":").concat(e.midi.lsb));var o=null!==(n=this.controlValues.get(e.id))&&void 0!==n?n:this.getButtonDefaultValue(e);return this.controlValues.set(e.id,o),this.updateButtonAppearance(r,o,e),r.addEventListener("click",function(){if(t.isToggleButton(e)){var n,o=null!==(n=t.controlValues.get(e.id))&&void 0!==n?n:t.getButtonOffValue(e),i=t.isButtonOn(o,e)?t.getButtonOffValue(e):t.getButtonOnValue(e);t.controlValues.set(e.id,i),t.updateControlValue(e,i),t.updateButtonAppearance(r,i,e)}else{var a=e.value||127;t.updateControlValue(e,a)}}),r}},{key:"updateButtonAppearance",value:function(e,n,t){this.isToggleButton(t)&&(this.isButtonOn(n,t)?(e.style.background="#4a90e2",e.style.color="white"):(e.style.background="#3a3a3a",e.style.color="#ccc"))}},{key:"isToggleButton",value:function(e){return void 0!==e.onValue&&void 0!==e.offValue}},{key:"getButtonOnValue",value:function(e){return e.onValue}},{key:"getButtonOffValue",value:function(e){return e.offValue}},{key:"isButtonOn",value:function(e,n){return e===n.onValue}},{key:"getButtonDefaultValue",value:function(e){return"on"===e.default?e.onValue:"off"===e.default?e.offValue:void 0!==e.default?e.default:e.offValue}},{key:"createTextInput",value:function(e){var n=this;if(e.readonly){var t=document.createElement("div");return t.className="control-input",t.textContent=e.value||e.default||"",t.style.background="transparent",t.style.border="none",t.style.textAlign="center",t.style.padding="0.5rem",t}var r=document.createElement("input");r.type="text",r.className="control-input";var o=this.controlValues.get(e.id)||e.value||e.default||"";return r.value=o,"patch_name"===e.id&&(void 0===this.savedPatchName&&(this.savedPatchName=o),this.controlValues.has(e.id)||this.controlValues.set(e.id,o)),e.maxLength&&(r.maxLength=e.maxLength),r.addEventListener("input",function(t){n.updateControlValue(e,t.target.value),"patch_name"===e.id&&n.updatePatchNameUnsavedIndicator(t.target.value)}),r._controlConfig=e,r}},{key:"createADSRDisplay",value:function(e){var n=document.createElement("div");n.className="adsr-display",n.style.width="200px",n.style.height="120px",n.style.display="flex",n.style.flexDirection="column",n.style.alignItems="center",n.style.gap="0.5rem";var t=document.createElementNS("http://www.w3.org/2000/svg","svg");t.setAttribute("width","180"),t.setAttribute("height","80"),t.setAttribute("viewBox","0 0 180 80"),t.style.background="#1a1a1a",t.style.border="1px solid #3a3a3a",t.style.borderRadius="4px";var r=document.createElementNS("http://www.w3.org/2000/svg","path");r.setAttribute("stroke","#4a90e2"),r.setAttribute("stroke-width","2"),r.setAttribute("fill","none"),r.setAttribute("stroke-linejoin","round");var o=document.createElementNS("http://www.w3.org/2000/svg","g");o.setAttribute("stroke","#2a2a2a"),o.setAttribute("stroke-width","1");for(var i=1;i<4;i++){var a=document.createElementNS("http://www.w3.org/2000/svg","line");a.setAttribute("x1","10"),a.setAttribute("y1",(20*i).toString()),a.setAttribute("x2","170"),a.setAttribute("y2",(20*i).toString()),o.appendChild(a)}for(var c=1;c<8;c++){var s=document.createElementNS("http://www.w3.org/2000/svg","line");s.setAttribute("x1",(10+20*c).toString()),s.setAttribute("y1","10"),s.setAttribute("x2",(10+20*c).toString()),s.setAttribute("y2","70"),o.appendChild(s)}return t.appendChild(o),t.appendChild(r),n.appendChild(t),n._adsrPath=r,n._config=e,this.updateADSRDisplay(n,e),n}},{key:"expandTemplate",value:function(e){for(var n=this,r=[],o=e.repeat||1,i=e.startIndex||0,a=function(){var o=i+c,a={};e.variables&&Object.keys(e.variables).forEach(function(n){var r=e.variables[n];"index"===r?a[n]=o:"object"===t(r)&&r.base&&void 0!==r.offset?"index"===r.base&&(a[n]=o+r.offset):a[n]=r}),e.controls.forEach(function(e){var t=n.substituteVariables(e,a);r.push(t)})},c=0;c<o;c++)a();return r}},{key:"substituteVariables",value:function(e,n){var r=this;if("string"==typeof e){var o=e;return Object.keys(n).forEach(function(e){var t=new RegExp("\\{\\{".concat(e,"\\}\\}"),"g");o=o.replace(t,n[e])}),o}if(Array.isArray(e))return e.map(function(e){return r.substituteVariables(e,n)});if("object"===t(e)&&null!==e){var i={};return Object.keys(e).forEach(function(t){var o=r.substituteVariables(t,n);i[o]=r.substituteVariables(e[t],n)}),i}return e}},{key:"updateADSRDisplay",value:function(e,n){var t,r,o,i,a,c,s;if(e._adsrPath&&n.parameters){var l=n.parameters;if(l.attack&&l.decay&&l.sustain&&l.release){var u=l.delay&&null!==(t=this.controlValues.get(l.delay))&&void 0!==t?t:0,d=null!==(r=this.controlValues.get(l.attack))&&void 0!==r?r:0,f=l.hold&&null!==(o=this.controlValues.get(l.hold))&&void 0!==o?o:0,m=null!==(i=this.controlValues.get(l.decay))&&void 0!==i?i:75,p=null!==(a=this.controlValues.get(l.sustain))&&void 0!==a?a:35,v=null!==(c=this.controlValues.get(l.release))&&void 0!==c?c:45,h=l.loop&&null!==(s=this.controlValues.get(l.loop))&&void 0!==s?s:0,y=l.delay?u/127:0,g=Math.max(d/127,.05),b=l.hold?f/127:0,w=Math.max(m/127,.05),x=Math.max(v/127,.05),C=160/(y+g+b+w+.15+x),E=y*C,k=g*C,M=b*C,S=w*C,I=.15*C,P=x*C,D=10,A=70-p/127*50,T=["M ".concat(D,",70")];l.delay&&E>0&&(D+=E,T.push("L ".concat(D,",70"))),D+=k,T.push("L ".concat(D,",20")),l.hold&&M>0&&(D+=M,T.push("L ".concat(D,",20"))),D+=S,T.push("L ".concat(D,",").concat(A)),D+=I,T.push("L ".concat(D,",").concat(A)),D+=P,T.push("L ".concat(D,",70")),e._adsrPath.setAttribute("d",T.join(" ")),e._loopIcon||(e._loopIcon=document.createElementNS("http://www.w3.org/2000/svg","text"),e._loopIcon.setAttribute("x","160"),e._loopIcon.setAttribute("y","15"),e._loopIcon.setAttribute("fill","#4a90e2"),e._loopIcon.setAttribute("font-size","12"),e._loopIcon.setAttribute("font-family","monospace"),e._loopIcon.textContent="↻",e.querySelector("svg").appendChild(e._loopIcon)),e._loopIcon.style.display=h>0?"block":"none"}else console.warn("ADSR display requires attack, decay, sustain, and release parameters")}}},{key:"updateRelatedEnvelopeDisplays",value:function(e){var n=this;document.querySelectorAll(".adsr-display").forEach(function(t){var r;null!==(r=t._config)&&void 0!==r&&r.parameters&&Object.values(t._config.parameters).includes(e.id)&&n.updateADSRDisplay(t,t._config)})}},{key:"convertInternalToDisplay",value:function(e,n){if(void 0!==e.displayMin&&void 0!==e.displayMax){var t,r=(e.max||127)-(e.min||0),o=e.displayMax-e.displayMin,i=(n-(e.min||0))/r,a=e.displayMin+i*o,c=(null===(t=(e.displayStep||e.step||1).toString().split(".")[1])||void 0===t?void 0:t.length)||0;return Number(a.toFixed(c))}return n}},{key:"convertDisplayToInternal",value:function(e,n){if(void 0!==e.displayMin&&void 0!==e.displayMax){var t=e.displayMax-e.displayMin,r=(e.max||127)-(e.min||0),o=(n-e.displayMin)/t;return Math.round((e.min||0)+o*r)}return n}},{key:"convertControlValueToMidiValue",value:function(e,n){var t=n;if("button"===e.type)t=n;else if("select"===e.type&&Array.isArray(e.options))e.midiValues&&Array.isArray(e.midiValues),t=n;else if("number"==typeof n)if(e.midi&&void 0!==e.midi.min&&void 0!==e.midi.max){var r=e.min||0,o=(e.max||127)-r,i=e.midi.min,a=e.midi.max-i,c=(n-r)/o;t=Math.round(i+c*a)}else if("nrpn"===e.midi.type)t=Math.max(e.min||0,Math.min(e.max||127,Math.round(n)));else if("cc_pair"===e.midi.type)t=Math.max(0,Math.min(255,Math.round(n)));else{var s=(e.max||127)-(e.min||0);t=Math.round((n-(e.min||0))/s*127)}return t}},{key:"updateNonMidiElement",value:function(e,n,t){"INPUT"===e.tagName&&"text"===e.type||"SELECT"===e.tagName?e.value=t:"BUTTON"===e.tagName&&this.isToggleButton(n)&&(t===this.getButtonOnValue(n)?e.classList.add("btn-active"):e.classList.remove("btn-active"))}},{key:"updateControlValue",value:function(e,n){var t=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null,o=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null,i=arguments.length>4&&void 0!==arguments[4]&&arguments[4];if(this.controlValues.set(e.id,n),t&&o)if(o.classList.contains("knob-text-display")&&e.options){var a=r(e.options),c=(e.midiValues?r(e.midiValues):e.options.map(function(e,n){return n})).indexOf(n);if(c>=0){var s=c/(a.length-1)*100/100*270-135;t.style.transform="rotate(".concat(s,"deg)"),o.textContent=a[c]}}else{var l=(n-(e.min||0))/((e.max||127)-(e.min||0))*100/100*270-135;t.style.transform="rotate(".concat(l,"deg)");var u=this.convertInternalToDisplay(e,n);o.value=u}if(t||o||this.updateSingleUIElement(e),e.midi&&window.midiManager.isConnected&&!i){var d=this.convertControlValueToMidiValue(e,n);window.midiManager.sendMIDIMessage(e.midi,d)}this.updateRelatedEnvelopeDisplays(e)}},{key:"calculateDefaultValue",value:function(e){if("select"===e.type&&e.options){if(e.midiValues){var n=e.options.indexOf(e.default);return n>=0?e.midiValues[n]:e.midiValues[0]}var t=e.options.indexOf(e.default);return t>=0?t:0}return void 0!==e.default&&null!==e.default?e.default:null!==(r=e.min)&&void 0!==r?r:0;var r}},{key:"resetAllToDefaults",value:function(){this.currentConfig&&this.loadDefaultValues()}},{key:"updateAllUIElements",value:function(){var e=this;this.currentTab&&this.currentTab.sections.forEach(function(n){n.controls&&n.controls.forEach(function(n){e.updateSingleUIElement(n)}),n.template&&e.expandTemplate(n.template).forEach(function(n){e.updateSingleUIElement(n)}),n.subsections&&n.subsections.forEach(function(n){n.controls&&n.controls.forEach(function(n){e.updateSingleUIElement(n)})})})}},{key:"updateSingleUIElement",value:function(e){var t,o,i,a=this,c=this.controlValues.get(e.id);if(void 0!==c){var s="";if("cc"===(null===(t=e.midi)||void 0===t?void 0:t.type)&&void 0!==e.midi.number)s='[data-cc="'.concat(e.midi.number,'"]');else if("cc_pair"===(null===(o=e.midi)||void 0===o?void 0:o.type)&&void 0!==e.midi.msb&&void 0!==e.midi.lsb)s='[data-cc-pair="'.concat(e.midi.msb,",").concat(e.midi.lsb,'"]');else{if("nrpn"!==(null===(i=e.midi)||void 0===i?void 0:i.type)||void 0===e.midi.msb||void 0===e.midi.lsb){var l,u=n(document.querySelectorAll("input, select, button"));try{for(u.s();!(l=u.n()).done;){var d,f=l.value;if((null===(d=f._controlConfig)||void 0===d?void 0:d.id)===e.id)return void this.updateNonMidiElement(f,e,c)}}catch(e){u.e(e)}finally{u.f()}return}s='[data-nrpn="'.concat(e.midi.msb,":").concat(e.midi.lsb,'"]')}document.querySelectorAll(s).forEach(function(n){var t;if((null===(t=n._controlConfig)||void 0===t?void 0:t.id)===e.id)if("INPUT"===n.tagName&&"range"===n.type){n.value=c;var o=n.parentElement.querySelector('input[type="number"]');if(o){var i=a.convertInternalToDisplay(e,c);o.value=i}}else if("INPUT"===n.tagName&&"number"===n.type){var s=a.convertInternalToDisplay(e,c);n.value=s}else if(n.classList.contains("knob")){var l=n.parentElement.querySelector(".knob-text-display");if(l&&e.options){var u=r(e.options),d=(e.midiValues?r(e.midiValues):e.options.map(function(e,n){return n})).indexOf(c);if(d>=0){var f=d/(u.length-1)*100/100*270-135;n.style.transform="rotate(".concat(f,"deg)"),l.textContent=u[d]}}else{var m=(c-(e.min||0))/((e.max||127)-(e.min||0))*100/100*270-135;n.style.transform="rotate(".concat(m,"deg)");var p=n.parentElement.querySelector('input[type="number"]');if(p){var v=a.convertInternalToDisplay(e,c);p.value=v}}}else if("SELECT"===n.tagName){n.value=c;var h=n.closest(".select-container");if(h){var y=h.querySelector(".select-arrow:first-child"),g=h.querySelector(".select-arrow:last-child"),b=Array.from(n.options).map(function(e){return parseInt(e.value)}),w=b.indexOf(parseInt(c));y&&(y.disabled=w<=0,y.style.opacity=y.disabled?"0.3":"1",y.style.cursor=y.disabled?"default":"pointer"),g&&(g.disabled=w>=b.length-1,g.style.opacity=g.disabled?"0.3":"1",g.style.cursor=g.disabled?"default":"pointer")}}else"BUTTON"===n.tagName&&a.updateButtonAppearance(n,c,e)}),this.updateRelatedEnvelopeDisplays(e)}}},{key:"getControlValue",value:function(e){return this.controlValues.get(e)}},{key:"getAllControlValues",value:function(){this.ensureAllControlValuesInitialized();var t,r={},o=n(this.controlValues.entries());try{for(o.s();!(t=o.n()).done;){var i=e(t.value,2),a=i[0],c=i[1];this.isReadOnlyControl(a)||(r[a]=c)}}catch(e){o.e(e)}finally{o.f()}return r}},{key:"isReadOnlyControl",value:function(e){if(e.includes("_header_")||e.includes("_label")||e.includes("_display"))return!0;var n=this.findControlConfigById(e);return!(!n||"adsr_display"!==n.type&&!0!==n.readonly)}},{key:"findControlConfigById",value:function(e){if(!this.currentConfig||!this.currentConfig.tabs)return null;var t,r=n(this.currentConfig.tabs);try{for(r.s();!(t=r.n()).done;){var o,i=n(t.value.sections);try{for(i.s();!(o=i.n()).done;){var a=o.value;if(a.controls&&Array.isArray(a.controls)){var c=a.controls.find(function(n){return n.id===e});if(c)return c}if(a.subsections&&Array.isArray(a.subsections)){var s,l=n(a.subsections);try{for(l.s();!(s=l.n()).done;){var u=s.value;if(u.controls&&Array.isArray(u.controls)){var d=u.controls.find(function(n){return n.id===e});if(d)return d}}}catch(e){l.e(e)}finally{l.f()}}if(a.template){var f=this.expandTemplate(a.template).find(function(n){return n.id===e});if(f)return f}}}catch(e){i.e(e)}finally{i.f()}}}catch(e){r.e(e)}finally{r.f()}return null}},{key:"ensureAllControlValuesInitialized",value:function(){var e=this;this.currentConfig&&this.currentConfig.tabs&&this.currentConfig.tabs.forEach(function(n){n.sections.forEach(function(n){n.controls&&Array.isArray(n.controls)&&n.controls.forEach(function(n){if(n.id&&!e.controlValues.has(n.id)){var t=e.calculateDefaultValue(n);e.controlValues.set(n.id,t)}}),n.template&&e.expandTemplate(n.template).forEach(function(n){if(n.id&&!e.controlValues.has(n.id)){var t=e.calculateDefaultValue(n);e.controlValues.set(n.id,t)}}),n.subsections&&Array.isArray(n.subsections)&&n.subsections.forEach(function(n){n.controls&&Array.isArray(n.controls)&&n.controls.forEach(function(n){if(n.id&&!e.controlValues.has(n.id)){var t=e.calculateDefaultValue(n);e.controlValues.set(n.id,t)}})})})})}},{key:"loadControlValues",value:function(n){for(var t=0,r=Object.entries(n);t<r.length;t++){var o=e(r[t],2),i=o[0],a=o[1];this.controlValues.set(i,a)}this.updateAllUIElements(),this.clearPatchNameUnsavedIndicator()}},{key:"sendAllParameters",value:function(){if(window.midiManager.isConnected)if(this.currentConfig&&this.currentConfig.tabs){if(window.synthEditor.sysExHandler&&this.hasSysExMappings())try{window.synthEditor.notificationManager.info("Generating and sending patch via SysEx...");var e=window.synthEditor.sysExHandler.generatePatchDump();if(!e)throw new Error("Unable to generate SysEx patch dump");if(window.midiManager.sendSysEx(e))return window.synthEditor.notificationManager.success("Patch sent successfully via SysEx!"),void this.clearPatchNameUnsavedIndicator();window.synthEditor.notificationManager.warning("SysEx send failed, falling back to individual MIDI messages...")}catch(e){console.error("SysEx patch generation failed:",e),window.synthEditor.notificationManager.warning("SysEx generation failed, falling back to individual MIDI messages...")}window.synthEditor.notificationManager.info("Sending parameters via individual MIDI messages..."),this.sendAllParametersViaMIDI()}else window.synthEditor.notificationManager.warning("No synthesizer configuration loaded.");else window.synthEditor.notificationManager.warning("No MIDI device connected. Please connect a MIDI device first.")}},{key:"hasSysExMappings",value:function(){var e,t=n(this.currentConfig.tabs||[]);try{for(t.s();!(e=t.n()).done;){var r,o=n(e.value.sections||[]);try{for(o.s();!(r=o.n()).done;){var i=r.value;if(i.controls){var a,c=n(i.controls);try{for(c.s();!(a=c.n()).done;){var s;if(null!==(s=a.value.sysEx)&&void 0!==s&&s.offsets)return!0}}catch(e){c.e(e)}finally{c.f()}}if(i.subsections){var l,u=n(i.subsections);try{for(u.s();!(l=u.n()).done;){var d=l.value;if(d.controls){var f,m=n(d.controls);try{for(m.s();!(f=m.n()).done;){var p;if(null!==(p=f.value.sysEx)&&void 0!==p&&p.offsets)return!0}}catch(e){m.e(e)}finally{m.f()}}}}catch(e){u.e(e)}finally{u.f()}}}}catch(e){o.e(e)}finally{o.f()}}}catch(e){t.e(e)}finally{t.f()}return!1}},{key:"sendAllParametersViaMIDI",value:function(){var e=this,n=[];this.currentConfig.tabs.forEach(function(t){t.sections&&t.sections.forEach(function(r){r.controls&&Array.isArray(r.controls)&&r.controls.forEach(function(o){if(o.id&&o.midi){var i=e.controlValues.get(o.id),a=void 0!==i?i:void 0!==o.default?o.default:0;n.push({config:o,value:a,location:"".concat(t.name," > ").concat(r.name," > ").concat(o.name)})}}),r.template&&e.expandTemplate(r.template).forEach(function(o){if(o.id&&o.midi){var i=e.controlValues.get(o.id),a=void 0!==i?i:void 0!==o.default?o.default:0;n.push({config:o,value:a,location:"".concat(t.name," > ").concat(r.name," > ").concat(o.name)})}}),r.subsections&&Array.isArray(r.subsections)&&r.subsections.forEach(function(o){o.controls&&Array.isArray(o.controls)&&o.controls.forEach(function(i){if(i.id&&i.midi){var a=e.controlValues.get(i.id),c=void 0!==a?a:void 0!==i.default?i.default:0;n.push({config:i,value:c,location:"".concat(t.name," > ").concat(r.name," > ").concat(o.name," > ").concat(i.name)})}})})})}),0!==n.length?this.sendParametersSequentially(n):alert("No MIDI-enabled parameters found to send.")}},{key:"sendParametersSequentially",value:function(e){var n=this,t=0,r=function(o){if(o>=e.length)return n.clearPatchNameUnsavedIndicator(),void(t>0&&alert("".concat(t," parameters failed to send.")));var i=e[o];try{var a=n.convertControlValueToMidiValue(i.config,i.value);window.midiManager.sendMIDIMessage(i.config.midi,a)||(t++,console.error("✗ Failed to send ".concat(i.location,": ").concat(i.value)))}catch(e){t++,console.error("✗ Error sending ".concat(i.location,":"),e)}setTimeout(function(){return r(o+1)},10)};r(0)}},{key:"sendInitPatch",value:function(){var n;if(!window.midiManager.isConnected)return window.synthEditor.notificationManager.warning("No MIDI device connected. Please connect a MIDI device first."),!1;if(null===(n=this.currentConfig)||void 0===n||!n.initPatch)return window.synthEditor.notificationManager.info("Sending default values via individual MIDI messages..."),this.loadDefaultValues(),this.sendAllParametersViaMIDI(),!0;try{if(window.midiManager.sendSysEx(this.currentConfig.initPatch),window.synthEditor.notificationManager.success("Init patch sent to synthesizer!"),window.synthEditor.sysExHandler)try{var t=window.synthEditor.sysExHandler.convertDumpToParameters(this.currentConfig.initPatch);if(t&&Object.keys(t).length>0){for(var r={},o=0,i=Object.entries(t);o<i.length;o++){var a=e(i[o],2),c=a[0],s=a[1];r[c]=s.controlValue}this.loadControlValues(r),window.synthEditor.notificationManager.success("Init patch loaded with ".concat(Object.keys(t).length," parameter values!"))}else this.loadDefaultValues(),this.clearPatchNameUnsavedIndicator()}catch(e){console.error("Error parsing init patch SysEx:",e),this.loadDefaultValues(),this.clearPatchNameUnsavedIndicator(),window.synthEditor.notificationManager.warning("Init patch sent, using default values (could not parse SysEx)")}else this.loadDefaultValues(),this.clearPatchNameUnsavedIndicator();return!0}catch(e){return console.error("Error sending init patch:",e),window.synthEditor.notificationManager.error("Failed to send init patch: "+e.message),!1}}},{key:"loadDefaultValues",value:function(){var e=this;this.currentConfig.tabs.forEach(function(n){n.sections.forEach(function(n){n.controls&&n.controls.forEach(function(n){var t=e.calculateDefaultValue(n);e.controlValues.set(n.id,t)}),n.template&&e.expandTemplate(n.template).forEach(function(n){var t=e.calculateDefaultValue(n);e.controlValues.set(n.id,t)}),n.subsections&&n.subsections.forEach(function(n){n.controls&&n.controls.forEach(function(n){var t=e.calculateDefaultValue(n);e.controlValues.set(n.id,t)})})})}),this.updateAllUIElements()}},{key:"toggleHelpMode",value:function(){this.helpMode=!this.helpMode;var e=document.getElementById("help-mode-toggle");this.helpMode?(e.style.background="#4a90e2",e.style.color="white",document.body.style.cursor="help",this.addHelpEventListeners()):(e.style.background="",e.style.color="",document.body.style.cursor="",this.removeHelpEventListeners(),this.hideTooltip())}},{key:"addHelpEventListeners",value:function(){var e=this;document.querySelectorAll(".control").forEach(function(n){n.addEventListener("mouseenter",e.boundHandleControlMouseEnter),n.addEventListener("mouseleave",e.boundHandleControlMouseLeave)})}},{key:"removeHelpEventListeners",value:function(){var e=this;document.querySelectorAll(".control").forEach(function(n){n.removeEventListener("mouseenter",e.boundHandleControlMouseEnter),n.removeEventListener("mouseleave",e.boundHandleControlMouseLeave)})}},{key:"handleControlMouseEnter",value:function(e){if(this.helpMode){var n=e.target,t=this.findControlConfig(n);t&&this.showTooltip(e,t)}}},{key:"handleControlMouseLeave",value:function(e){this.helpMode&&this.hideTooltip()}},{key:"findControlConfig",value:function(e){var n=e.querySelector(".knob");if(n&&n._controlConfig)return n._controlConfig;var t=e.querySelector('input[type="range"]');if(t&&t._controlConfig)return t._controlConfig;var r=e.querySelector("select");if(r&&r._controlConfig)return r._controlConfig;var o=e.querySelector("button.control-input");if(o&&o._controlConfig)return o._controlConfig;var i=e.querySelector('input[type="text"]');if(i&&i._controlConfig)return i._controlConfig;var a=e.querySelector('input[type="number"]:not(.control-input)');if(a&&a._controlConfig)return a._controlConfig;var c=e.querySelector("[data-cc], [data-cc-pair], [data-nrpn]");return c&&c._controlConfig?c._controlConfig:null}},{key:"showTooltip",value:function(e,n){this.hideTooltip();var t=document.createElement("div");t.className="help-tooltip",t.style.position="absolute",t.style.background="#2a2a2a",t.style.border="1px solid #555",t.style.borderRadius="4px",t.style.padding="8px",t.style.color="#ccc",t.style.fontSize="12px",t.style.lineHeight="1.4",t.style.maxWidth="300px",t.style.zIndex="9999",t.style.boxShadow="0 4px 8px rgba(0,0,0,0.3)";var r="<strong>".concat(n.name,"</strong><br>");n.midi&&("cc"===n.midi.type?r+="MIDI CC: ".concat(n.midi.number,"<br>"):"cc_pair"===n.midi.type?r+="MIDI CC Pair: MSB ".concat(n.midi.msb,", LSB ").concat(n.midi.lsb,"<br>"):"nrpn"===n.midi.type&&(r+="NRPN: MSB ".concat(n.midi.msb,", LSB ").concat(n.midi.lsb,"<br>")),void 0!==n.midi.min&&void 0!==n.midi.max&&(r+="MIDI Range: ".concat(n.midi.min,"-").concat(n.midi.max,"<br>")));var o="button"===n.type&&this.isToggleButton(n);void 0===n.min||void 0===n.max||o||(r+="Range: ".concat(n.min," to ").concat(n.max,"<br>")),o&&(r+="Off Value: ".concat(this.getButtonOffValue(n),"<br>"),r+="On Value: ".concat(this.getButtonOnValue(n),"<br>")),n.step&&!o&&(r+="Step: ".concat(n.step,"<br>")),void 0!==n.default&&(r+="Default: ".concat(n.default,"<br>")),n.options&&n.midiValues&&(r+="Options:<br>",n.options.forEach(function(e,t){var o=n.midiValues[t];r+="  ".concat(e," (").concat(o,")<br>")})),n.sysEx&&n.sysEx.offsets&&n.sysEx.offsets.length>0&&(r+="SysEx Offset(s): ".concat(n.sysEx.offsets.join(" "),"<br>")),t.innerHTML=r,document.body.appendChild(t);var i=e.target.getBoundingClientRect(),a=t.getBoundingClientRect(),c=i.right+10,s=i.top;c+a.width>window.innerWidth&&(c=i.left-a.width-10),s+a.height>window.innerHeight&&(s=window.innerHeight-a.height-10),t.style.left=c+"px",t.style.top=s+"px",this.currentTooltip=t}},{key:"hideTooltip",value:function(){this.currentTooltip&&(this.currentTooltip.remove(),this.currentTooltip=null)}},{key:"updatePatchNameUnsavedIndicator",value:function(e){void 0===this.savedPatchName&&(this.savedPatchName=this.controlValues.get("patch_name")||""),e!==this.savedPatchName?this.showPatchNameUnsavedIndicator():this.hidePatchNameUnsavedIndicator()}},{key:"showPatchNameUnsavedIndicator",value:function(){var e=this.findControlByIdInDOM("patch_name");if(e){var n=e.querySelector(".control-label");n&&!n.textContent.includes("●")&&(n.textContent=n.textContent+" ●",n.style.color="#ff6b6b",n.title="Patch name changed - use Send All to apply")}}},{key:"hidePatchNameUnsavedIndicator",value:function(){var e=this.findControlByIdInDOM("patch_name");if(e){var n=e.querySelector(".control-label");n&&n.textContent.includes("●")&&(n.textContent=n.textContent.replace(" ●",""),n.style.color="",n.title="")}}},{key:"clearPatchNameUnsavedIndicator",value:function(){var e=this.controlValues.get("patch_name")||"";this.savedPatchName=e,this.hidePatchNameUnsavedIndicator()}},{key:"findControlByIdInDOM",value:function(e){var t,r=n(document.querySelectorAll('input[type="text"]'));try{for(r.s();!(t=r.n()).done;){var o=t.value;if(o._controlConfig&&o._controlConfig.id===e)return o.closest(".control")}}catch(e){r.e(e)}finally{r.f()}return null}}],i&&a(o.prototype,i),Object.defineProperty(o,"prototype",{writable:!1}),o;var o,i}();window.uiManager=new s},540:e=>{"use strict";e.exports=function(e){var n=document.createElement("style");return e.setAttributes(n,e.attributes),e.insert(n,e.options),n}},601:e=>{"use strict";e.exports=function(e){return e[1]}},659:e=>{"use strict";var n={};e.exports=function(e,t){var r=function(e){if(void 0===n[e]){var t=document.querySelector(e);if(window.HTMLIFrameElement&&t instanceof window.HTMLIFrameElement)try{t=t.contentDocument.head}catch(e){t=null}n[e]=t}return n[e]}(e);if(!r)throw new Error("Couldn't find a style target. This probably means that the value for the 'insert' parameter is invalid.");r.appendChild(t)}},825:e=>{"use strict";e.exports=function(e){if("undefined"==typeof document)return{update:function(){},remove:function(){}};var n=e.insertStyleElement(e);return{update:function(t){!function(e,n,t){var r="";t.supports&&(r+="@supports (".concat(t.supports,") {")),t.media&&(r+="@media ".concat(t.media," {"));var o=void 0!==t.layer;o&&(r+="@layer".concat(t.layer.length>0?" ".concat(t.layer):""," {")),r+=t.css,o&&(r+="}"),t.media&&(r+="}"),t.supports&&(r+="}");var i=t.sourceMap;i&&"undefined"!=typeof btoa&&(r+="\n/*# sourceMappingURL=data:application/json;base64,".concat(btoa(unescape(encodeURIComponent(JSON.stringify(i))))," */")),n.styleTagTransform(r,e,n.options)}(n,e,t)},remove:function(){!function(e){if(null===e.parentNode)return!1;e.parentNode.removeChild(e)}(n)}}}},938:()=>{function e(n){return e="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},e(n)}function n(e,n){var r="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!r){if(Array.isArray(e)||(r=t(e))||n&&e&&"number"==typeof e.length){r&&(e=r);var o=0,i=function(){};return{s:i,n:function(){return o>=e.length?{done:!0}:{done:!1,value:e[o++]}},e:function(e){throw e},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var a,c=!0,s=!1;return{s:function(){r=r.call(e)},n:function(){var e=r.next();return c=e.done,e},e:function(e){s=!0,a=e},f:function(){try{c||null==r.return||r.return()}finally{if(s)throw a}}}}function t(e,n){if(e){if("string"==typeof e)return r(e,n);var t={}.toString.call(e).slice(8,-1);return"Object"===t&&e.constructor&&(t=e.constructor.name),"Map"===t||"Set"===t?Array.from(e):"Arguments"===t||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(t)?r(e,n):void 0}}function r(e,n){(null==n||n>e.length)&&(n=e.length);for(var t=0,r=Array(n);t<n;t++)r[t]=e[t];return r}function o(){var e,n,t="function"==typeof Symbol?Symbol:{},r=t.iterator||"@@iterator",a=t.toStringTag||"@@toStringTag";function c(t,r,o,a){var c=r&&r.prototype instanceof l?r:l,u=Object.create(c.prototype);return i(u,"_invoke",function(t,r,o){var i,a,c,l=0,u=o||[],d=!1,f={p:0,n:0,v:e,a:m,f:m.bind(e,4),d:function(n,t){return i=n,a=0,c=e,f.n=t,s}};function m(t,r){for(a=t,c=r,n=0;!d&&l&&!o&&n<u.length;n++){var o,i=u[n],m=f.p,p=i[2];t>3?(o=p===r)&&(c=i[(a=i[4])?5:(a=3,3)],i[4]=i[5]=e):i[0]<=m&&((o=t<2&&m<i[1])?(a=0,f.v=r,f.n=i[1]):m<p&&(o=t<3||i[0]>r||r>p)&&(i[4]=t,i[5]=r,f.n=p,a=0))}if(o||t>1)return s;throw d=!0,r}return function(o,u,p){if(l>1)throw TypeError("Generator is already running");for(d&&1===u&&m(u,p),a=u,c=p;(n=a<2?e:c)||!d;){i||(a?a<3?(a>1&&(f.n=-1),m(a,c)):f.n=c:f.v=c);try{if(l=2,i){if(a||(o="next"),n=i[o]){if(!(n=n.call(i,c)))throw TypeError("iterator result is not an object");if(!n.done)return n;c=n.value,a<2&&(a=0)}else 1===a&&(n=i.return)&&n.call(i),a<2&&(c=TypeError("The iterator does not provide a '"+o+"' method"),a=1);i=e}else if((n=(d=f.n<0)?c:t.call(r,f))!==s)break}catch(n){i=e,a=1,c=n}finally{l=1}}return{value:n,done:d}}}(t,o,a),!0),u}var s={};function l(){}function u(){}function d(){}n=Object.getPrototypeOf;var f=[][r]?n(n([][r]())):(i(n={},r,function(){return this}),n),m=d.prototype=l.prototype=Object.create(f);function p(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,d):(e.__proto__=d,i(e,a,"GeneratorFunction")),e.prototype=Object.create(m),e}return u.prototype=d,i(m,"constructor",d),i(d,"constructor",u),u.displayName="GeneratorFunction",i(d,a,"GeneratorFunction"),i(m),i(m,a,"Generator"),i(m,r,function(){return this}),i(m,"toString",function(){return"[object Generator]"}),(o=function(){return{w:c,m:p}})()}function i(e,n,t,r){var o=Object.defineProperty;try{o({},"",{})}catch(e){o=0}i=function(e,n,t,r){function a(n,t){i(e,n,function(e){return this._invoke(n,t,e)})}n?o?o(e,n,{value:t,enumerable:!r,configurable:!r,writable:!r}):e[n]=t:(a("next",0),a("throw",1),a("return",2))},i(e,n,t,r)}function a(e,n,t,r,o,i,a){try{var c=e[i](a),s=c.value}catch(e){return void t(e)}c.done?n(s):Promise.resolve(s).then(r,o)}function c(e,n){for(var t=0;t<n.length;t++){var r=n[t];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,s(r.key),r)}}function s(n){var t=function(n){if("object"!=e(n)||!n)return n;var t=n[Symbol.toPrimitive];if(void 0!==t){var r=t.call(n,"string");if("object"!=e(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(n)}(n);return"symbol"==e(t)?t:t+""}var l=function(){return e=function e(){!function(e,n){if(!(e instanceof n))throw new TypeError("Cannot call a class as a function")}(this,e),this.midiAccess=null,this.outputDevice=null,this.inputDevice=null,this.isConnected=!1,this.currentChannel=1,this.ccPairValues=new Map,this.nrpnState={msb:null,lsb:null}},r=[{key:"initialize",value:(i=o().m(function e(){var n;return o().w(function(e){for(;;)switch(e.p=e.n){case 0:if(e.p=0,!navigator.requestMIDIAccess){e.n=2;break}return e.n=1,navigator.requestMIDIAccess({sysex:!0});case 1:return this.midiAccess=e.v,e.a(2,!0);case 2:return console.error("Web MIDI API not supported"),e.a(2,!1);case 3:e.n=5;break;case 4:return e.p=4,n=e.v,console.error("Failed to enable WebMIDI:",n),e.a(2,!1);case 5:return e.a(2)}},e,this,[[0,4]])}),s=function(){var e=this,n=arguments;return new Promise(function(t,r){var o=i.apply(e,n);function c(e){a(o,t,r,c,s,"next",e)}function s(e){a(o,t,r,c,s,"throw",e)}c(void 0)})},function(){return s.apply(this,arguments)})},{key:"getAvailableOutputs",value:function(){if(!this.midiAccess)return[];var e,t=[],r=n(this.midiAccess.outputs.values());try{for(r.s();!(e=r.n()).done;){var o=e.value;t.push({id:o.id,name:o.name,manufacturer:o.manufacturer||"",version:o.version||"",stableId:this.createStableDeviceId(o)})}}catch(e){r.e(e)}finally{r.f()}return t}},{key:"getAvailableInputs",value:function(){if(!this.midiAccess)return[];var e,t=[],r=n(this.midiAccess.inputs.values());try{for(r.s();!(e=r.n()).done;){var o=e.value;t.push({id:o.id,name:o.name,manufacturer:o.manufacturer||"",version:o.version||"",stableId:this.createStableDeviceId(o)})}}catch(e){r.e(e)}finally{r.f()}return t}},{key:"createStableDeviceId",value:function(e){var n=e.manufacturer||"Unknown",t=e.name||"Unknown Device",r=e.type||"unknown",o=e.version||"",i="".concat(n,":").concat(t,":").concat(r);return o&&(i+=":".concat(o)),i}},{key:"findDeviceByStableId",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"output";if(!this.midiAccess)return null;var r,o=n(("output"===t?this.midiAccess.outputs:this.midiAccess.inputs).values());try{for(o.s();!(r=o.n()).done;){var i=r.value;if(this.createStableDeviceId(i)===e)return i}}catch(e){o.e(e)}finally{o.f()}return null}},{key:"connectOutput",value:function(e){if(!this.midiAccess)return console.error("MIDI access not initialized"),!1;try{var n=this.midiAccess.outputs.get(e);return n?(this.outputDevice=n,this.isConnected=!0,!0):(console.error("Output device with ID ".concat(e," not found")),!1)}catch(e){return console.error("Error connecting to output device:",e),!1}}},{key:"connectInput",value:function(e){var n=this;if(!this.midiAccess)return console.error("MIDI access not initialized"),!1;try{var t=this.midiAccess.inputs.get(e);return t?(this.inputDevice=t,t.onmidimessage=function(e){n.handleMIDIInput(e)},!0):(console.error("Input device with ID ".concat(e," not found")),!1)}catch(e){return console.error("Error connecting to input device:",e),!1}}},{key:"disconnect",value:function(){this.inputDevice&&(this.inputDevice.onmidimessage=null),this.outputDevice=null,this.inputDevice=null,this.isConnected=!1}},{key:"setChannel",value:function(e){this.currentChannel=e}},{key:"sendCC",value:function(e,n){if(!this.outputDevice)return console.warn("No MIDI output device connected"),!1;try{var t=this.currentChannel-1+176,r=Math.max(0,Math.min(127,Math.round(n))),o=[t,e,r];return this.outputDevice.send(o),this.logMIDI("out","CC ".concat(e,": ").concat(r," (Ch ").concat(this.currentChannel,")"),o),!0}catch(e){return console.error("Failed to send CC:",e),!1}}},{key:"sendCCPair",value:function(e,n,t){if(!this.outputDevice)return console.warn("No MIDI output device connected"),!1;try{var r=this.currentChannel-1+176,o=Math.max(0,Math.min(255,Math.round(t))),i=o>>1&127,a=(1&o)<<6,c=[r,e,i],s=[r,n,a];return this.outputDevice.send(c),this.outputDevice.send(s),this.logMIDI("out","CC pair ".concat(e,"/").concat(n,": ").concat(o," (MSB:").concat(i,", LSB:").concat(a,") (Ch ").concat(this.currentChannel,")"),[c,s]),!0}catch(e){return console.error("Failed to send CC pair:",e),!1}}},{key:"sendNRPN",value:function(e,n,t){var r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0,o=arguments.length>4&&void 0!==arguments[4]&&arguments[4];if(!this.outputDevice)return console.warn("No MIDI output device connected"),!1;try{var i=this.currentChannel-1+176,a=[i,99,e];this.outputDevice.send(a),this.logMIDI("out","NRPN MSB: ".concat(e),a);var c=[i,98,n];this.outputDevice.send(c),this.logMIDI("out","NRPN LSB: ".concat(n),c);var s=[i,6,t];if(this.outputDevice.send(s),this.logMIDI("out","Data MSB: ".concat(t),s),!o){var l=[i,38,r];this.outputDevice.send(l),this.logMIDI("out","Data LSB: ".concat(r),l)}var u=o?"".concat(t," (MSB only)"):"".concat(t,":").concat(r);return this.logMIDI("out","NRPN ".concat(e,":").concat(n," = ").concat(u," (Ch ").concat(this.currentChannel,")")),!0}catch(e){return console.error("Failed to send NRPN:",e),!1}}},{key:"shouldSendNRPNLSB",value:function(){return!window.uiManager||!window.uiManager.currentConfig||!1!==window.uiManager.currentConfig.nrpnSendLSB}},{key:"sendProgramChange",value:function(e){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;if(!this.outputDevice)return console.warn("No MIDI output device connected"),!1;try{var t=n||this.currentChannel,r=[t-1+192,Math.max(0,Math.min(127,e))];return this.outputDevice.send(r),this.logMIDI("out","Program Change: ".concat(e," (Ch ").concat(t,")"),r),!0}catch(e){return console.error("Failed to send Program Change:",e),!1}}},{key:"sendSysEx",value:function(e){if(!this.outputDevice)return console.warn("No MIDI output device connected"),!1;try{var n;if("string"==typeof e)n=e.split(" ").map(function(e){return parseInt(e,16)});else{if(!Array.isArray(e))return console.error("Invalid SysEx data format"),!1;n=e}return this.outputDevice.send(n),this.logMIDI("out","SysEx: ".concat(e),n),!0}catch(e){return console.error("Failed to send SysEx:",e),!1}}},{key:"sendMIDIMessage",value:function(e,n){switch(e.type){case"cc":return this.sendCC(e.number,n);case"cc_pair":return this.sendCCPair(e.msb,e.lsb,n);case"nrpn":var t=Math.max(0,Math.min(127,Math.round(n))),r=this.shouldSendNRPNLSB();return this.sendNRPN(e.msb,e.lsb,t,0,!r);case"sysex":var o=e.template;if("string"==typeof n){var i=Array.from(n).map(function(e){return e.charCodeAt(0).toString(16).padStart(2,"0")}).join(" ");o=o.replace("{data}",i)}else o=o.replace("{data}",n.toString(16).padStart(2,"0"));return this.sendSysEx(o);default:return console.warn("Unknown MIDI message type:",e.type),!1}}},{key:"handleMIDIInput",value:function(e){var n=Array.from(e.data),t=n[0],r=1+(15&t),o="",i=!1;switch(240&t){case 128:o="Note Off: ".concat(n[1]," velocity ").concat(n[2]," (Ch ").concat(r,")");break;case 144:o="Note On: ".concat(n[1]," velocity ").concat(n[2]," (Ch ").concat(r,")");break;case 176:99===n[1]?(o="NRPN MSB: ".concat(n[2]," (Ch ").concat(r,")"),this.nrpnState.msb=n[2]):98===n[1]?(o="NRPN LSB: ".concat(n[2]," (Ch ").concat(r,")"),this.nrpnState.lsb=n[2]):6===n[1]?(o="Data Entry MSB: ".concat(n[2]," (Ch ").concat(r,")"),null!==this.nrpnState.msb&&null!==this.nrpnState.lsb&&this.updateUIFromNRPN(this.nrpnState.msb,this.nrpnState.lsb,n[2],r)):38===n[1]?(o="Data Entry LSB: ".concat(n[2]," (Ch ").concat(r,")"),null===this.nrpnState.msb&&null===this.nrpnState.lsb&&(i=!0)):(o="CC ".concat(n[1],": ").concat(n[2]," (Ch ").concat(r,")"),i=!0);break;case 192:o="Program Change: ".concat(n[1]," (Ch ").concat(r,")");break;case 224:var a=n[1]+(n[2]<<7);o="Pitch Bend: ".concat(a," (Ch ").concat(r,")");break;case 240:o=240===t?"SysEx: ".concat(n.map(function(e){return e.toString(16).padStart(2,"0")}).join(" ")):"System: ".concat(t.toString(16)," (").concat(n.slice(1).join(" "),")");break;default:o="Unknown: ".concat(n.join(" "))}this.logMIDI("in",o,n),i&&this.updateUIFromCC(n[1],n[2],r)}},{key:"updateUIFromCC",value:function(e,n,t){t!==this.currentChannel&&1!==t||(this.handleCCPairUpdate(e,n,t),document.querySelectorAll('[data-cc="'.concat(e,'"]')).forEach(function(e){if("INPUT"===e.tagName&&"range"===e.type){var t=parseFloat(e.min)||0,r=parseFloat(e.max)||127,o=t+n/127*(r-t);e.value=Math.round(o);var i=e.parentElement.querySelector('input[type="number"]');i&&(i.value=Math.round(o));var a=e._controlConfig;a&&window.uiManager&&window.uiManager.updateControlValue(a,Math.round(o),null,null,!0)}else if("INPUT"===e.tagName&&"number"===e.type){e.value=n;var c=e._controlConfig;c&&window.uiManager&&window.uiManager.updateControlValue(c,n,null,null,!0)}else if(e.classList.contains("knob")){var s=e._controlConfig;if(s){var l=s.min+n/127*(s.max-s.min),u=(l-s.min)/(s.max-s.min)*270-135;e.style.transform="rotate(".concat(u,"deg)");var d=e.parentElement.querySelector(".control-input");d&&(d.value=Math.round(l)),window.uiManager&&window.uiManager.updateControlValue(s,Math.round(l),null,null,!0)}}else if("SELECT"===e.tagName){e.value=n;var f=e._controlConfig;f&&window.uiManager&&window.uiManager.updateControlValue(f,parseInt(n),null,null,!0)}}))}},{key:"updateUIFromNRPN",value:function(e,n,t,r){if(r===this.currentChannel||1===r){var o='[data-nrpn="'.concat(e,":").concat(n,'"]');document.querySelectorAll(o).forEach(function(e){var n=e._controlConfig;if(n){var r=t;if(void 0!==n.midi.min&&void 0!==n.midi.max){var o=n.midi.min,i=n.midi.max-o,a=n.min||0,c=(n.max||127)-a,s=(t-o)/i;r=Math.round(a+s*c)}if("INPUT"===e.tagName&&"range"===e.type){e.value=r;var l=e.parentElement.querySelector('input[type="number"]');l&&(l.value=r)}else if("INPUT"===e.tagName&&"number"===e.type)e.value=r;else if(e.classList.contains("knob")){var u=n.min||0,d=(r-u)/((n.max||127)-u)*100/100*270-135;e.style.transform="rotate(".concat(d,"deg)");var f=e.parentElement.querySelector('input[type="number"]');f&&(f.value=r)}else"SELECT"===e.tagName&&(e.value=r);window.uiManager&&window.uiManager.updateControlValue(n,r,null,null,!0)}})}}},{key:"logMIDI",value:function(e,n){var t=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null,r=(new Date).toLocaleTimeString(),o=document.getElementById("midi-log"),i=document.getElementById("modal-midi-log"),a=document.getElementById("mapper-midi-log"),c=document.createElement("div");c.className="midi-message ".concat("out"===e?"outgoing":"incoming");var s='<span class="midi-timestamp">'.concat(r,"</span> ");if(s+='<span class="midi-direction">'.concat(e.toUpperCase(),":</span> "),s+='<span class="midi-data">'.concat(n,"</span>"),t&&Array.isArray(t)){var l=t.map(function(e){return e.toString(16).padStart(2,"0").toUpperCase()}).join(" ");s+='<br><span class="midi-raw">['.concat(l,"]</span>")}if(c.innerHTML=s,o){var u=c.cloneNode(!0);o.appendChild(u);var d=document.getElementById("midi-monitor-content");d&&!d.classList.contains("hidden")&&(d.scrollTop=d.scrollHeight);var f=o.children;f.length>100&&o.removeChild(f[0])}if(i){var m=c.cloneNode(!0);i.appendChild(m),i.scrollTop=i.scrollHeight;var p=i.children;p.length>100&&i.removeChild(p[0])}if(a){var v=c.cloneNode(!0);a.appendChild(v),a.scrollTop=a.scrollHeight;var h=a.children;h.length>100&&a.removeChild(h[0])}}},{key:"handleCCPairUpdate",value:function(e,n,r){var o=this;document.querySelectorAll("[data-cc-pair]").forEach(function(r){var i=r.getAttribute("data-cc-pair").split(",").map(function(e){return parseInt(e.trim())}),a=function(e,n){return function(e){if(Array.isArray(e))return e}(e)||function(e,n){var t=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=t){var r,o,i,a,c=[],s=!0,l=!1;try{if(i=(t=t.call(e)).next,0===n){if(Object(t)!==t)return;s=!1}else for(;!(s=(r=i.call(t)).done)&&(c.push(r.value),c.length!==n);s=!0);}catch(e){l=!0,o=e}finally{try{if(!s&&null!=t.return&&(a=t.return(),Object(a)!==a))return}finally{if(l)throw o}}return c}}(e,n)||t(e,n)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}(i,2),c=a[0],s=a[1];if(e===c||e===s){var l="".concat(c,",").concat(s);o.ccPairValues.has(l)||o.ccPairValues.set(l,{msb:0,lsb:0});var u=o.ccPairValues.get(l);e===c?u.msb=n:e===s&&(u.lsb=n);var d=u.msb<<1|u.lsb>>6&1;o.updateUIElementFromCCPair(r,d)}})}},{key:"updateUIElementFromCCPair",value:function(e,n){var t=e._controlConfig;if(t){var r=n;if(void 0!==t.midi.min&&void 0!==t.midi.max){var o=t.midi.min,i=t.midi.max-o,a=t.min||0,c=(t.max||127)-a,s=(n-o)/i;r=Math.round(a+s*c)}if("INPUT"===e.tagName&&"range"===e.type){e.value=r;var l=e.parentElement.querySelector('input[type="number"]');l&&(l.value=r)}else if(e.classList.contains("knob")){var u=t.min||0,d=(r-u)/((t.max||255)-u)*100/100*270-135;e.style.transform="rotate(".concat(d,"deg)");var f=e.parentElement.querySelector('input[type="number"]');f&&(f.value=r)}window.uiManager&&window.uiManager.updateControlValue(t,r,null,null,!0)}}}],r&&c(e.prototype,r),Object.defineProperty(e,"prototype",{writable:!1}),e;var e,r,i,s}();window.midiManager=new l}},i={};function a(e){var n=i[e];if(void 0!==n)return n.exports;var t=i[e]={id:e,exports:{}};return o[e](t,t.exports,a),t.exports}a.m=o,a.n=e=>{var n=e&&e.__esModule?()=>e.default:()=>e;return a.d(n,{a:n}),n},n=Object.getPrototypeOf?e=>Object.getPrototypeOf(e):e=>e.__proto__,a.t=function(t,r){if(1&r&&(t=this(t)),8&r)return t;if("object"==typeof t&&t){if(4&r&&t.__esModule)return t;if(16&r&&"function"==typeof t.then)return t}var o=Object.create(null);a.r(o);var i={};e=e||[null,n({}),n([]),n(n)];for(var c=2&r&&t;("object"==typeof c||"function"==typeof c)&&!~e.indexOf(c);c=n(c))Object.getOwnPropertyNames(c).forEach(e=>i[e]=()=>t[e]);return i.default=()=>t,a.d(o,i),o},a.d=(e,n)=>{for(var t in n)a.o(n,t)&&!a.o(e,t)&&Object.defineProperty(e,t,{enumerable:!0,get:n[t]})},a.f={},a.e=e=>Promise.all(Object.keys(a.f).reduce((n,t)=>(a.f[t](e,n),n),[])),a.u=e=>e+".bundle.js",a.g=function(){if("object"==typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(e){if("object"==typeof window)return window}}(),a.o=(e,n)=>Object.prototype.hasOwnProperty.call(e,n),t={},r="arcsynth-editor:",a.l=(e,n,o,i)=>{if(t[e])t[e].push(n);else{var c,s;if(void 0!==o)for(var l=document.getElementsByTagName("script"),u=0;u<l.length;u++){var d=l[u];if(d.getAttribute("src")==e||d.getAttribute("data-webpack")==r+o){c=d;break}}c||(s=!0,(c=document.createElement("script")).charset="utf-8",c.timeout=120,a.nc&&c.setAttribute("nonce",a.nc),c.setAttribute("data-webpack",r+o),c.src=e),t[e]=[n];var f=(n,r)=>{c.onerror=c.onload=null,clearTimeout(m);var o=t[e];if(delete t[e],c.parentNode&&c.parentNode.removeChild(c),o&&o.forEach(e=>e(r)),n)return n(r)},m=setTimeout(f.bind(null,void 0,{type:"timeout",target:c}),12e4);c.onerror=f.bind(null,c.onerror),c.onload=f.bind(null,c.onload),s&&document.head.appendChild(c)}},a.r=e=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},(()=>{var e;a.g.importScripts&&(e=a.g.location+"");var n=a.g.document;if(!e&&n&&(n.currentScript&&"SCRIPT"===n.currentScript.tagName.toUpperCase()&&(e=n.currentScript.src),!e)){var t=n.getElementsByTagName("script");if(t.length)for(var r=t.length-1;r>-1&&(!e||!/^http(s?):/.test(e));)e=t[r--].src}if(!e)throw new Error("Automatic publicPath is not supported in this browser");e=e.replace(/^blob:/,"").replace(/#.*$/,"").replace(/\?.*$/,"").replace(/\/[^\/]+$/,"/"),a.p=e})(),(()=>{var e={792:0};a.f.j=(n,t)=>{var r=a.o(e,n)?e[n]:void 0;if(0!==r)if(r)t.push(r[2]);else{var o=new Promise((t,o)=>r=e[n]=[t,o]);t.push(r[2]=o);var i=a.p+a.u(n),c=new Error;a.l(i,t=>{if(a.o(e,n)&&(0!==(r=e[n])&&(e[n]=void 0),r)){var o=t&&("load"===t.type?"missing":t.type),i=t&&t.target&&t.target.src;c.message="Loading chunk "+n+" failed.\n("+o+": "+i+")",c.name="ChunkLoadError",c.type=o,c.request=i,r[1](c)}},"chunk-"+n,n)}};var n=(n,t)=>{var r,o,[i,c,s]=t,l=0;if(i.some(n=>0!==e[n])){for(r in c)a.o(c,r)&&(a.m[r]=c[r]);s&&s(a)}for(n&&n(t);l<i.length;l++)o=i[l],a.o(e,o)&&e[o]&&e[o][0](),e[o]=0},t=self.webpackChunkarcsynth_editor=self.webpackChunkarcsynth_editor||[];t.forEach(n.bind(null,0)),t.push=n.bind(null,t.push.bind(t))})(),a.nc=void 0,(()=>{"use strict";var e=a(72),n=a.n(e),t=a(825),r=a.n(t),o=a(659),i=a.n(o),c=a(56),s=a.n(c),l=a(540),u=a.n(l),d=a(113),f=a.n(d),m=a(365),p={};p.styleTagTransform=f(),p.setAttributes=s(),p.insert=i().bind(null,"head"),p.domAPI=r(),p.insertStyleElement=u(),n()(m.A,p),m.A&&m.A.locals&&m.A.locals;var v="undefined"!=typeof window&&!window.require;const h={isWeb:v,isElectron:!v,defaultConfigPath:"configs/novation-summit.json",showLoadConfigButton:!v,showFileMenus:!v,autoLoadDefaultConfig:v};function y(e){return y="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},y(e)}var g,b,w;function x(){var e,n,t="function"==typeof Symbol?Symbol:{},r=t.iterator||"@@iterator",o=t.toStringTag||"@@toStringTag";function i(t,r,o,i){var s=r&&r.prototype instanceof c?r:c,l=Object.create(s.prototype);return C(l,"_invoke",function(t,r,o){var i,c,s,l=0,u=o||[],d=!1,f={p:0,n:0,v:e,a:m,f:m.bind(e,4),d:function(n,t){return i=n,c=0,s=e,f.n=t,a}};function m(t,r){for(c=t,s=r,n=0;!d&&l&&!o&&n<u.length;n++){var o,i=u[n],m=f.p,p=i[2];t>3?(o=p===r)&&(s=i[(c=i[4])?5:(c=3,3)],i[4]=i[5]=e):i[0]<=m&&((o=t<2&&m<i[1])?(c=0,f.v=r,f.n=i[1]):m<p&&(o=t<3||i[0]>r||r>p)&&(i[4]=t,i[5]=r,f.n=p,c=0))}if(o||t>1)return a;throw d=!0,r}return function(o,u,p){if(l>1)throw TypeError("Generator is already running");for(d&&1===u&&m(u,p),c=u,s=p;(n=c<2?e:s)||!d;){i||(c?c<3?(c>1&&(f.n=-1),m(c,s)):f.n=s:f.v=s);try{if(l=2,i){if(c||(o="next"),n=i[o]){if(!(n=n.call(i,s)))throw TypeError("iterator result is not an object");if(!n.done)return n;s=n.value,c<2&&(c=0)}else 1===c&&(n=i.return)&&n.call(i),c<2&&(s=TypeError("The iterator does not provide a '"+o+"' method"),c=1);i=e}else if((n=(d=f.n<0)?s:t.call(r,f))!==a)break}catch(n){i=e,c=1,s=n}finally{l=1}}return{value:n,done:d}}}(t,o,i),!0),l}var a={};function c(){}function s(){}function l(){}n=Object.getPrototypeOf;var u=[][r]?n(n([][r]())):(C(n={},r,function(){return this}),n),d=l.prototype=c.prototype=Object.create(u);function f(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,l):(e.__proto__=l,C(e,o,"GeneratorFunction")),e.prototype=Object.create(d),e}return s.prototype=l,C(d,"constructor",l),C(l,"constructor",s),s.displayName="GeneratorFunction",C(l,o,"GeneratorFunction"),C(d),C(d,o,"Generator"),C(d,r,function(){return this}),C(d,"toString",function(){return"[object Generator]"}),(x=function(){return{w:i,m:f}})()}function C(e,n,t,r){var o=Object.defineProperty;try{o({},"",{})}catch(e){o=0}C=function(e,n,t,r){function i(n,t){C(e,n,function(e){return this._invoke(n,t,e)})}n?o?o(e,n,{value:t,enumerable:!r,configurable:!r,writable:!r}):e[n]=t:(i("next",0),i("throw",1),i("return",2))},C(e,n,t,r)}function E(e,n){for(var t=0;t<n.length;t++){var r=n[t];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,k(r.key),r)}}function k(e){var n=function(e){if("object"!=y(e)||!e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var t=n.call(e,"string");if("object"!=y(t))return t;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"==y(n)?n:n+""}function M(e,n,t,r,o,i,a){try{var c=e[i](a),s=c.value}catch(e){return void t(e)}c.done?n(s):Promise.resolve(s).then(r,o)}function S(e){return function(){var n=this,t=arguments;return new Promise(function(r,o){var i=e.apply(n,t);function a(e){M(i,r,o,a,c,"next",e)}function c(e){M(i,r,o,a,c,"throw",e)}a(void 0)})}}var I="undefined"!=typeof window&&window.require,P="undefined"!=typeof process&&(null===(g=process.versions)||void 0===g?void 0:g.node);function D(){return A.apply(this,arguments)}function A(){return A=S(x().m(function e(){var n,t;return x().w(function(e){for(;;)switch(e.p=e.n){case 0:if(!P||I){e.n=6;break}return e.p=1,e.n=2,a.e(603).then(a.t.bind(a,603,23));case 2:return n=e.v,e.n=3,a.e(247).then(a.t.bind(a,247,23));case 3:t=e.v,b=n,w=t,e.n=5;break;case 4:e.p=4,e.v;case 5:e.n=7;break;case 6:if(I)try{b=window.require("fs"),w=window.require("path")}catch(e){}case 7:return e.a(2)}},e,null,[[1,4]])})),A.apply(this,arguments)}var T=new(function(){return e=function e(){!function(e,n){if(!(e instanceof n))throw new TypeError("Cannot call a class as a function")}(this,e),this.maxLogSize=5242880,this.isMainProcess="undefined"==typeof window,this.initialized=!1,this.initialize()},n=[{key:"initialize",value:(r=S(x().m(function e(){return x().w(function(e){for(;;)switch(e.n){case 0:if(this.initialized){e.n=2;break}return e.n=1,D();case 1:w&&(this.logFilePath=w.join(process.cwd(),"arcsynth-editor.log")),this.initialized=!0;case 2:return e.a(2)}},e,this)})),function(){return r.apply(this,arguments)})},{key:"formatMessage",value:function(e,n){var t=(new Date).toISOString();return"[".concat(t,"] ").concat(e.toUpperCase(),": ").concat(n)}},{key:"writeToFile",value:(t=S(x().m(function e(n){var t;return x().w(function(e){for(;;)switch(e.n){case 0:return e.n=1,this.initialize();case 1:if(b&&this.logFilePath){e.n=2;break}return e.a(2);case 2:try{b.existsSync(this.logFilePath)&&b.statSync(this.logFilePath).size>this.maxLogSize&&(t=this.logFilePath.replace(".log","-".concat(Date.now(),".log")),b.renameSync(this.logFilePath,t)),b.appendFileSync(this.logFilePath,n+"\n","utf8")}catch(e){console.error("Failed to write to log file:",e.message)}case 3:return e.a(2)}},e,this)})),function(e){return t.apply(this,arguments)})},{key:"error",value:function(e){var n=this.formatMessage("error",e);if(console.error(e),this.isMainProcess)this.writeToFile(n);else if(I)try{window.require("electron").ipcRenderer.invoke("log-error",n).catch(function(){})}catch(e){}}},{key:"warn",value:function(e){console.warn(e)}},{key:"info",value:function(e){console.log(e)}},{key:"debug",value:function(e){}}],n&&E(e.prototype,n),Object.defineProperty(e,"prototype",{writable:!1}),e;var e,n,t,r}());const N=T;var V=function(e){return T.error(e)};function L(e){return L="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},L(e)}function j(e,n){return function(e){if(Array.isArray(e))return e}(e)||function(e,n){var t=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=t){var r,o,i,a,c=[],s=!0,l=!1;try{if(i=(t=t.call(e)).next,0===n){if(Object(t)!==t)return;s=!1}else for(;!(s=(r=i.call(t)).done)&&(c.push(r.value),c.length!==n);s=!0);}catch(e){l=!0,o=e}finally{try{if(!s&&null!=t.return&&(a=t.return(),Object(a)!==a))return}finally{if(l)throw o}}return c}}(e,n)||B(e,n)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function O(e,n){var t="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!t){if(Array.isArray(e)||(t=B(e))||n&&e&&"number"==typeof e.length){t&&(e=t);var r=0,o=function(){};return{s:o,n:function(){return r>=e.length?{done:!0}:{done:!1,value:e[r++]}},e:function(e){throw e},f:o}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var i,a=!0,c=!1;return{s:function(){t=t.call(e)},n:function(){var e=t.next();return a=e.done,e},e:function(e){c=!0,i=e},f:function(){try{a||null==t.return||t.return()}finally{if(c)throw i}}}}function B(e,n){if(e){if("string"==typeof e)return _(e,n);var t={}.toString.call(e).slice(8,-1);return"Object"===t&&e.constructor&&(t=e.constructor.name),"Map"===t||"Set"===t?Array.from(e):"Arguments"===t||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(t)?_(e,n):void 0}}function _(e,n){(null==n||n>e.length)&&(n=e.length);for(var t=0,r=Array(n);t<n;t++)r[t]=e[t];return r}function F(e,n){for(var t=0;t<n.length;t++){var r=n[t];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,z(r.key),r)}}function z(e){var n=function(e){if("object"!=L(e)||!e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var t=n.call(e,"string");if("object"!=L(t))return t;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"==L(n)?n:n+""}a(938),a(501);var q=function(){return e=function e(n){!function(e,n){if(!(e instanceof n))throw new TypeError("Cannot call a class as a function")}(this,e),this.synthEditor=n,this.baselineSysEx=null,this.currentTestSysEx=null,this.parameterList=[],this.currentParameterIndex=0,this.mappingResults={},this.currentParameterResults=[],this.isAutoRunning=!1,this.autoRunTimeout=null,this.dumpMappingData=null,this.convertedParameters=null,this.sysexListener=null,this.dumpListener=null},n=[{key:"setupDumpReceiver",value:function(){var e=this,n=document.getElementById("get-dump"),t=document.getElementById("start-dump-receiver"),r=document.getElementById("stop-dump-receiver"),o=document.getElementById("apply-dump-values");this.checkDumpMappingAvailability(),n.addEventListener("click",function(){e.getDumpFromSynth()}),t.addEventListener("click",function(){e.dumpMappingData?e.startDumpReceiving():e.synthEditor.notificationManager.error("No SysEx mapping data found. Create mapping first in SysEx Mapper tab.")}),r.addEventListener("click",function(){e.stopDumpReceiving()}),o.addEventListener("click",function(){e.applyConvertedValues()})}},{key:"checkDumpMappingAvailability",value:function(){var e=document.getElementById("dump-mapping-status");if(!window.uiManager.currentConfig)return e.textContent="No synthesizer configuration loaded.",void(e.className="status-message error");this.dumpMappingData=this.extractSysExMappingFromConfig(),this.dumpMappingData&&Object.keys(this.dumpMappingData).length>0?(e.textContent="✓ Found SysEx mapping in config: ".concat(Object.keys(this.dumpMappingData).length," parameters"),e.className="status-message success"):(this.dumpMappingData=null,e.textContent="No SysEx mapping found in config. Use SysEx Mapper to create mapping.",e.className="status-message warning")}},{key:"extractSysExMappingFromConfig",value:function(){var e=window.uiManager.currentConfig;if(!e)return{};var n,t={},r=O(e.tabs||[]);try{for(r.s();!(n=r.n()).done;){var o,i=O(n.value.sections||[]);try{for(i.s();!(o=i.n()).done;){var a=o.value;this.extractSysExFromSection(a,t)}}catch(e){i.e(e)}finally{i.f()}}}catch(e){r.e(e)}finally{r.f()}return t}},{key:"extractSysExFromSection",value:function(e,n){var t,r=O(e.controls||[]);try{for(r.s();!(t=r.n()).done;){var o=t.value;o.sysEx&&o.id&&(n[o.id]=o.sysEx)}}catch(e){r.e(e)}finally{r.f()}if(e.template){var i,a=O(this.expandTemplate(e.template));try{for(a.s();!(i=a.n()).done;){var c=i.value;c.sysEx&&c.id&&(n[c.id]=c.sysEx)}}catch(e){a.e(e)}finally{a.f()}}var s,l=O(e.subsections||[]);try{for(l.s();!(s=l.n()).done;){var u=s.value;this.extractSysExFromSection(u,n)}}catch(e){l.e(e)}finally{l.f()}}},{key:"startDumpReceiving",value:function(){var e=this;if(window.midiManager.inputDevice){var n=document.getElementById("start-dump-receiver"),t=document.getElementById("stop-dump-receiver"),r=document.getElementById("dump-conversion-status");n.style.display="none",t.style.display="inline-block",r.textContent="Listening for SysEx dumps...",r.className="status-message info",this.dumpListener=function(n){if(n.data&&n.data.length>2&&240===n.data[0]&&247===n.data[n.data.length-1]){var t=Array.from(n.data).map(function(e){return e.toString(16).toUpperCase().padStart(2,"0")}).join(" ");e.processDumpData(t)}},window.midiManager.inputDevice.addEventListener("midimessage",this.dumpListener)}else this.synthEditor.notificationManager.error("No MIDI input device connected.")}},{key:"stopDumpReceiving",value:function(){document.getElementById("start-dump-receiver").style.display="inline-block",document.getElementById("stop-dump-receiver").style.display="none",window.midiManager.inputDevice&&this.dumpListener&&(window.midiManager.inputDevice.removeEventListener("midimessage",this.dumpListener),this.dumpListener=null)}},{key:"processDumpData",value:function(e){document.getElementById("received-dump").value=e;var n=document.getElementById("dump-conversion-status");try{this.convertedParameters=this.convertDumpToParameters(e),this.displayConvertedParameters(),n.textContent="✓ Dump converted: ".concat(Object.keys(this.convertedParameters).length," parameters found"),n.className="status-message success",document.getElementById("apply-dump-values").disabled=!1}catch(e){n.textContent="Conversion failed: ".concat(e.message),n.className="status-message error",console.error("Dump conversion error:",e)}}},{key:"convertDumpToParameters",value:function(e){if(!this.dumpMappingData)throw new Error("No mapping data available");for(var n=e.split(" "),t={},r=0,o=Object.entries(this.dumpMappingData);r<o.length;r++){var i=j(o[r],2),a=i[0],c=i[1];try{var s=this.extractParameterValue(n,c);if(null!==s){var l=this.findParameterInConfig(a),u=this.convertRawToControlValue(s,c,l);t[a]={name:(null==l?void 0:l.name)||a,rawValue:s,controlValue:u,mappingInfo:c,paramConfig:l}}}catch(e){console.warn("Failed to extract parameter ".concat(a,":"),e)}}return t}},{key:"extractParameterValue",value:function(e,n){var t=n.type,r=n.offsets;if(!r||!Array.isArray(r)||0===r.length)return null;if("standard-7bit"===t||"select-7bit"===t||"toggle-7bit"===t||"range-7bit"===t){var o=r[0];if(o>=0&&o<e.length)return parseInt(e[o],16)}if("precision-7bit"===t&&r.length>=2){var i=r[0],a=r[1];if(i>=0&&i<e.length&&a>=0&&a<e.length)return{msb:parseInt(e[i],16),lsb:parseInt(e[a],16)}}if("text-16"===t&&r.length>=16){for(var c=[],s=0;s<16;s++){var l=r[s];if(!(l>=0&&l<e.length))return null;var u=parseInt(e[l],16);c.push(u)}return c}return null}},{key:"convertRawToControlValue",value:function(e,n,t){var r=null==t?void 0:t.type;if("select-7bit"===n.type){if("select"===r&&null!=t&&t.midiValues&&null!=t&&t.options){var o=t.midiValues,i=o.indexOf(e);return i>=0&&i<t.options.length?e:(console.warn("select-7bit: raw value ".concat(e," not found in midiValues for ").concat(t.id||"unknown")),o[0]||0)}return e}if("standard-7bit"===n.type){var a,c,s=null!==(a=null==t?void 0:t.min)&&void 0!==a?a:0,l=null!==(c=null==t?void 0:t.max)&&void 0!==c?c:127;return 0===s&&127===l?e:128==l-s+1?Math.round(e/127*(l-s)+s):e}if("toggle-7bit"===n.type)return"button"===r&&void 0!==(null==t?void 0:t.onValue)&&void 0!==(null==t?void 0:t.offValue)?e===t.onValue?1:(e===t.offValue||console.warn("toggle-7bit: raw value ".concat(e," doesn't match onValue (").concat(t.onValue,") or offValue (").concat(t.offValue,") for ").concat(t.id||"unknown")),0):127===e?1:0;if("range-7bit"===n.type){var u,d,f,m,p=null!==(u=null==t?void 0:t.min)&&void 0!==u?u:0,v=null!==(d=null==t?void 0:t.max)&&void 0!==d?d:127;if(void 0!==(null==t||null===(f=t.midi)||void 0===f?void 0:f.min)&&void 0!==(null==t||null===(m=t.midi)||void 0===m?void 0:m.max)){var h=t.midi.min,y=t.midi.max-h,g=v-p;if(0===y)return console.warn("range-7bit: MIDI range is zero for ".concat(t.id||"unknown")),p;var b=(e-h)/y*g+p;return Math.round(100*b)/100}return e}if("precision-7bit"===n.type){var w;if(e&&"object"===L(e)&&void 0!==e.msb&&void 0!==e.lsb){var x,C,E,k,M=e.msb,S=e.lsb,I=null!==(x=null==t?void 0:t.min)&&void 0!==x?x:0,P=null!==(C=null==t?void 0:t.max)&&void 0!==C?C:127,D=null==t||null===(E=t.midi)||void 0===E?void 0:E.min,A=null==t||null===(k=t.midi)||void 0===k?void 0:k.max;if(void 0!==D&&void 0!==A){var T=I+(2*M+(64===S?1:0)-D)/(A-D)*(P-I);return Math.max(I,Math.min(P,T))}var N,V=null!==(N=null==t?void 0:t.step)&&void 0!==N?N:1,j=I+(2*M+(64===S?1:0))*V,O=Math.max(I,Math.min(P,j)),B=V<1?Math.max(0,-Math.floor(Math.log10(V))):0;return Math.round(O*Math.pow(10,B))/Math.pow(10,B)}return null!==(w=null==t?void 0:t.min)&&void 0!==w?w:0}if("text-16"===n.type){if(Array.isArray(e)&&e.length>=16){for(var _="",F=0;F<16;F++){var z=e[F];_+=z>=32&&z<=126?String.fromCharCode(z):" "}return _.trimEnd()}return"Unknown"}return e}},{key:"generatePatchDump",value:function(){var e=window.uiManager.currentConfig;if(!e)throw new Error("No configuration loaded");if(!e.initPatch)return console.warn("No initPatch template available for SysEx dump generation"),null;var n=this.parseHexTemplate(e.initPatch);return this.populateParameterValues(n),n}},{key:"parseHexTemplate",value:function(e){return e.trim().split(/\s+/).map(function(e){return parseInt(e,16)})}},{key:"populateParameterValues",value:function(e){var n,t=O(window.uiManager.currentConfig.tabs||[]);try{for(t.s();!(n=t.n()).done;){var r,o=O(n.value.sections||[]);try{for(o.s();!(r=o.n()).done;){var i=r.value;this.populateFromSection(i,e)}}catch(e){o.e(e)}finally{o.f()}}}catch(e){t.e(e)}finally{t.f()}}},{key:"populateFromSection",value:function(e,n){var t=0;if(e.controls){var r,o=O(e.controls);try{for(o.s();!(r=o.n()).done;){var i=r.value;t++,i.sysEx&&this.populateControlValue(i,n)}}catch(e){o.e(e)}finally{o.f()}}if(e.subsections){var a,c=O(e.subsections);try{for(c.s();!(a=c.n()).done;){var s=a.value;if(s.controls){var l,u=O(s.controls);try{for(u.s();!(l=u.n()).done;){var d=l.value;t++,d.sysEx&&this.populateControlValue(d,n)}}catch(e){u.e(e)}finally{u.f()}}}}catch(e){c.e(e)}finally{c.f()}}return t}},{key:"populateControlValue",value:function(e,n){if(e.sysEx&&e.sysEx.offsets&&e.id){var t=window.uiManager.controlValues.get(e.id);if(void 0===t&&(t=e.default),void 0!==t){var r=e.sysEx.type,o=e.sysEx.offsets;try{this.writeValueToSysEx(t,r,o,e,n)}catch(n){console.warn("✗ Failed to write ".concat(e.id," to SysEx:"),n)}}else console.warn("No value available for control ".concat(e.id,", leaving SysEx bytes as 0x00"))}}},{key:"writeValueToSysEx",value:function(e,n,t,r,o){switch(n){case"standard-7bit":case"select-7bit":case"toggle-7bit":case"range-7bit":if(t.length>0){var i=this.convertControlToRawValue(e,n,r);o[t[0]]=Math.max(0,Math.min(127,i))}break;case"precision-7bit":if(t.length>=2){var a=this.convertControlToPrecisionBytes(e,r),c=a.msb,s=a.lsb;o[t[0]]=c,o[t[1]]=s}break;case"text-16":if(t.length>=16)for(var l=this.convertControlToTextBytes(e),u=0;u<16;u++)o[t[u]]=l[u];break;default:console.warn("Unknown SysEx type: ".concat(n))}}},{key:"convertControlToRawValue",value:function(e,n,t){if("select-7bit"===n)return e;var r,o,i,a;if("toggle-7bit"===n)return 1===e?null!==(r=t.onValue)&&void 0!==r?r:127:null!==(o=t.offValue)&&void 0!==o?o:0;if("range-7bit"===n&&void 0!==(null===(i=t.midi)||void 0===i?void 0:i.min)&&void 0!==(null===(a=t.midi)||void 0===a?void 0:a.max)){var c,s,l=null!==(c=t.min)&&void 0!==c?c:0,u=null!==(s=t.max)&&void 0!==s?s:127,d=t.midi.min,f=t.midi.max,m=(e-l)/(u-l);return Math.round(d+m*(f-d))}if("standard-7bit"===n){var p,v,h=null!==(p=null==t?void 0:t.min)&&void 0!==p?p:0,y=null!==(v=null==t?void 0:t.max)&&void 0!==v?v:127;return 0===h&&127===y?Math.round(e):128==y-h+1?Math.round((e-h)/(y-h)*127):Math.round(e)}return Math.round(e)}},{key:"convertControlToPrecisionBytes",value:function(e,n){var t,r,o,i,a,c=null!==(t=n.min)&&void 0!==t?t:0,s=null!==(r=n.max)&&void 0!==r?r:127,l=null==n||null===(o=n.midi)||void 0===o?void 0:o.min,u=null==n||null===(i=n.midi)||void 0===i?void 0:i.max;if(void 0!==l&&void 0!==u){var d=u-l,f=(e-c)/(s-c);a=Math.round(l+f*d)}else{var m,p=null!==(m=n.step)&&void 0!==m?m:1;a=Math.round((e-c)/p)}var v=Math.floor(a/2),h=a%2==1?64:0;return{msb:Math.max(0,Math.min(127,v)),lsb:h}}},{key:"convertControlToTextBytes",value:function(e){for(var n=String(e||"").substring(0,16),t=new Array(16).fill(32),r=0;r<n.length;r++){var o=n.charCodeAt(r);t[r]=o>=32&&o<=126?o:32}return t}},{key:"displayConvertedParameters",value:function(){var e=document.getElementById("converted-params"),n=document.getElementById("param-list");if(this.convertedParameters&&0!==Object.keys(this.convertedParameters).length){for(var t="",r=0,o=Object.entries(this.convertedParameters);r<o.length;r++){var i,a=j(o[r],2)[1];i=Array.isArray(a.rawValue)?"[".concat(a.rawValue.join(", "),"]"):"object"===L(a.rawValue)&&null!==a.rawValue?"{".concat(Object.entries(a.rawValue).map(function(e){var n=j(e,2),t=n[0],r=n[1];return"".concat(t,":").concat(r)}).join(", "),"}"):a.rawValue,t+='<div style="margin-bottom: 0.5rem; padding: 0.25rem; border-left: 3px solid #4a90e2; background: rgba(74, 144, 226, 0.05);">\n                <strong>'.concat(a.name,"</strong>: ").concat(a.controlValue,'\n                <span style="color: #888; font-size: 0.8rem;"> (raw: ').concat(i,")</span>\n            </div>")}n.innerHTML=t,e.style.display="block"}else e.style.display="none"}},{key:"applyConvertedValuesToUI",value:function(){if(this.convertedParameters)if(window.uiManager&&window.uiManager.currentConfig){for(var e=0,n=0,t=0,r=Object.entries(this.convertedParameters);t<r.length;t++){var o=j(r[t],2),i=o[0],a=o[1],c=this.findControlConfig(i);c?(window.uiManager.controlValues.set(i,a.controlValue),window.uiManager.updateSingleUIElement(c),e++):n++}e>0&&this.synthEditor.notificationManager.success("Applied ".concat(e," parameter values to editor controls.")),n>0&&console.warn("".concat(n," parameters not found in current configuration."))}else this.synthEditor.notificationManager.error("No synthesizer configuration loaded.");else this.synthEditor.notificationManager.warning("No converted parameters to apply.")}},{key:"applyConvertedValues",value:function(){if(this.convertedParameters)if(window.uiManager&&window.uiManager.currentConfig)if(window.midiManager.isConnected){this.applyConvertedValuesToUI();var e=Object.keys(this.convertedParameters).length;e>0&&(this.synthEditor.notificationManager.info("Sending ".concat(e," parameter values to synthesizer...")),window.uiManager.sendAllParameters())}else this.synthEditor.notificationManager.info("No MIDI device connected. Please connect a MIDI device first.");else this.synthEditor.notificationManager.error("No synthesizer configuration loaded.");else this.synthEditor.notificationManager.warning("No converted parameters to apply.")}},{key:"getDumpFromSynth",value:function(){var e,n,t,r=this;if(window.midiManager.isConnected)if(null!==(e=window.uiManager)&&void 0!==e&&e.currentConfig){var o=window.uiManager.currentConfig;null!==(n=o.patchDumpRequest)&&void 0!==n&&n.type&&null!==(t=o.patchDumpRequest)&&void 0!==t&&t.data?(this.synthEditor.notificationManager.info("Requesting patch dump from synthesizer..."),this.requestPatchDump()?this.listenForSysEx(function(e){r.synthEditor.notificationManager.success("Patch dump received!"),r.processDumpData(e),r.convertedParameters&&Object.keys(r.convertedParameters).length>0&&r.applyConvertedValuesToUI()}):this.synthEditor.notificationManager.info("Failed to send patch dump request. Please check your MIDI connection.","error")):this.synthEditor.notificationManager.info("This synthesizer configuration does not support automatic patch dump requests.")}else this.synthEditor.notificationManager.warning("No synthesizer configuration loaded.");else this.synthEditor.notificationManager.info("No MIDI device connected. Please connect a MIDI device first.")}},{key:"findParameterInConfig",value:function(e){var n,t,r=O((null===(n=window.uiManager.currentConfig)||void 0===n?void 0:n.tabs)||[]);try{for(r.s();!(t=r.n()).done;){var o,i=O(t.value.sections||[]);try{for(i.s();!(o=i.n()).done;){var a=o.value,c=this.findParameterInSection(a,e);if(c)return c}}catch(e){i.e(e)}finally{i.f()}}}catch(e){r.e(e)}finally{r.f()}return null}},{key:"findParameterInSection",value:function(e,n){var t,r,o=O(e.controls||[]);try{for(o.s();!(r=o.n()).done;){var i=r.value;if(i.id===n)return i}}catch(e){o.e(e)}finally{o.f()}if(e.template&&null!==(t=window.uiManager)&&void 0!==t&&t.expandTemplate){var a,c=O(window.uiManager.expandTemplate(e.template));try{for(c.s();!(a=c.n()).done;){var s=a.value;if(s.id===n)return s}}catch(e){c.e(e)}finally{c.f()}}var l,u=O(e.subsections||[]);try{for(u.s();!(l=u.n()).done;){var d=l.value,f=this.findParameterInSection(d,n);if(f)return f}}catch(e){u.e(e)}finally{u.f()}return null}},{key:"findControlConfig",value:function(e){var n,t,r=O((null===(n=window.uiManager.currentConfig)||void 0===n?void 0:n.tabs)||[]);try{for(r.s();!(t=r.n()).done;){var o,i=O(t.value.sections||[]);try{for(i.s();!(o=i.n()).done;){var a=o.value,c=this.findControlInSection(a,e);if(c)return c}}catch(e){i.e(e)}finally{i.f()}}}catch(e){r.e(e)}finally{r.f()}return null}},{key:"findControlInSection",value:function(e,n){var t,r=O(e.controls||[]);try{for(r.s();!(t=r.n()).done;){var o=t.value;if(o.id===n)return o}}catch(e){r.e(e)}finally{r.f()}if(e.template){var i,a=O(this.expandTemplate(e.template));try{for(a.s();!(i=a.n()).done;){var c=i.value;if(c.id===n)return c}}catch(e){a.e(e)}finally{a.f()}}var s,l=O(e.subsections||[]);try{for(l.s();!(s=l.n()).done;){var u=s.value,d=this.findControlInSection(u,n);if(d)return d}}catch(e){l.e(e)}finally{l.f()}return null}},{key:"requestPatchDump",value:function(){var e,n,t=null===(e=window.uiManager)||void 0===e?void 0:e.currentConfig;if("sysex"===(null==t||null===(n=t.patchDumpRequest)||void 0===n?void 0:n.type)&&window.midiManager.isConnected){var r=t.patchDumpRequest.data.split(" ").map(function(e){return parseInt(e,16)});return window.midiManager.sendSysEx(r),!0}return!1}},{key:"listenForSysEx",value:function(e){var n=this;this.stopListening(),this.sysexListener=function(t){if(t.data&&240===t.data[0]&&247===t.data[t.data.length-1]){var r=Array.from(t.data).map(function(e){return e.toString(16).toUpperCase().padStart(2,"0")}).join(" ");e(r),n.stopListening()}},window.midiManager.inputDevice&&window.midiManager.inputDevice.addEventListener("midimessage",this.sysexListener)}},{key:"stopListening",value:function(){window.midiManager.inputDevice&&this.sysexListener&&(window.midiManager.inputDevice.removeEventListener("midimessage",this.sysexListener),this.sysexListener=null)}}],n&&F(e.prototype,n),Object.defineProperty(e,"prototype",{writable:!1}),e;var e,n}();const U=q;function R(e){return R="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},R(e)}function H(){var e,n,t="function"==typeof Symbol?Symbol:{},r=t.iterator||"@@iterator",o=t.toStringTag||"@@toStringTag";function i(t,r,o,i){var s=r&&r.prototype instanceof c?r:c,l=Object.create(s.prototype);return G(l,"_invoke",function(t,r,o){var i,c,s,l=0,u=o||[],d=!1,f={p:0,n:0,v:e,a:m,f:m.bind(e,4),d:function(n,t){return i=n,c=0,s=e,f.n=t,a}};function m(t,r){for(c=t,s=r,n=0;!d&&l&&!o&&n<u.length;n++){var o,i=u[n],m=f.p,p=i[2];t>3?(o=p===r)&&(s=i[(c=i[4])?5:(c=3,3)],i[4]=i[5]=e):i[0]<=m&&((o=t<2&&m<i[1])?(c=0,f.v=r,f.n=i[1]):m<p&&(o=t<3||i[0]>r||r>p)&&(i[4]=t,i[5]=r,f.n=p,c=0))}if(o||t>1)return a;throw d=!0,r}return function(o,u,p){if(l>1)throw TypeError("Generator is already running");for(d&&1===u&&m(u,p),c=u,s=p;(n=c<2?e:s)||!d;){i||(c?c<3?(c>1&&(f.n=-1),m(c,s)):f.n=s:f.v=s);try{if(l=2,i){if(c||(o="next"),n=i[o]){if(!(n=n.call(i,s)))throw TypeError("iterator result is not an object");if(!n.done)return n;s=n.value,c<2&&(c=0)}else 1===c&&(n=i.return)&&n.call(i),c<2&&(s=TypeError("The iterator does not provide a '"+o+"' method"),c=1);i=e}else if((n=(d=f.n<0)?s:t.call(r,f))!==a)break}catch(n){i=e,c=1,s=n}finally{l=1}}return{value:n,done:d}}}(t,o,i),!0),l}var a={};function c(){}function s(){}function l(){}n=Object.getPrototypeOf;var u=[][r]?n(n([][r]())):(G(n={},r,function(){return this}),n),d=l.prototype=c.prototype=Object.create(u);function f(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,l):(e.__proto__=l,G(e,o,"GeneratorFunction")),e.prototype=Object.create(d),e}return s.prototype=l,G(d,"constructor",l),G(l,"constructor",s),s.displayName="GeneratorFunction",G(l,o,"GeneratorFunction"),G(d),G(d,o,"Generator"),G(d,r,function(){return this}),G(d,"toString",function(){return"[object Generator]"}),(H=function(){return{w:i,m:f}})()}function G(e,n,t,r){var o=Object.defineProperty;try{o({},"",{})}catch(e){o=0}G=function(e,n,t,r){function i(n,t){G(e,n,function(e){return this._invoke(n,t,e)})}n?o?o(e,n,{value:t,enumerable:!r,configurable:!r,writable:!r}):e[n]=t:(i("next",0),i("throw",1),i("return",2))},G(e,n,t,r)}function W(e,n,t,r,o,i,a){try{var c=e[i](a),s=c.value}catch(e){return void t(e)}c.done?n(s):Promise.resolve(s).then(r,o)}function J(e){return function(){var n=this,t=arguments;return new Promise(function(r,o){var i=e.apply(n,t);function a(e){W(i,r,o,a,c,"next",e)}function c(e){W(i,r,o,a,c,"throw",e)}a(void 0)})}}function K(e,n){for(var t=0;t<n.length;t++){var r=n[t];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,Y(r.key),r)}}function Y(e){var n=function(e){if("object"!=R(e)||!e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var t=n.call(e,"string");if("object"!=R(t))return t;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"==R(n)?n:n+""}var $,X,Q,Z="undefined"!=typeof window&&window.require,ee="undefined"!=typeof window&&!window.require;!function(){if(Z)try{$=window.require("fs"),X=window.require("path");var e=window.require("electron");Q=e.ipcRenderer}catch(e){console.warn("Node integration not available in Electron renderer")}}();var ne=function(){return e=function e(){!function(e,n){if(!(e instanceof n))throw new TypeError("Cannot call a class as a function")}(this,e),this.userConfigPath=X?X.join(process.cwd(),"user-config.json"):"user-config",this.userConfig=this.loadUserConfig()},n=[{key:"getConfigsPath",value:function(){return ee?"configs":process.resourcesPath?X.join(process.resourcesPath,"configs"):X.join(process.cwd(),"configs")}},{key:"loadUserConfig",value:function(){try{if($&&$.existsSync&&$.existsSync(this.userConfigPath))return JSON.parse($.readFileSync(this.userConfigPath,"utf8"));if(ee){var e=localStorage.getItem(this.userConfigPath);if(e)return JSON.parse(e)}}catch(e){V("Error loading user config: "+e.message)}return{lastMidiOutput:null,lastMidiInput:null,lastConfigFile:null,lastPatchFolder:null}}},{key:"saveUserConfig",value:function(){try{$&&$.writeFileSync?$.writeFileSync(this.userConfigPath,JSON.stringify(this.userConfig,null,2)):ee&&localStorage.setItem(this.userConfigPath,JSON.stringify(this.userConfig))}catch(e){V("Error saving user config: "+e.message)}}},{key:"loadConfigFile",value:(o=J(H().m(function e(){var n,t,r,o,i,a;return H().w(function(e){for(;;)switch(e.p=e.n){case 0:if(!ee){e.n=1;break}return e.a(2,this.loadConfigFileBrowser());case 1:e.p=1,n={title:"Load Synthesizer Configuration",filters:[{name:"JSON Configs",extensions:["json"]}],properties:["openFile"]};try{this.userConfig.lastConfigFile&&"string"==typeof this.userConfig.lastConfigFile?(t=X.dirname(this.userConfig.lastConfigFile))&&"string"==typeof t&&$.existsSync(t)&&(n.defaultPath=t):(r=this.getConfigsPath())&&"string"==typeof r&&$.existsSync(r)&&(n.defaultPath=r)}catch(e){V("Error setting default path for config dialog: "+e.message)}return e.n=2,Q.invoke("show-open-dialog",n);case 2:if(!(o=e.v)){e.n=3;break}return i=JSON.parse($.readFileSync(o,"utf8")),this.userConfig.lastConfigFile=o,this.saveUserConfig(),e.a(2,{config:i,filePath:o});case 3:return e.a(2,null);case 4:throw e.p=4,a=e.v,V("Error in loadConfigFile: "+a.message+" | Stack: "+a.stack),new Error("Error loading configuration: "+a.message);case 5:return e.a(2)}},e,this,[[1,4]])})),function(){return o.apply(this,arguments)})},{key:"loadConfigFileBrowser",value:function(){var e=this;return new Promise(function(n){var t=document.createElement("input");t.type="file",t.accept=".json",t.onchange=function(){var t=J(H().m(function t(r){var o,i,a,c;return H().w(function(t){for(;;)switch(t.p=t.n){case 0:if(!(o=r.target.files[0])){t.n=5;break}return t.p=1,t.n=2,o.text();case 2:i=t.v,a=JSON.parse(i),e.userConfig.lastConfigFile=o.name,e.saveUserConfig(),n({config:a,filePath:o.name}),t.n=4;break;case 3:t.p=3,c=t.v,V("Error parsing config file: "+c.message),n(null);case 4:t.n=6;break;case 5:n(null);case 6:return t.a(2)}},t,null,[[1,3]])}));return function(e){return t.apply(this,arguments)}}(),t.click()})}},{key:"loadConfigFromPath",value:(r=J(H().m(function e(n){var t,r,o,i;return H().w(function(e){for(;;)switch(e.p=e.n){case 0:if(e.p=0,!$||!$.readFileSync){e.n=1;break}return t=JSON.parse($.readFileSync(n,"utf8")),e.a(2,t);case 1:if(!ee){e.n=4;break}return e.n=2,fetch(n);case 2:if(!(r=e.v).ok){e.n=4;break}return e.n=3,r.json();case 3:return o=e.v,e.a(2,o);case 4:e.n=6;break;case 5:return e.p=5,i=e.v,V("Error auto-loading config: "+i.message),e.a(2,null);case 6:return e.a(2,null)}},e,null,[[0,5]])})),function(e){return r.apply(this,arguments)})},{key:"getAvailableConfigs",value:(t=J(H().m(function e(){var n,t,r;return H().w(function(e){for(;;)switch(e.p=e.n){case 0:if(e.p=0,n=this.getConfigsPath(),!($&&$.existsSync&&$.readdirSync)){e.n=2;break}if($.existsSync(n)){e.n=1;break}return e.a(2,[]);case 1:return t=$.readdirSync(n),e.a(2,t.filter(function(e){return e.endsWith(".json")}).map(function(e){return{name:e,path:X.join(n,e)}}));case 2:if(!ee){e.n=3;break}return e.a(2,[{name:"example-synth.json",path:"configs/example-synth.json"},{name:"novation-summit.json",path:"configs/novation-summit.json"}]);case 3:return e.a(2,[]);case 4:return e.p=4,r=e.v,V("Error listing configs: "+r.message),e.a(2,[])}},e,this,[[0,4]])})),function(){return t.apply(this,arguments)})},{key:"validateConfig",value:function(e){if(!e||"object"!==R(e))throw new Error("Invalid configuration format");if(!e.name)throw new Error('Configuration missing required "name" field');if(!e.tabs||!Array.isArray(e.tabs))throw new Error('Configuration missing required "tabs" array');return!0}}],n&&K(e.prototype,n),Object.defineProperty(e,"prototype",{writable:!1}),e;var e,n,t,r,o}();const te=ne;function re(e){return re="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},re(e)}function oe(){var e,n,t="function"==typeof Symbol?Symbol:{},r=t.iterator||"@@iterator",o=t.toStringTag||"@@toStringTag";function i(t,r,o,i){var s=r&&r.prototype instanceof c?r:c,l=Object.create(s.prototype);return ie(l,"_invoke",function(t,r,o){var i,c,s,l=0,u=o||[],d=!1,f={p:0,n:0,v:e,a:m,f:m.bind(e,4),d:function(n,t){return i=n,c=0,s=e,f.n=t,a}};function m(t,r){for(c=t,s=r,n=0;!d&&l&&!o&&n<u.length;n++){var o,i=u[n],m=f.p,p=i[2];t>3?(o=p===r)&&(s=i[(c=i[4])?5:(c=3,3)],i[4]=i[5]=e):i[0]<=m&&((o=t<2&&m<i[1])?(c=0,f.v=r,f.n=i[1]):m<p&&(o=t<3||i[0]>r||r>p)&&(i[4]=t,i[5]=r,f.n=p,c=0))}if(o||t>1)return a;throw d=!0,r}return function(o,u,p){if(l>1)throw TypeError("Generator is already running");for(d&&1===u&&m(u,p),c=u,s=p;(n=c<2?e:s)||!d;){i||(c?c<3?(c>1&&(f.n=-1),m(c,s)):f.n=s:f.v=s);try{if(l=2,i){if(c||(o="next"),n=i[o]){if(!(n=n.call(i,s)))throw TypeError("iterator result is not an object");if(!n.done)return n;s=n.value,c<2&&(c=0)}else 1===c&&(n=i.return)&&n.call(i),c<2&&(s=TypeError("The iterator does not provide a '"+o+"' method"),c=1);i=e}else if((n=(d=f.n<0)?s:t.call(r,f))!==a)break}catch(n){i=e,c=1,s=n}finally{l=1}}return{value:n,done:d}}}(t,o,i),!0),l}var a={};function c(){}function s(){}function l(){}n=Object.getPrototypeOf;var u=[][r]?n(n([][r]())):(ie(n={},r,function(){return this}),n),d=l.prototype=c.prototype=Object.create(u);function f(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,l):(e.__proto__=l,ie(e,o,"GeneratorFunction")),e.prototype=Object.create(d),e}return s.prototype=l,ie(d,"constructor",l),ie(l,"constructor",s),s.displayName="GeneratorFunction",ie(l,o,"GeneratorFunction"),ie(d),ie(d,o,"Generator"),ie(d,r,function(){return this}),ie(d,"toString",function(){return"[object Generator]"}),(oe=function(){return{w:i,m:f}})()}function ie(e,n,t,r){var o=Object.defineProperty;try{o({},"",{})}catch(e){o=0}ie=function(e,n,t,r){function i(n,t){ie(e,n,function(e){return this._invoke(n,t,e)})}n?o?o(e,n,{value:t,enumerable:!r,configurable:!r,writable:!r}):e[n]=t:(i("next",0),i("throw",1),i("return",2))},ie(e,n,t,r)}function ae(e,n,t,r,o,i,a){try{var c=e[i](a),s=c.value}catch(e){return void t(e)}c.done?n(s):Promise.resolve(s).then(r,o)}function ce(e){return function(){var n=this,t=arguments;return new Promise(function(r,o){var i=e.apply(n,t);function a(e){ae(i,r,o,a,c,"next",e)}function c(e){ae(i,r,o,a,c,"throw",e)}a(void 0)})}}function se(e,n){for(var t=0;t<n.length;t++){var r=n[t];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,le(r.key),r)}}function le(e){var n=function(e){if("object"!=re(e)||!e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var t=n.call(e,"string");if("object"!=re(t))return t;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"==re(n)?n:n+""}var ue,de,fe,me="undefined"!=typeof window&&window.require;!function(){if(me)try{ue=window.require("fs"),de=window.require("path");var e=window.require("electron");fe=e.ipcRenderer}catch(e){console.warn("Node integration not available in Electron renderer")}}();const pe=function(){return e=function e(n){!function(e,n){if(!(e instanceof n))throw new TypeError("Cannot call a class as a function")}(this,e),this.configManager=n},n=[{key:"exportPatch",value:(r=ce(oe().m(function e(){var n,t,r,o,i,a,c;return oe().w(function(e){for(;;)switch(e.n){case 0:if(null!==(n=window.uiManager)&&void 0!==n&&n.currentConfig){e.n=1;break}throw new Error("No synthesizer configuration loaded.");case 1:if(t={version:"1.0",synthesizer:{name:window.uiManager.currentConfig.name,manufacturer:window.uiManager.currentConfig.manufacturer},parameters:window.uiManager.getAllControlValues()},r=window.uiManager.currentConfig.name||"patch",t.parameters.patch_name&&"string"==typeof t.parameters.patch_name&&(r=t.parameters.patch_name.trim()),r=r.replace(/[^a-z0-9\s]/gi,"_").toLowerCase(),!window.AppConfig.isWeb){e.n=2;break}return o=new Blob([JSON.stringify(t,null,2)],{type:"application/json"}),i=URL.createObjectURL(o),(a=document.createElement("a")).href=i,a.download="".concat(r,".patch.json"),document.body.appendChild(a),a.click(),document.body.removeChild(a),URL.revokeObjectURL(i),e.a(2,{success:!0,patchName:r});case 2:return e.n=3,fe.invoke("show-save-dialog",{title:"Export Patch",defaultPath:this.configManager.userConfig.lastPatchFolder?de.join(this.configManager.userConfig.lastPatchFolder,"".concat(r,".patch.json")):"".concat(r,".patch.json"),filters:[{name:"Patch Files",extensions:["patch.json","json"]}]});case 3:if(!(c=e.v)){e.n=4;break}return ue.writeFileSync(c,JSON.stringify(t,null,2)),this.configManager.userConfig.lastPatchFolder=de.dirname(c),this.configManager.saveUserConfig(),e.a(2,{success:!0,patchName:r});case 4:return e.a(2,{success:!1});case 5:return e.a(2)}},e,this)})),function(){return r.apply(this,arguments)})},{key:"importPatch",value:(t=ce(oe().m(function e(){var n,t,r,o,i,a;return oe().w(function(e){for(;;)switch(e.n){case 0:if(null!==(n=window.uiManager)&&void 0!==n&&n.currentConfig){e.n=1;break}throw new Error("No synthesizer configuration loaded.");case 1:if(!window.AppConfig.isWeb){e.n=2;break}return e.a(2,new Promise(function(e,n){var t=document.createElement("input");t.type="file",t.accept=".json,.patch.json",t.onchange=function(t){var r=t.target.files[0];if(r){var o=new FileReader;o.onload=function(t){try{var o=JSON.parse(t.target.result);if(!o.version||!o.parameters)return void n(new Error("Invalid patch file."));window.uiManager.loadControlValues(o.parameters),e({success:!0,patchName:r.name})}catch(e){n(new Error("Error reading patch file: "+e.message))}},o.readAsText(r)}else e({success:!1})},t.click()}));case 2:return e.n=3,fe.invoke("show-open-dialog",{title:"Import Patch",defaultPath:this.configManager.userConfig.lastPatchFolder,filters:[{name:"Patch Files",extensions:["patch.json","json"]}],properties:["openFile"]});case 3:if(t=e.v){e.n=4;break}return e.a(2,{success:!1});case 4:if((r=JSON.parse(ue.readFileSync(t,"utf8"))).version&&r.parameters){e.n=5;break}throw new Error("Invalid patch file.");case 5:return o=window.uiManager.currentConfig,i=r.synthesizer&&(r.synthesizer.name!==o.name||r.synthesizer.manufacturer!==o.manufacturer),window.uiManager.loadControlValues(r.parameters),this.configManager.userConfig.lastPatchFolder=de.dirname(t),this.configManager.saveUserConfig(),a=r.parameters.patch_name&&"string"==typeof r.parameters.patch_name?r.parameters.patch_name.trim():"Imported patch",e.a(2,{success:!0,patchName:a,synthMismatch:i});case 6:return e.a(2)}},e,this)})),function(){return t.apply(this,arguments)})},{key:"validatePatch",value:function(e){if(!e||"object"!==re(e))throw new Error("Invalid patch format");if(!e.version)throw new Error("Patch missing version information");if(!e.parameters||"object"!==re(e.parameters))throw new Error("Patch missing parameters");return!0}}],n&&se(e.prototype,n),Object.defineProperty(e,"prototype",{writable:!1}),e;var e,n,t,r}();function ve(e){return ve="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},ve(e)}function he(e,n){for(var t=0;t<n.length;t++){var r=n[t];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,ye(r.key),r)}}function ye(e){var n=function(e){if("object"!=ve(e)||!e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var t=n.call(e,"string");if("object"!=ve(t))return t;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"==ve(n)?n:n+""}const ge=function(){return e=function e(){!function(e,n){if(!(e instanceof n))throw new TypeError("Cannot call a class as a function")}(this,e)},n=[{key:"showConfirm",value:function(e,n){var t=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"Yes",r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:"No",o=document.createElement("div");o.className="dialog-overlay";var i=document.createElement("div");i.className="dialog-content",i.innerHTML='\n            <div style="margin-bottom: 20px; text-align: center;">'.concat(e,'</div>\n            <div style="display: flex; gap: 10px; justify-content: center;">\n                <button id="no-btn" class="btn-secondary">').concat(r,'</button>\n                <button id="yes-btn" class="btn-primary">').concat(t,"</button>\n            </div>\n        "),document.body.appendChild(o),o.appendChild(i);var a=function(e){document.body.removeChild(o),n(e)};i.querySelector("#no-btn").addEventListener("click",function(){return a(!1)}),i.querySelector("#yes-btn").addEventListener("click",function(){return a(!0)}),i.querySelector("#yes-btn").focus()}},{key:"showConfirmPromise",value:function(e){var n=this,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"Yes",r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"No";return new Promise(function(o){return n.showConfirm(e,o,t,r)})}},{key:"showTextInput",value:function(e){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"",t=arguments.length>2?arguments[2]:void 0,r=document.createElement("div");r.className="dialog-overlay";var o=document.createElement("div");o.className="dialog-content",o.innerHTML='\n            <h3 style="margin: 0 0 15px 0;">'.concat(e,'</h3>\n            <input id="text-input" type="text" value="').concat(n,'" class="control-input" style="width: 100%; margin-bottom: 15px;">\n            <div style="text-align: right; gap: 10px; display: flex; justify-content: flex-end;">\n                <button id="cancel-btn" class="btn-secondary">Cancel</button>\n                <button id="ok-btn" class="btn-primary">OK</button>\n            </div>\n        '),document.body.appendChild(r),r.appendChild(o);var i=o.querySelector("#text-input");setTimeout(function(){i.focus(),i.select()},10);var a=function(e){document.body.removeChild(r),t(e)};o.querySelector("#cancel-btn").addEventListener("click",function(){return a(null)}),o.querySelector("#ok-btn").addEventListener("click",function(){var e=i.value.trim();a(e||null)}),i.addEventListener("keydown",function(e){"Enter"===e.key&&o.querySelector("#ok-btn").click(),"Escape"===e.key&&o.querySelector("#cancel-btn").click()})}},{key:"showTextInputPromise",value:function(e){var n=this,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"";return new Promise(function(r){return n.showTextInput(e,t,r)})}},{key:"showAlert",value:function(e){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"Alert",t=document.createElement("div");t.className="dialog-overlay";var r=document.createElement("div");r.className="dialog-content",r.innerHTML='\n            <h3 style="margin: 0 0 15px 0;">'.concat(n,'</h3>\n            <div style="margin-bottom: 20px;">').concat(e,'</div>\n            <div style="text-align: right;">\n                <button id="ok-btn" class="btn-primary">OK</button>\n            </div>\n        '),document.body.appendChild(t),t.appendChild(r);var o=function(){document.body.removeChild(t)};r.querySelector("#ok-btn").addEventListener("click",o),r.querySelector("#ok-btn").focus();var i=function(e){"Escape"===e.key&&(o(),document.removeEventListener("keydown",i))};document.addEventListener("keydown",i)}}],n&&he(e.prototype,n),Object.defineProperty(e,"prototype",{writable:!1}),e;var e,n}();function be(e){return be="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},be(e)}function we(e,n){for(var t=0;t<n.length;t++){var r=n[t];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,xe(r.key),r)}}function xe(e){var n=function(e){if("object"!=be(e)||!e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var t=n.call(e,"string");if("object"!=be(t))return t;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"==be(n)?n:n+""}const Ce=function(){return e=function e(){!function(e,n){if(!(e instanceof n))throw new TypeError("Cannot call a class as a function")}(this,e)},n=[{key:"getContainer",value:function(){return this.container||(this.container=document.getElementById("notification-container")),this.container}},{key:"show",value:function(e){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"info",t=arguments.length>2&&void 0!==arguments[2]?arguments[2]:3e3,r=this.getContainer();if(r){var o=document.createElement("div");o.className="notification ".concat(n),o.textContent=e,o.style.cursor="pointer";var i=function(){r.contains(o)&&(o.classList.remove("show"),setTimeout(function(){r.contains(o)&&r.removeChild(o)},300))};o.addEventListener("click",i),r.appendChild(o),setTimeout(function(){return o.classList.add("show")},10),setTimeout(i,t)}else console.warn("Notification container not found")}},{key:"success",value:function(e){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:3e3;this.show(e,"success",n)}},{key:"error",value:function(e){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:5e3;this.show(e,"error",n)}},{key:"warning",value:function(e){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:4e3;this.show(e,"warning",n)}},{key:"info",value:function(e){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:3e3;this.show(e,"info",n)}},{key:"clear",value:function(){var e=this.getContainer();e&&(e.innerHTML="")}}],n&&we(e.prototype,n),Object.defineProperty(e,"prototype",{writable:!1}),e;var e,n}();function Ee(e){return Ee="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Ee(e)}function ke(){var e,n,t="function"==typeof Symbol?Symbol:{},r=t.iterator||"@@iterator",o=t.toStringTag||"@@toStringTag";function i(t,r,o,i){var s=r&&r.prototype instanceof c?r:c,l=Object.create(s.prototype);return Me(l,"_invoke",function(t,r,o){var i,c,s,l=0,u=o||[],d=!1,f={p:0,n:0,v:e,a:m,f:m.bind(e,4),d:function(n,t){return i=n,c=0,s=e,f.n=t,a}};function m(t,r){for(c=t,s=r,n=0;!d&&l&&!o&&n<u.length;n++){var o,i=u[n],m=f.p,p=i[2];t>3?(o=p===r)&&(s=i[(c=i[4])?5:(c=3,3)],i[4]=i[5]=e):i[0]<=m&&((o=t<2&&m<i[1])?(c=0,f.v=r,f.n=i[1]):m<p&&(o=t<3||i[0]>r||r>p)&&(i[4]=t,i[5]=r,f.n=p,c=0))}if(o||t>1)return a;throw d=!0,r}return function(o,u,p){if(l>1)throw TypeError("Generator is already running");for(d&&1===u&&m(u,p),c=u,s=p;(n=c<2?e:s)||!d;){i||(c?c<3?(c>1&&(f.n=-1),m(c,s)):f.n=s:f.v=s);try{if(l=2,i){if(c||(o="next"),n=i[o]){if(!(n=n.call(i,s)))throw TypeError("iterator result is not an object");if(!n.done)return n;s=n.value,c<2&&(c=0)}else 1===c&&(n=i.return)&&n.call(i),c<2&&(s=TypeError("The iterator does not provide a '"+o+"' method"),c=1);i=e}else if((n=(d=f.n<0)?s:t.call(r,f))!==a)break}catch(n){i=e,c=1,s=n}finally{l=1}}return{value:n,done:d}}}(t,o,i),!0),l}var a={};function c(){}function s(){}function l(){}n=Object.getPrototypeOf;var u=[][r]?n(n([][r]())):(Me(n={},r,function(){return this}),n),d=l.prototype=c.prototype=Object.create(u);function f(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,l):(e.__proto__=l,Me(e,o,"GeneratorFunction")),e.prototype=Object.create(d),e}return s.prototype=l,Me(d,"constructor",l),Me(l,"constructor",s),s.displayName="GeneratorFunction",Me(l,o,"GeneratorFunction"),Me(d),Me(d,o,"Generator"),Me(d,r,function(){return this}),Me(d,"toString",function(){return"[object Generator]"}),(ke=function(){return{w:i,m:f}})()}function Me(e,n,t,r){var o=Object.defineProperty;try{o({},"",{})}catch(e){o=0}Me=function(e,n,t,r){function i(n,t){Me(e,n,function(e){return this._invoke(n,t,e)})}n?o?o(e,n,{value:t,enumerable:!r,configurable:!r,writable:!r}):e[n]=t:(i("next",0),i("throw",1),i("return",2))},Me(e,n,t,r)}function Se(e,n,t,r,o,i,a){try{var c=e[i](a),s=c.value}catch(e){return void t(e)}c.done?n(s):Promise.resolve(s).then(r,o)}function Ie(e){return function(){var n=this,t=arguments;return new Promise(function(r,o){var i=e.apply(n,t);function a(e){Se(i,r,o,a,c,"next",e)}function c(e){Se(i,r,o,a,c,"throw",e)}a(void 0)})}}function Pe(e,n){for(var t=0;t<n.length;t++){var r=n[t];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,De(r.key),r)}}function De(e){var n=function(e){if("object"!=Ee(e)||!e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var t=n.call(e,"string");if("object"!=Ee(t))return t;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"==Ee(n)?n:n+""}var Ae;if("undefined"!=typeof window&&window.require)try{Ae=window.require("fs")}catch(e){console.warn("Node integration not available")}var Te=function(){return e=function e(){!function(e,n){if(!(e instanceof n))throw new TypeError("Cannot call a class as a function")}(this,e),this.isDialogOpen=!1,this.configManager=new te,this.dialogManager=new ge,this.notificationManager=new Ce,this.patchManager=new pe(this.configManager),this.sysExHandler=new U(this),"undefined"!=typeof window&&window.require&&this.initialize()},n=[{key:"initialize",value:(l=Ie(ke().m(function e(){return ke().w(function(e){for(;;)switch(e.n){case 0:return this.configureWebUI(),e.n=1,window.midiManager.initialize();case 1:if(this.setupEventListeners(),this.updateMIDIStatus(),this.attemptAutoConnect(),!window.AppConfig.autoLoadDefaultConfig){e.n=3;break}return e.n=2,this.loadConfigFromPath(window.AppConfig.defaultConfigPath);case 2:e.n=4;break;case 3:if(!(this.configManager.userConfig.lastConfigFile&&Ae&&Ae.existsSync&&Ae.existsSync(this.configManager.userConfig.lastConfigFile))){e.n=4;break}return e.n=4,this.loadConfigFromPath(this.configManager.userConfig.lastConfigFile);case 4:window.addEventListener("beforeunload",function(){window.midiManager.isConnected&&window.midiManager.disconnect()});case 5:return e.a(2)}},e,this)})),function(){return l.apply(this,arguments)})},{key:"setupEventListeners",value:function(){var e=this;document.getElementById("connect-midi").addEventListener("click",function(){return e.handleMIDIButtonClick()}),document.getElementById("load-config-header").addEventListener("click",function(){return e.loadConfigFile()}),document.getElementById("load-config").addEventListener("click",function(){return e.loadConfigFile()}),document.getElementById("reset-all-defaults").addEventListener("click",function(){window.uiManager&&e.dialogManager.showConfirm("Send init patch to synthesizer? This will reset all parameters to default values.",function(e){e&&window.uiManager.sendInitPatch()})}),document.getElementById("get-patch").addEventListener("click",function(){e.getPatchFromSynth()}),document.getElementById("send-all-parameters").addEventListener("click",function(){window.uiManager&&e.dialogManager.showConfirm("Send all parameters to your synthesizer?",function(e){e&&window.uiManager.sendAllParameters()})}),document.getElementById("export-patch").addEventListener("click",function(){return e.exportPatch()}),document.getElementById("import-patch").addEventListener("click",function(){return e.importPatch()}),document.getElementById("toggle-monitor").addEventListener("click",function(){return e.toggleMIDIMonitor()}),document.getElementById("clear-monitor").addEventListener("click",function(){return e.clearMIDIMonitor()}),document.getElementById("expand-monitor").addEventListener("click",function(){return e.showMIDITesterModal()}),document.getElementById("close-midi-tester").addEventListener("click",function(){return e.closeMIDITesterModal()}),document.getElementById("help-mode-toggle").addEventListener("click",function(){return e.toggleHelpMode()}),document.querySelectorAll(".tester-tab").forEach(function(n){n.addEventListener("click",function(){return e.switchTesterTab(n.dataset.tab)})}),document.getElementById("modal-clear-monitor").addEventListener("click",function(){return e.clearModalMIDIMonitor()}),this.setupCCTester(),this.setupCCPairTester(),this.setupNRPNTester(),this.setupSysExTester(),this.setupProgramTester(),this.sysExHandler.setupDumpReceiver(),window.addEventListener("resize",function(){return e.updateMIDIStatus()})}},{key:"configureWebUI",value:function(){var e=[];window.AppConfig.showLoadConfigButton||e.push(document.getElementById("load-config-header"),document.getElementById("load-config"),document.getElementById("dump-mapping-status"),document.getElementById("welcome")),e.forEach(function(e){e&&(e.style.display="none")})}},{key:"showMIDIDeviceDialog",value:(s=Ie(ke().m(function e(){var n,t,r,o,i,a,c,s,l,u=this;return ke().w(function(e){for(;;)switch(e.n){case 0:if(!this.isDialogOpen){e.n=1;break}return e.a(2);case 1:this.isDialogOpen=!0;try{n=[],t=[],window.midiManager.midiAccess&&(n=Array.from(window.midiManager.midiAccess.outputs.values()),t=Array.from(window.midiManager.midiAccess.inputs.values())),(r=document.createElement("div")).className="dialog-overlay",(o=document.createElement("div")).className="dialog-content",o.innerHTML='\n                <h3 style="margin: 0 0 15px 0;">Select MIDI Devices</h3>\n                <h4 style="margin: 10px 0 5px 0;">Output Devices:</h4>\n                <select id="midi-output-select" style="width: 100%; padding: 5px; background: #3a3a3a; color: white; border: 1px solid #4a4a4a;"></select>\n                <div id="input-device-section"></div>\n                <div id="connection-status" style="margin: 10px 0; min-height: 20px;"></div>\n                <div style="text-align: right; margin-top: 15px;">\n                    <button id="cancel-midi" style="margin-right: 10px; background: #666; color: white; border: none; padding: 8px 16px; border-radius: 4px; cursor: pointer;">Cancel</button>\n                    <button id="connect-midi-button" style="background: #4a90e2; color: white; border: none; padding: 8px 16px; border-radius: 4px; cursor: pointer;">Connect</button>\n                </div>\n            ',document.body.appendChild(r),r.appendChild(o),i=o.querySelector("#midi-output-select"),a=o.querySelector("#input-device-section"),c=o.querySelector("#connection-status"),i.innerHTML='<option value="">Select output device...</option>',n.forEach(function(e){var n=document.createElement("option");n.value=e.id,n.textContent=e.name,i.appendChild(n)}),t.length>0&&(a.innerHTML='\n                    <h4 style="margin: 10px 0 5px 0;">Input Device (Optional):</h4>\n                    <select id="midi-input-select" style="width: 100%; padding: 5px; background: #3a3a3a; color: white; border: 1px solid #4a4a4a;">\n                        <option value="">No input device</option>\n                    </select>\n                ',s=o.querySelector("#midi-input-select"),t.forEach(function(e){var n=document.createElement("option");n.value=e.id,n.textContent=e.name,s.appendChild(n)}),this.configManager.userConfig.lastMidiInput&&(s.value=this.configManager.userConfig.lastMidiInput)),this.configManager.userConfig.lastMidiOutput&&(i.value=this.configManager.userConfig.lastMidiOutput),l=function(){document.body.removeChild(r),u.isDialogOpen=!1},o.querySelector("#connect-midi-button").addEventListener("click",Ie(ke().m(function e(){var n,t,r,a,s,d;return ke().w(function(e){for(;;)switch(e.p=e.n){case 0:if(t=i.value,r=(null===(n=o.querySelector("#midi-input-select"))||void 0===n?void 0:n.value)||null,t){e.n=1;break}return c.textContent="Please select an output device.",c.style.color="#e74c3c",e.a(2);case 1:return e.p=1,c.textContent="Connecting...",c.style.color="#4a90e2",e.n=2,window.midiManager.connectOutput(t);case 2:if(!r){e.n=3;break}return e.n=3,window.midiManager.connectInput(r);case 3:u.configManager.userConfig.lastMidiOutput=t,u.configManager.userConfig.lastMidiInput=r,u.configManager.saveUserConfig(),u.updateMIDIStatus(),s=(null===(a=window.midiManager.outputDevice)||void 0===a?void 0:a.name)||"MIDI device",u.notificationManager.success("Connected to ".concat(s)),l(),e.n=5;break;case 4:e.p=4,d=e.v,c.textContent="Connection failed: "+d.message,c.style.color="#e74c3c";case 5:return e.a(2)}},e,null,[[1,4]])}))),o.querySelector("#cancel-midi").addEventListener("click",l)}catch(e){this.notificationManager.error("Error accessing MIDI devices: "+e.message)}case 2:return e.a(2)}},e,this)})),function(){return s.apply(this,arguments)})},{key:"handleMIDIButtonClick",value:function(){window.midiManager.isConnected?(window.midiManager.disconnect(),this.updateMIDIStatus(),this.notificationManager.info("MIDI device disconnected")):this.showMIDIDeviceDialog()}},{key:"updateMIDIStatus",value:function(){var e=document.getElementById("midi-status"),n=document.getElementById("connect-midi");if(window.midiManager.isConnected){var t,r=(null===(t=window.midiManager.outputDevice)||void 0===t?void 0:t.name)||"Unknown Device";e.textContent="MIDI: ".concat(r),n.textContent="Disconnect"}else e.textContent="MIDI: Disconnected",n.textContent="Connect"}},{key:"loadConfigFile",value:(c=Ie(ke().m(function e(){var n,t;return ke().w(function(e){for(;;)switch(e.p=e.n){case 0:return e.p=0,e.n=1,this.configManager.loadConfigFile();case 1:if(!(n=e.v)){e.n=2;break}return e.n=2,this.loadSynthConfig(n.config);case 2:e.n=4;break;case 3:e.p=3,t=e.v,this.notificationManager.error(t.message);case 4:return e.a(2)}},e,this,[[0,3]])})),function(){return c.apply(this,arguments)})},{key:"loadConfigFromPath",value:(a=Ie(ke().m(function e(n){var t,r;return ke().w(function(e){for(;;)switch(e.p=e.n){case 0:return e.p=0,e.n=1,this.configManager.loadConfigFromPath(n);case 1:(t=e.v)&&(window.uiManager.loadConfig(t),window.AppConfig.isWeb?(document.title="ArcSynth Editor - ".concat(t.name),document.querySelector("header h1").textContent="ArcSynth Editor - ".concat(t.name)):document.title="ArcSynth Editor - ".concat(t.name),this.sysExHandler.checkDumpMappingAvailability()),e.n=3;break;case 2:e.p=2,r=e.v,console.error("Error auto-loading config:",r);case 3:return e.a(2)}},e,this,[[0,2]])})),function(e){return a.apply(this,arguments)})},{key:"loadSynthConfig",value:(i=Ie(ke().m(function e(n){return ke().w(function(e){for(;;)switch(e.n){case 0:if(!(this.sysExHandler.baselineSysEx||Object.keys(this.sysExHandler.mappingResults).length>0)){e.n=2;break}return e.n=1,this.dialogManager.showConfirmPromise("Loading a new config will reset the SysEx mapping session. Continue?");case 1:if(e.v){e.n=2;break}return e.a(2);case 2:window.uiManager.loadConfig(n),window.AppConfig.isWeb?(document.title="ArcSynth Editor - ".concat(n.name),document.querySelector("header h1").textContent="ArcSynth Editor - ".concat(n.name)):document.title="ArcSynth Editor - ".concat(n.name),this.sysExHandler.checkDumpMappingAvailability();case 3:return e.a(2)}},e,this)})),function(e){return i.apply(this,arguments)})},{key:"toggleMIDIMonitor",value:function(){var e=document.getElementById("midi-monitor-content"),n=document.getElementById("toggle-monitor");e.classList.toggle("hidden"),n.textContent=e.classList.contains("hidden")?"Show":"Hide",e.classList.contains("hidden")||(e.scrollTop=e.scrollHeight)}},{key:"clearMIDIMonitor",value:function(){var e=document.getElementById("midi-log");e&&(e.innerHTML="")}},{key:"attemptAutoConnect",value:function(){var e=this.configManager.userConfig,n=e.lastMidiOutput,t=e.lastMidiInput;n&&window.midiManager.midiAccess&&Array.from(window.midiManager.midiAccess.outputs.values()).find(function(e){return e.id===n})&&(window.midiManager.connectOutput(n),this.updateMIDIStatus(),this.configManager.saveUserConfig()),t&&window.midiManager.midiAccess&&Array.from(window.midiManager.midiAccess.inputs.values()).find(function(e){return e.id===t})&&window.midiManager.connectInput(t)}},{key:"exportPatch",value:(o=Ie(ke().m(function e(){var n,t;return ke().w(function(e){for(;;)switch(e.p=e.n){case 0:return e.p=0,e.n=1,this.patchManager.exportPatch();case 1:(n=e.v).success&&this.notificationManager.success('Patch "'.concat(n.patchName,'" exported!')),e.n=3;break;case 2:e.p=2,t=e.v,this.notificationManager.error(t.message);case 3:return e.a(2)}},e,this,[[0,2]])})),function(){return o.apply(this,arguments)})},{key:"importPatch",value:(r=Ie(ke().m(function e(){var n,t;return ke().w(function(e){for(;;)switch(e.p=e.n){case 0:return e.p=0,e.n=1,this.patchManager.importPatch();case 1:if(!(n=e.v).success){e.n=4;break}if(!n.synthMismatch){e.n=3;break}return e.n=2,this.dialogManager.showConfirmPromise("Patch is for a different synth. Continue anyway?");case 2:if(e.v){e.n=3;break}return e.a(2);case 3:this.notificationManager.success('Patch "'.concat(n.patchName,'" loaded!')),n.shouldSendToSynth&&this.dialogManager.showConfirm("Send all parameters to synth?",function(e){e&&window.uiManager.sendAllParameters()});case 4:e.n=6;break;case 5:e.p=5,t=e.v,this.notificationManager.error(t.message);case 6:return e.a(2)}},e,this,[[0,5]])})),function(){return r.apply(this,arguments)})},{key:"showMIDITesterModal",value:function(){document.getElementById("midi-tester-modal").classList.remove("hidden"),this.syncMIDILogToModal()}},{key:"closeMIDITesterModal",value:function(){document.getElementById("midi-tester-modal").classList.add("hidden")}},{key:"switchTesterTab",value:function(e){document.querySelectorAll(".tester-tab").forEach(function(n){return n.classList.toggle("active",n.dataset.tab===e)}),document.querySelectorAll(".tester-content").forEach(function(n){return n.classList.toggle("active",n.id==="".concat(e,"-tester"))})}},{key:"setupCCTester",value:function(){var e=this,n=document.getElementById("cc-value"),t=document.getElementById("cc-value-slider");n.addEventListener("input",function(){return t.value=n.value}),t.addEventListener("input",function(){return n.value=t.value}),document.getElementById("send-cc").addEventListener("click",function(){if(!window.midiManager.isConnected)return e.notificationManager.warning("Not connected.");var t=parseInt(document.getElementById("cc-channel").value),r=window.midiManager.currentChannel;window.midiManager.currentChannel=t,window.midiManager.sendCC(parseInt(document.getElementById("cc-number").value),parseInt(n.value)),window.midiManager.currentChannel=r})}},{key:"setupCCPairTester",value:function(){var e=this,n=document.getElementById("cc-pair-value"),t=document.getElementById("cc-pair-value-slider");n.addEventListener("input",function(){return t.value=n.value}),t.addEventListener("input",function(){return n.value=t.value}),document.getElementById("send-cc-pair").addEventListener("click",function(){if(!window.midiManager.isConnected)return e.notificationManager.warning("Not connected.");var t=parseInt(document.getElementById("cc-pair-channel").value),r=window.midiManager.currentChannel;window.midiManager.currentChannel=t,window.midiManager.sendCCPair(parseInt(document.getElementById("cc-pair-msb").value),parseInt(document.getElementById("cc-pair-lsb").value),parseInt(n.value)),window.midiManager.currentChannel=r})}},{key:"setupNRPNTester",value:function(){var e=this,n=document.getElementById("nrpn-value-msb"),t=document.getElementById("nrpn-value-msb-slider"),r=document.getElementById("nrpn-value-lsb"),o=document.getElementById("nrpn-value-lsb-slider");n.addEventListener("input",function(){return t.value=n.value}),t.addEventListener("input",function(){return n.value=t.value}),r.addEventListener("input",function(){return o.value=r.value}),o.addEventListener("input",function(){return r.value=o.value}),document.getElementById("send-nrpn").addEventListener("click",function(){if(!window.midiManager.isConnected)return e.notificationManager.warning("Not connected.");var t=parseInt(document.getElementById("nrpn-channel").value),o=window.midiManager.currentChannel;window.midiManager.currentChannel=t,window.midiManager.sendNRPN(parseInt(document.getElementById("nrpn-msb").value),parseInt(document.getElementById("nrpn-lsb").value),parseInt(n.value),parseInt(r.value),document.getElementById("nrpn-exclude-lsb").checked),window.midiManager.currentChannel=o})}},{key:"setupSysExTester",value:function(){var e=this;document.getElementById("send-sysex").addEventListener("click",function(){if(!window.midiManager.isConnected)return e.notificationManager.warning("Not connected.");var n=document.getElementById("sysex-data").value.trim();if(!n)return e.notificationManager.warning("SysEx data required.");var t=n.split(/\s+/).map(function(e){return e.toUpperCase()});if("F0"!==t[0]&&t.unshift("F0"),"F7"!==t[t.length-1]&&t.push("F7"),t.some(function(e){return!/^[0-9A-F]{1,2}$/.test(e)}))return e.notificationManager.error("Invalid hex byte found.");window.midiManager.sendSysEx(t.join(" "))})}},{key:"setupProgramTester",value:function(){var e=this,n=document.getElementById("program-number"),t=document.getElementById("program-number-slider");n.addEventListener("input",function(){return t.value=n.value}),t.addEventListener("input",function(){return n.value=t.value});var r=function(t){if(!window.midiManager.isConnected)return e.notificationManager.warning("Not connected.");var r=parseInt(document.getElementById("program-channel").value),o=window.midiManager.currentChannel;window.midiManager.currentChannel=r;var i=parseInt(n.value),a=parseInt(document.getElementById("bank-msb").value),c=parseInt(document.getElementById("bank-lsb").value);"all"!==t&&"bank"!==t||(document.getElementById("send-bank-msb").checked&&window.midiManager.sendCC(0,a),document.getElementById("send-bank-lsb").checked&&window.midiManager.sendCC(32,c)),"all"!==t&&"program"!==t||window.midiManager.sendProgramChange(i),window.midiManager.currentChannel=o};document.getElementById("send-program-only").addEventListener("click",function(){return r("program")}),document.getElementById("send-bank-only").addEventListener("click",function(){return r("bank")}),document.getElementById("send-program-change").addEventListener("click",function(){return r("all")})}},{key:"syncMIDILogToModal",value:function(){var e=document.getElementById("midi-log"),n=document.getElementById("modal-midi-log");e&&n&&(n.innerHTML=e.innerHTML,n.scrollTop=n.scrollHeight)}},{key:"clearModalMIDIMonitor",value:function(){var e=document.getElementById("modal-midi-log");e&&(e.innerHTML="")}},{key:"getPatchFromSynth",value:(t=Ie(ke().m(function e(){var n;return ke().w(function(e){for(;;)switch(e.p=e.n){case 0:return e.p=0,e.n=1,this.sysExHandler.getDumpFromSynth();case 1:e.n=3;break;case 2:e.p=2,n=e.v,this.notificationManager.error("Error getting patch from synth: "+n.message);case 3:return e.a(2)}},e,this,[[0,2]])})),function(){return t.apply(this,arguments)})},{key:"toggleHelpMode",value:function(){window.uiManager&&window.uiManager.toggleHelpMode()}}],n&&Pe(e.prototype,n),Object.defineProperty(e,"prototype",{writable:!1}),e;var e,n,t,r,o,i,a,c,s,l}();function Ne(){var e,n,t="function"==typeof Symbol?Symbol:{},r=t.iterator||"@@iterator",o=t.toStringTag||"@@toStringTag";function i(t,r,o,i){var s=r&&r.prototype instanceof c?r:c,l=Object.create(s.prototype);return Ve(l,"_invoke",function(t,r,o){var i,c,s,l=0,u=o||[],d=!1,f={p:0,n:0,v:e,a:m,f:m.bind(e,4),d:function(n,t){return i=n,c=0,s=e,f.n=t,a}};function m(t,r){for(c=t,s=r,n=0;!d&&l&&!o&&n<u.length;n++){var o,i=u[n],m=f.p,p=i[2];t>3?(o=p===r)&&(s=i[(c=i[4])?5:(c=3,3)],i[4]=i[5]=e):i[0]<=m&&((o=t<2&&m<i[1])?(c=0,f.v=r,f.n=i[1]):m<p&&(o=t<3||i[0]>r||r>p)&&(i[4]=t,i[5]=r,f.n=p,c=0))}if(o||t>1)return a;throw d=!0,r}return function(o,u,p){if(l>1)throw TypeError("Generator is already running");for(d&&1===u&&m(u,p),c=u,s=p;(n=c<2?e:s)||!d;){i||(c?c<3?(c>1&&(f.n=-1),m(c,s)):f.n=s:f.v=s);try{if(l=2,i){if(c||(o="next"),n=i[o]){if(!(n=n.call(i,s)))throw TypeError("iterator result is not an object");if(!n.done)return n;s=n.value,c<2&&(c=0)}else 1===c&&(n=i.return)&&n.call(i),c<2&&(s=TypeError("The iterator does not provide a '"+o+"' method"),c=1);i=e}else if((n=(d=f.n<0)?s:t.call(r,f))!==a)break}catch(n){i=e,c=1,s=n}finally{l=1}}return{value:n,done:d}}}(t,o,i),!0),l}var a={};function c(){}function s(){}function l(){}n=Object.getPrototypeOf;var u=[][r]?n(n([][r]())):(Ve(n={},r,function(){return this}),n),d=l.prototype=c.prototype=Object.create(u);function f(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,l):(e.__proto__=l,Ve(e,o,"GeneratorFunction")),e.prototype=Object.create(d),e}return s.prototype=l,Ve(d,"constructor",l),Ve(l,"constructor",s),s.displayName="GeneratorFunction",Ve(l,o,"GeneratorFunction"),Ve(d),Ve(d,o,"Generator"),Ve(d,r,function(){return this}),Ve(d,"toString",function(){return"[object Generator]"}),(Ne=function(){return{w:i,m:f}})()}function Ve(e,n,t,r){var o=Object.defineProperty;try{o({},"",{})}catch(e){o=0}Ve=function(e,n,t,r){function i(n,t){Ve(e,n,function(e){return this._invoke(n,t,e)})}n?o?o(e,n,{value:t,enumerable:!r,configurable:!r,writable:!r}):e[n]=t:(i("next",0),i("throw",1),i("return",2))},Ve(e,n,t,r)}function Le(e,n,t,r,o,i,a){try{var c=e[i](a),s=c.value}catch(e){return void t(e)}c.done?n(s):Promise.resolve(s).then(r,o)}function je(e){return function(){var n=this,t=arguments;return new Promise(function(r,o){var i=e.apply(n,t);function a(e){Le(i,r,o,a,c,"next",e)}function c(e){Le(i,r,o,a,c,"throw",e)}a(void 0)})}}"undefined"!=typeof window&&window.require&&(window.synthEditor=new Te),window.AppConfig=h,window.logger=N,window.logError=function(e){return N.error(e)},window.logWarn=function(e){return N.warn(e)},window.logInfo=function(e){return N.info(e)},window.logDebug=function(e){return N.debug(e)};var Oe=function(){var e=new URLSearchParams(window.location.search).get("config");if(!e){var n=new URL(window.location);return n.searchParams.set("config","novation-summit"),window.history.replaceState({},"",n),"configs/novation-summit.json"}var t={"novation-summit":"configs/novation-summit.json","example-synth":"configs/example-synth.json"};if(t[e])return t[e];var r=new URL(window.location);return r.searchParams.set("config","novation-summit"),window.history.replaceState({},"",r),"configs/novation-summit.json"}();window.AppConfig.defaultConfigPath=Oe;var Be=new URLSearchParams(window.location.search).get("config");if(Be){var _e={"novation-summit":"Novation Summit","example-synth":"Example Synth"}[Be]||Be;document.title="ArcSynth Editor - ".concat(_e)}"loading"===document.readyState?document.addEventListener("DOMContentLoaded",je(Ne().m(function e(){return Ne().w(function(e){for(;;)switch(e.n){case 0:return window.synthEditor=new Te,e.n=1,window.synthEditor.initialize();case 1:return e.a(2)}},e)}))):(window.synthEditor=new Te,window.synthEditor.initialize()),console.log("ArcSynth Editor (Web) initialized")})()})();