/*! For license information please see bundle.js.LICENSE.txt */
(()=>{var e,t,n,r,i={501:()=>{function e(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var n=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=n){var r,i,o,a,c=[],s=!0,l=!1;try{if(o=(n=n.call(e)).next,0===t){if(Object(n)!==n)return;s=!1}else for(;!(s=(r=o.call(n)).done)&&(c.push(r.value),c.length!==t);s=!0);}catch(e){l=!0,i=e}finally{try{if(!s&&null!=n.return&&(a=n.return(),Object(a)!==a))return}finally{if(l)throw i}}return c}}(e,t)||i(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function t(e,t){var n="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!n){if(Array.isArray(e)||(n=i(e))||t&&e&&"number"==typeof e.length){n&&(e=n);var r=0,o=function(){};return{s:o,n:function(){return r>=e.length?{done:!0}:{done:!1,value:e[r++]}},e:function(e){throw e},f:o}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var a,c=!0,s=!1;return{s:function(){n=n.call(e)},n:function(){var e=n.next();return c=e.done,e},e:function(e){s=!0,a=e},f:function(){try{c||null==n.return||n.return()}finally{if(s)throw a}}}}function n(e){return n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},n(e)}function r(e){return function(e){if(Array.isArray(e))return o(e)}(e)||function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(e)||i(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function i(e,t){if(e){if("string"==typeof e)return o(e,t);var n={}.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?o(e,t):void 0}}function o(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=Array(t);n<t;n++)r[n]=e[n];return r}function a(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,c(r.key),r)}}function c(e){var t=function(e){if("object"!=n(e)||!e)return e;var t=e[Symbol.toPrimitive];if(void 0!==t){var r=t.call(e,"string");if("object"!=n(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"==n(t)?t:t+""}var s=function(){return i=function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.currentConfig=null,this.currentTab=null,this.controlValues=new Map,this.subsectionStates=new Map,this.helpMode=!1,this.currentTooltip=null,this.boundHandleControlMouseEnter=this.handleControlMouseEnter.bind(this),this.boundHandleControlMouseLeave=this.handleControlMouseLeave.bind(this)},o=[{key:"loadConfig",value:function(e){this.currentConfig=e,this.controlValues.clear(),this.savedPatchName=void 0,this.createTabs(),e.tabs&&e.tabs.length>0&&this.showTab(e.tabs[0].id),e.midiChannel&&window.midiManager.setChannel(e.midiChannel);var t=document.getElementById("get-patch");t&&(t.style.display="block");var n=document.getElementById("reset-all-defaults");n&&(n.style.display="block");var r=document.getElementById("send-all-parameters");r&&(r.style.display="block")}},{key:"initializeAllControlValues",value:function(){var e=this;this.currentConfig&&this.currentConfig.tabs&&this.currentConfig.tabs.forEach(function(t){t.sections&&t.sections.forEach(function(t){t.controls&&Array.isArray(t.controls)&&t.controls.forEach(function(t){if(t.id&&!e.controlValues.has(t.id)){var n=e.calculateDefaultValue(t);e.controlValues.set(t.id,n)}}),t.template&&e.expandTemplate(t.template).forEach(function(t){if(t.id&&!e.controlValues.has(t.id)){var n=e.calculateDefaultValue(t);e.controlValues.set(t.id,n)}}),t.subsections&&Array.isArray(t.subsections)&&t.subsections.forEach(function(t){t.controls&&Array.isArray(t.controls)&&t.controls.forEach(function(t){if(t.id&&!e.controlValues.has(t.id)){var n=e.calculateDefaultValue(t);e.controlValues.set(t.id,n)}})})})})}},{key:"createTabs",value:function(){var e=this,t=document.getElementById("tab-container");t.innerHTML="",this.currentConfig&&this.currentConfig.tabs&&this.currentConfig.tabs.forEach(function(n){var r=document.createElement("button");r.className="tab",r.textContent=n.name,r.dataset.tabId=n.id,r.onclick=function(){return e.showTab(n.id)},t.appendChild(r)})}},{key:"showTab",value:function(e){var t=this.currentConfig.tabs.find(function(t){return t.id===e});if(t){document.getElementById("editor-area").scrollTop=0,this.currentTab=t,document.querySelectorAll(".tab").forEach(function(e){return e.classList.remove("active")});var n=document.querySelector('button[data-tab-id="'.concat(e,'"]'));n&&n.classList.add("active"),this.renderTabContent(t)}}},{key:"renderTabContent",value:function(e){var t=this,n=document.getElementById("content-container");if(n.innerHTML="",e.sections){e.sections.forEach(function(e){var r=t.createSection(e);n.appendChild(r)}),this.helpMode&&this.addHelpEventListeners();var r=this.controlValues.get("patch_name");void 0!==r&&this.updatePatchNameUnsavedIndicator(r)}}},{key:"createSection",value:function(e){var t=this,n=document.createElement("div");n.className="section";var r=document.createElement("h3");if(r.textContent=e.name,n.appendChild(r),e.controls){var i=document.createElement("div");i.className=e.template||"table"===e.layout?"mod-matrix-grid":"controls-grid",e.controls.forEach(function(e){var n=t.createControl(e);i.appendChild(n)}),n.appendChild(i)}if(e.template){var o=document.createElement("div");o.className="mod-matrix-grid",this.expandTemplate(e.template).forEach(function(e){var n=t.createControl(e);o.appendChild(n)}),n.appendChild(o)}return e.subsections&&e.subsections.forEach(function(r){var i=t.createSubsection(r,e.id);n.appendChild(i)}),n}},{key:"createSubsection",value:function(e,t){var n,r=this,i=document.createElement("div");i.className="subsection";var o=e.id||"".concat(t,"_").concat(e.name.replace(/\s+/g,"_").toLowerCase()),a="".concat(this.currentTab.id,"_").concat(o),c=document.createElement("div");c.className="subsection-header";var s=document.createElement("span");s.className="subsection-toggle",s.textContent="▶";var l=document.createElement("h4");l.textContent=e.name,c.appendChild(s),c.appendChild(l),i.appendChild(c);var u=document.createElement("div");if(u.className="subsection-content collapsed",null!==(n=this.subsectionStates.get(a))&&void 0!==n&&n&&(u.classList.remove("collapsed"),u.classList.add("expanded"),s.classList.add("expanded")),e.controls){var d=document.createElement("div");d.className="controls-grid",e.controls.forEach(function(e){var t=r.createControl(e);d.appendChild(t)}),u.appendChild(d)}return i.appendChild(u),c.addEventListener("click",function(){u.classList.contains("expanded")?(u.classList.remove("expanded"),u.classList.add("collapsed"),s.classList.remove("expanded"),r.subsectionStates.set(a,!1)):(u.classList.remove("collapsed"),u.classList.add("expanded"),s.classList.add("expanded"),r.subsectionStates.set(a,!0))}),i}},{key:"getControlClass",value:function(e){return e.readonly&&"text"===e.type?"Slot"===e.value||"Source 1"===e.value||"Source 2"===e.value||"Destination"===e.value||"FX Destination"===e.value||"Depth"===e.value?"mod-matrix-header":"mod-matrix-slot-label":"control"}},{key:"createControl",value:function(e){var t=document.createElement("div");t.className=this.getControlClass(e);var n,r=this.getControlClass(e);if(!r.includes("header")&&!r.includes("slot-label")){var i=document.createElement("div");i.className="control-label",i.textContent=e.name,t.appendChild(i)}switch(e.type){case"knob":n=this.createKnob(e);break;case"slider":default:n=this.createSlider(e);break;case"select":n=this.createSelect(e);break;case"button":n=this.createButton(e);break;case"text":n=this.createTextInput(e);break;case"adsr_display":n=this.createADSRDisplay(e)}if(t.appendChild(n),e.unit){var o=document.createElement("div");o.className="control-unit",o.textContent=e.unit,t.appendChild(o)}return t}},{key:"createKnob",value:function(e){var t,n=this,r=document.createElement("div");r.className="flex-column-center-gap";var i=document.createElement("div");i.className="knob",i._controlConfig=e,e.midi&&"cc"===e.midi.type&&void 0!==e.midi.number?i.setAttribute("data-cc",e.midi.number):e.midi&&"cc_pair"===e.midi.type&&void 0!==e.midi.msb&&void 0!==e.midi.lsb?i.setAttribute("data-cc-pair","".concat(e.midi.msb,",").concat(e.midi.lsb)):e.midi&&"nrpn"===e.midi.type&&void 0!==e.midi.msb&&void 0!==e.midi.lsb&&i.setAttribute("data-nrpn","".concat(e.midi.msb,":").concat(e.midi.lsb));var o=null!==(t=this.controlValues.get(e.id))&&void 0!==t?t:this.calculateDefaultValue(e),a=(o-(e.min||0))/((e.max||127)-(e.min||0))*100/100*270-135;i.style.transform="rotate(".concat(a,"deg)"),this.controlValues.set(e.id,o);var c=document.createElement("input");c.type="number",c.className="control-input";var s=this.convertInternalToDisplay(e,o);c.value=s,c.min=e.displayMin||e.min||0,c.max=e.displayMax||e.max||127,c.step=e.displayStep||e.step||1;var l=!1,u=0,d=o;i.addEventListener("mousedown",function(e){l=!0,u=e.clientY,d=parseFloat(c.value),document.addEventListener("mousemove",f),document.addEventListener("mouseup",m),e.preventDefault()});var f=function(t){var r,o;if(l){var a,s=u-t.clientY,f=e.displayMin||e.min||0,m=e.displayMax||e.max||127,v=m-f,p=e.displayStep||e.step||1;a="cc_pair"===(null===(r=e.midi)||void 0===r?void 0:r.type)||p<1?v>200?v/150:Math.min(p,1):v/100;var h=Math.max(f,Math.min(m,d+s*a)),y=(null===(o=p.toString().split(".")[1])||void 0===o?void 0:o.length)||0;h=Math.round(h/p)*p,h=Number(h.toFixed(y));var g=n.convertDisplayToInternal(e,h);g!==n.controlValues.get(e.id)&&n.updateControlValue(e,g,i,c)}},m=function(){l=!1,document.removeEventListener("mousemove",f),document.removeEventListener("mouseup",m)};return c.addEventListener("input",function(t){var r=parseFloat(t.target.value),o=e.displayMin||e.min||0,a=e.displayMax||e.max||127;if(!isNaN(r)&&r>=o&&r<=a){var s,l=e.displayStep||e.step||1,u=(null===(s=l.toString().split(".")[1])||void 0===s?void 0:s.length)||0;r=Math.round(r/l)*l,r=Number(r.toFixed(u));var d=n.convertDisplayToInternal(e,r);n.updateControlValue(e,d,i,c)}}),i.addEventListener("dblclick",function(){var t=n.calculateDefaultValue(e);n.updateControlValue(e,t,i,c)}),r.appendChild(i),r.appendChild(c),r}},{key:"createSlider",value:function(e){var t,n=this,r=document.createElement("div");r.className="flex-column-center-gap",r.style.width="100%";var i=document.createElement("input");i.type="range",i.className="slider",i.min=e.min||0,i.max=e.max||127,i.step=e.step||1,i._controlConfig=e,e.midi&&"cc"===e.midi.type&&void 0!==e.midi.number?i.setAttribute("data-cc",e.midi.number):e.midi&&"cc_pair"===e.midi.type&&void 0!==e.midi.msb&&void 0!==e.midi.lsb?i.setAttribute("data-cc-pair","".concat(e.midi.msb,",").concat(e.midi.lsb)):e.midi&&"nrpn"===e.midi.type&&void 0!==e.midi.msb&&void 0!==e.midi.lsb&&i.setAttribute("data-nrpn","".concat(e.midi.msb,":").concat(e.midi.lsb));var o=null!==(t=this.controlValues.get(e.id))&&void 0!==t?t:this.calculateDefaultValue(e);i.value=o,this.controlValues.set(e.id,o);var a=document.createElement("input");return a.type="number",a.className="control-input",a.value=o,a.min=e.min||0,a.max=e.max||127,a.step=e.step||1,a.style.width="80px",a.classList.add("text-center"),i.addEventListener("input",function(t){var r=parseFloat(t.target.value);a.value=r,n.updateControlValue(e,r)}),a.addEventListener("input",function(t){var r=parseFloat(t.target.value);if(!isNaN(r)&&r>=(e.min||0)&&r<=(e.max||127)){var o,a=e.step||1,c=(null===(o=a.toString().split(".")[1])||void 0===o?void 0:o.length)||0;r=Math.round(r/a)*a,r=Number(r.toFixed(c)),i.value=r,n.updateControlValue(e,r)}}),i.addEventListener("dblclick",function(){var t=n.calculateDefaultValue(e);i.value=t,a.value=t,n.updateControlValue(e,t)}),r.appendChild(i),r.appendChild(a),r}},{key:"createSelectAsKnob",value:function(e){var t,n=this,i=document.createElement("div");i.className="flex-column-center-gap";var o=document.createElement("div");o.className="knob",o._controlConfig=e,e.midi&&"cc"===e.midi.type&&void 0!==e.midi.number?o.setAttribute("data-cc",e.midi.number):e.midi&&"cc_pair"===e.midi.type&&void 0!==e.midi.msb&&void 0!==e.midi.lsb?o.setAttribute("data-cc-pair","".concat(e.midi.msb,",").concat(e.midi.lsb)):e.midi&&"nrpn"===e.midi.type&&void 0!==e.midi.msb&&void 0!==e.midi.lsb&&o.setAttribute("data-nrpn","".concat(e.midi.msb,":").concat(e.midi.lsb));var a=[],c=[];if(e.options)a=r(e.options),c=e.midiValues?r(e.midiValues):e.options.map(function(e,t){return t});else for(var s=e.min||0,l=e.max||127,u=s;u<=l;u++)a.push(u.toString()),c.push(u);var d=null!==(t=this.controlValues.get(e.id))&&void 0!==t?t:this.calculateDefaultValue(e),f=c.indexOf(d),m=f/(a.length-1)*100/100*270-135;o.style.transform="rotate(".concat(m,"deg)"),this.controlValues.set(e.id,d);var v=document.createElement("div");v.className="control-input knob-text-display",v.classList.add("text-center"),v.style.minHeight="20px",v.style.fontSize="12px",v.style.color="var(--text-secondary)",v.textContent=a[f]||a[0];var p=!1,h=0,y=f;o.addEventListener("mousedown",function(t){p=!0,h=t.clientY,y=c.indexOf(n.controlValues.get(e.id)),document.addEventListener("mousemove",g),document.addEventListener("mouseup",b),t.preventDefault()});var g=function(t){if(p){var r=h-t.clientY,i=a.length/100,s=Math.max(0,Math.min(a.length-1,Math.round(y+r*i))),l=c[s],u=a[s];if(l!==n.controlValues.get(e.id)){var d=s/(a.length-1)*100/100*270-135;o.style.transform="rotate(".concat(d,"deg)"),v.textContent=u,n.updateControlValue(e,l)}}},b=function(){p=!1,document.removeEventListener("mousemove",g),document.removeEventListener("mouseup",b)};return o.addEventListener("dblclick",function(){var t=n.calculateDefaultValue(e),r=c.indexOf(t),i=a[r],s=r/(a.length-1)*100/100*270-135;o.style.transform="rotate(".concat(s,"deg)"),v.textContent=i,n.updateControlValue(e,t)}),i.appendChild(o),i.appendChild(v),i}},{key:"createSelect",value:function(e){var t=this;if("knob"===e.display)return this.createSelectAsKnob(e);var n=document.createElement("div");n.className="select-container",n.className="select-container flex-column-center",n.style.gap="var(--spacing-xs)";var i=document.createElement("button");i.className="select-arrow",i.textContent="◀",i.style.fontSize="14px",i.style.padding="4px 10px",i.style.background="#3a3a3a",i.style.border="1px solid #555",i.style.color="#ccc",i.style.cursor="pointer",i.style.borderRadius="3px";var o=document.createElement("select");o.className="control-input",o._controlConfig=e,e.midi&&"cc"===e.midi.type&&void 0!==e.midi.number?o.setAttribute("data-cc",e.midi.number):e.midi&&"cc_pair"===e.midi.type&&void 0!==e.midi.msb&&void 0!==e.midi.lsb?o.setAttribute("data-cc-pair","".concat(e.midi.msb,",").concat(e.midi.lsb)):e.midi&&"nrpn"===e.midi.type&&void 0!==e.midi.msb&&void 0!==e.midi.lsb&&o.setAttribute("data-nrpn","".concat(e.midi.msb,":").concat(e.midi.lsb));var a=document.createElement("button");a.className="select-arrow",a.textContent="▶",a.style.fontSize="14px",a.style.padding="4px 10px",a.style.background="#3a3a3a",a.style.border="1px solid #555",a.style.color="#ccc",a.style.cursor="pointer",a.style.borderRadius="3px";var c=[],s=[];if(e.options){var l;c=r(e.options),s=e.midiValues?r(e.midiValues):e.options.map(function(e,t){return t}),e.options.forEach(function(t,n){var r=document.createElement("option");r.value=e.midiValues?e.midiValues[n]:n,r.textContent=t,o.appendChild(r)});var u=this.calculateDefaultValue(e),d=null!==(l=this.controlValues.get(e.id))&&void 0!==l?l:u;o.value=d,this.controlValues.set(e.id,d)}else{for(var f,m=e.min||0,v=e.max||127,p=m;p<=v;p++){var h=document.createElement("option");h.value=p,h.textContent=p.toString(),o.appendChild(h),c.push(p.toString()),s.push(p)}var y=this.calculateDefaultValue(e),g=null!==(f=this.controlValues.get(e.id))&&void 0!==f?f:y;o.value=g,this.controlValues.set(e.id,g)}var b=function(){var e=s.indexOf(parseInt(o.value));i.disabled=e<=0,a.disabled=e>=s.length-1,i.disabled?(i.style.opacity="0.3",i.style.cursor="default"):(i.style.opacity="1",i.style.cursor="pointer"),a.disabled?(a.style.opacity="0.3",a.style.cursor="default"):(a.style.opacity="1",a.style.cursor="pointer")};i.addEventListener("click",function(n){if(n.preventDefault(),!i.disabled){var r=s.indexOf(parseInt(o.value));if(r>0){var a=s[r-1];o.value=a,t.updateControlValue(e,a),b()}}}),a.addEventListener("click",function(n){if(n.preventDefault(),!a.disabled){var r=s.indexOf(parseInt(o.value));if(r<s.length-1){var i=s[r+1];o.value=i,t.updateControlValue(e,i),b()}}}),o.addEventListener("change",function(n){t.updateControlValue(e,parseInt(n.target.value)),b()}),o.addEventListener("dblclick",function(){var n=t.calculateDefaultValue(e);o.value=n,t.updateControlValue(e,n),b()});var w=document.createElement("div");return w.style.display="flex",w.style.justifyContent="center",w.style.gap="0.25rem",w.appendChild(i),w.appendChild(a),b(),n.appendChild(o),n.appendChild(w),n}},{key:"createButton",value:function(e){var t,n=this,r=document.createElement("button");r.textContent=e.name,r.className="control-input",r._controlConfig=e,e.midi&&"cc"===e.midi.type&&void 0!==e.midi.number?r.setAttribute("data-cc",e.midi.number):e.midi&&"cc_pair"===e.midi.type&&void 0!==e.midi.msb&&void 0!==e.midi.lsb?r.setAttribute("data-cc-pair","".concat(e.midi.msb,",").concat(e.midi.lsb)):e.midi&&"nrpn"===e.midi.type&&void 0!==e.midi.msb&&void 0!==e.midi.lsb&&r.setAttribute("data-nrpn","".concat(e.midi.msb,":").concat(e.midi.lsb));var i=null!==(t=this.controlValues.get(e.id))&&void 0!==t?t:this.getButtonDefaultValue(e);return this.controlValues.set(e.id,i),this.updateButtonAppearance(r,i,e),r.addEventListener("click",function(){if(n.isToggleButton(e)){var t,i=null!==(t=n.controlValues.get(e.id))&&void 0!==t?t:n.getButtonOffValue(e),o=n.isButtonOn(i,e)?n.getButtonOffValue(e):n.getButtonOnValue(e);n.controlValues.set(e.id,o),n.updateControlValue(e,o),n.updateButtonAppearance(r,o,e)}else{var a=e.value||127;n.updateControlValue(e,a)}}),r}},{key:"updateButtonAppearance",value:function(e,t,n){this.isToggleButton(n)&&(this.isButtonOn(t,n)?(e.style.background="#4a90e2",e.style.color="white"):(e.style.background="#3a3a3a",e.style.color="#ccc"))}},{key:"isToggleButton",value:function(e){return void 0!==e.onValue&&void 0!==e.offValue}},{key:"getButtonOnValue",value:function(e){return e.onValue}},{key:"getButtonOffValue",value:function(e){return e.offValue}},{key:"isButtonOn",value:function(e,t){return e===t.onValue}},{key:"getButtonDefaultValue",value:function(e){return"on"===e.default?e.onValue:"off"===e.default?e.offValue:void 0!==e.default?e.default:e.offValue}},{key:"createTextInput",value:function(e){var t=this;if(e.readonly){var n=document.createElement("div");return n.className="control-input",n.textContent=e.value||e.default||"",n.style.background="transparent",n.style.border="none",n.style.textAlign="center",n.style.padding="0.5rem",n}var r=document.createElement("input");r.type="text",r.className="control-input";var i=this.controlValues.get(e.id)||e.value||e.default||"";return r.value=i,"patch_name"===e.id&&(void 0===this.savedPatchName&&(this.savedPatchName=i),this.controlValues.has(e.id)||this.controlValues.set(e.id,i)),e.maxLength&&(r.maxLength=e.maxLength),r.addEventListener("input",function(n){t.updateControlValue(e,n.target.value),"patch_name"===e.id&&t.updatePatchNameUnsavedIndicator(n.target.value)}),r._controlConfig=e,r}},{key:"createADSRDisplay",value:function(e){var t=document.createElement("div");t.className="adsr-display",t.style.width="200px",t.style.height="120px",t.style.display="flex",t.style.flexDirection="column",t.style.alignItems="center",t.style.gap="0.5rem";var n=document.createElementNS("http://www.w3.org/2000/svg","svg");n.setAttribute("width","180"),n.setAttribute("height","80"),n.setAttribute("viewBox","0 0 180 80"),n.style.background="#1a1a1a",n.style.border="1px solid #3a3a3a",n.style.borderRadius="4px";var r=document.createElementNS("http://www.w3.org/2000/svg","path");r.setAttribute("stroke","#4a90e2"),r.setAttribute("stroke-width","2"),r.setAttribute("fill","none"),r.setAttribute("stroke-linejoin","round");var i=document.createElementNS("http://www.w3.org/2000/svg","g");i.setAttribute("stroke","#2a2a2a"),i.setAttribute("stroke-width","1");for(var o=1;o<4;o++){var a=document.createElementNS("http://www.w3.org/2000/svg","line");a.setAttribute("x1","10"),a.setAttribute("y1",(20*o).toString()),a.setAttribute("x2","170"),a.setAttribute("y2",(20*o).toString()),i.appendChild(a)}for(var c=1;c<8;c++){var s=document.createElementNS("http://www.w3.org/2000/svg","line");s.setAttribute("x1",(10+20*c).toString()),s.setAttribute("y1","10"),s.setAttribute("x2",(10+20*c).toString()),s.setAttribute("y2","70"),i.appendChild(s)}return n.appendChild(i),n.appendChild(r),t.appendChild(n),t._adsrPath=r,t._config=e,this.updateADSRDisplay(t,e),t}},{key:"expandTemplate",value:function(e){for(var t=this,r=[],i=e.repeat||1,o=e.startIndex||0,a=function(){var i=o+c,a={};e.variables&&Object.keys(e.variables).forEach(function(t){var r=e.variables[t];"index"===r?a[t]=i:"object"===n(r)&&r.base&&void 0!==r.offset?"index"===r.base&&(a[t]=i+r.offset):a[t]=r}),e.controls.forEach(function(e){var n=t.substituteVariables(e,a);r.push(n)})},c=0;c<i;c++)a();return r}},{key:"substituteVariables",value:function(e,t){var r=this;if("string"==typeof e){var i=e;return Object.keys(t).forEach(function(e){var n=new RegExp("\\{\\{".concat(e,"\\}\\}"),"g");i=i.replace(n,t[e])}),i}if(Array.isArray(e))return e.map(function(e){return r.substituteVariables(e,t)});if("object"===n(e)&&null!==e){var o={};return Object.keys(e).forEach(function(n){var i=r.substituteVariables(n,t);o[i]=r.substituteVariables(e[n],t)}),o}return e}},{key:"updateADSRDisplay",value:function(e,t){var n,r,i,o,a,c,s;if(e._adsrPath&&t.parameters){var l=t.parameters;if(l.attack&&l.decay&&l.sustain&&l.release){var u=l.delay&&null!==(n=this.controlValues.get(l.delay))&&void 0!==n?n:0,d=null!==(r=this.controlValues.get(l.attack))&&void 0!==r?r:0,f=l.hold&&null!==(i=this.controlValues.get(l.hold))&&void 0!==i?i:0,m=null!==(o=this.controlValues.get(l.decay))&&void 0!==o?o:75,v=null!==(a=this.controlValues.get(l.sustain))&&void 0!==a?a:35,p=null!==(c=this.controlValues.get(l.release))&&void 0!==c?c:45,h=l.loop&&null!==(s=this.controlValues.get(l.loop))&&void 0!==s?s:0,y=l.delay?u/127:0,g=Math.max(d/127,.05),b=l.hold?f/127:0,w=Math.max(m/127,.05),C=Math.max(p/127,.05),E=160/(y+g+b+w+.15+C),M=y*E,S=g*E,I=b*E,x=w*E,k=.15*E,P=C*E,D=10,A=70-v/127*50,T=["M ".concat(D,",70")];l.delay&&M>0&&(D+=M,T.push("L ".concat(D,",70"))),D+=S,T.push("L ".concat(D,",20")),l.hold&&I>0&&(D+=I,T.push("L ".concat(D,",20"))),D+=x,T.push("L ".concat(D,",").concat(A)),D+=k,T.push("L ".concat(D,",").concat(A)),D+=P,T.push("L ".concat(D,",70")),e._adsrPath.setAttribute("d",T.join(" ")),e._loopIcon||(e._loopIcon=document.createElementNS("http://www.w3.org/2000/svg","text"),e._loopIcon.setAttribute("x","160"),e._loopIcon.setAttribute("y","15"),e._loopIcon.setAttribute("fill","#4a90e2"),e._loopIcon.setAttribute("font-size","12"),e._loopIcon.setAttribute("font-family","monospace"),e._loopIcon.textContent="↻",e.querySelector("svg").appendChild(e._loopIcon)),e._loopIcon.style.display=h>0?"block":"none"}else console.warn("ADSR display requires attack, decay, sustain, and release parameters")}}},{key:"updateRelatedEnvelopeDisplays",value:function(e){var t=this;document.querySelectorAll(".adsr-display").forEach(function(n){var r;null!==(r=n._config)&&void 0!==r&&r.parameters&&Object.values(n._config.parameters).includes(e.id)&&t.updateADSRDisplay(n,n._config)})}},{key:"convertInternalToDisplay",value:function(e,t){if(void 0!==e.displayMin&&void 0!==e.displayMax){var n,r=(e.max||127)-(e.min||0),i=e.displayMax-e.displayMin,o=(t-(e.min||0))/r,a=e.displayMin+o*i,c=(null===(n=(e.displayStep||e.step||1).toString().split(".")[1])||void 0===n?void 0:n.length)||0;return Number(a.toFixed(c))}return t}},{key:"convertDisplayToInternal",value:function(e,t){if(void 0!==e.displayMin&&void 0!==e.displayMax){var n=e.displayMax-e.displayMin,r=(e.max||127)-(e.min||0),i=(t-e.displayMin)/n;return Math.round((e.min||0)+i*r)}return t}},{key:"convertControlValueToMidiValue",value:function(e,t){var n=t;if("button"===e.type)n=t;else if("select"===e.type&&Array.isArray(e.options))e.midiValues&&Array.isArray(e.midiValues),n=t;else if("number"==typeof t)if(e.midi&&void 0!==e.midi.min&&void 0!==e.midi.max){var r=e.min||0,i=(e.max||127)-r,o=e.midi.min,a=e.midi.max-o,c=(t-r)/i;n=Math.round(o+c*a)}else if("nrpn"===e.midi.type)n=Math.max(e.min||0,Math.min(e.max||127,Math.round(t)));else if("cc_pair"===e.midi.type)n=Math.max(0,Math.min(255,Math.round(t)));else{var s=(e.max||127)-(e.min||0);n=Math.round((t-(e.min||0))/s*127)}return n}},{key:"updateNonMidiElement",value:function(e,t,n){"INPUT"===e.tagName&&"text"===e.type||"SELECT"===e.tagName?e.value=n:"BUTTON"===e.tagName&&this.isToggleButton(t)&&(n===this.getButtonOnValue(t)?e.classList.add("btn-active"):e.classList.remove("btn-active"))}},{key:"updateControlValue",value:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null,i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null,o=arguments.length>4&&void 0!==arguments[4]&&arguments[4];if(this.controlValues.set(e.id,t),n&&i)if(i.classList.contains("knob-text-display")&&e.options){var a=r(e.options),c=(e.midiValues?r(e.midiValues):e.options.map(function(e,t){return t})).indexOf(t);if(c>=0){var s=c/(a.length-1)*100/100*270-135;n.style.transform="rotate(".concat(s,"deg)"),i.textContent=a[c]}}else{var l=(t-(e.min||0))/((e.max||127)-(e.min||0))*100/100*270-135;n.style.transform="rotate(".concat(l,"deg)");var u=this.convertInternalToDisplay(e,t);i.value=u}if(n||i||this.updateSingleUIElement(e),e.midi&&window.midiManager.isConnected&&!o){var d=this.convertControlValueToMidiValue(e,t);window.midiManager.sendMIDIMessage(e.midi,d)}this.updateRelatedEnvelopeDisplays(e)}},{key:"calculateDefaultValue",value:function(e){if("select"===e.type&&e.options){if(e.midiValues){var t=e.options.indexOf(e.default);return t>=0?e.midiValues[t]:e.midiValues[0]}var n=e.options.indexOf(e.default);return n>=0?n:0}return void 0!==e.default&&null!==e.default?e.default:null!==(r=e.min)&&void 0!==r?r:0;var r}},{key:"resetAllToDefaults",value:function(){this.currentConfig&&this.loadDefaultValues()}},{key:"updateAllUIElements",value:function(){var e=this;this.currentTab&&this.currentTab.sections.forEach(function(t){t.controls&&t.controls.forEach(function(t){e.updateSingleUIElement(t)}),t.template&&e.expandTemplate(t.template).forEach(function(t){e.updateSingleUIElement(t)}),t.subsections&&t.subsections.forEach(function(t){t.controls&&t.controls.forEach(function(t){e.updateSingleUIElement(t)})})})}},{key:"updateSingleUIElement",value:function(e){var n,i,o,a=this,c=this.controlValues.get(e.id);if(void 0!==c){var s="";if("cc"===(null===(n=e.midi)||void 0===n?void 0:n.type)&&void 0!==e.midi.number)s='[data-cc="'.concat(e.midi.number,'"]');else if("cc_pair"===(null===(i=e.midi)||void 0===i?void 0:i.type)&&void 0!==e.midi.msb&&void 0!==e.midi.lsb)s='[data-cc-pair="'.concat(e.midi.msb,",").concat(e.midi.lsb,'"]');else{if("nrpn"!==(null===(o=e.midi)||void 0===o?void 0:o.type)||void 0===e.midi.msb||void 0===e.midi.lsb){var l,u=t(document.querySelectorAll("input, select, button"));try{for(u.s();!(l=u.n()).done;){var d,f=l.value;if((null===(d=f._controlConfig)||void 0===d?void 0:d.id)===e.id)return void this.updateNonMidiElement(f,e,c)}}catch(e){u.e(e)}finally{u.f()}return}s='[data-nrpn="'.concat(e.midi.msb,":").concat(e.midi.lsb,'"]')}document.querySelectorAll(s).forEach(function(t){var n;if((null===(n=t._controlConfig)||void 0===n?void 0:n.id)===e.id)if("INPUT"===t.tagName&&"range"===t.type){t.value=c;var i=t.parentElement.querySelector('input[type="number"]');if(i){var o=a.convertInternalToDisplay(e,c);i.value=o}}else if("INPUT"===t.tagName&&"number"===t.type){var s=a.convertInternalToDisplay(e,c);t.value=s}else if(t.classList.contains("knob")){var l=t.parentElement.querySelector(".knob-text-display");if(l&&e.options){var u=r(e.options),d=(e.midiValues?r(e.midiValues):e.options.map(function(e,t){return t})).indexOf(c);if(d>=0){var f=d/(u.length-1)*100/100*270-135;t.style.transform="rotate(".concat(f,"deg)"),l.textContent=u[d]}}else{var m=(c-(e.min||0))/((e.max||127)-(e.min||0))*100/100*270-135;t.style.transform="rotate(".concat(m,"deg)");var v=t.parentElement.querySelector('input[type="number"]');if(v){var p=a.convertInternalToDisplay(e,c);v.value=p}}}else if("SELECT"===t.tagName){t.value=c;var h=t.closest(".select-container");if(h){var y=h.querySelector(".select-arrow:first-child"),g=h.querySelector(".select-arrow:last-child"),b=Array.from(t.options).map(function(e){return parseInt(e.value)}),w=b.indexOf(parseInt(c));y&&(y.disabled=w<=0,y.style.opacity=y.disabled?"0.3":"1",y.style.cursor=y.disabled?"default":"pointer"),g&&(g.disabled=w>=b.length-1,g.style.opacity=g.disabled?"0.3":"1",g.style.cursor=g.disabled?"default":"pointer")}}else"BUTTON"===t.tagName&&a.updateButtonAppearance(t,c,e)}),this.updateRelatedEnvelopeDisplays(e)}}},{key:"getControlValue",value:function(e){return this.controlValues.get(e)}},{key:"getAllControlValues",value:function(){this.ensureAllControlValuesInitialized();var n,r={},i=t(this.controlValues.entries());try{for(i.s();!(n=i.n()).done;){var o=e(n.value,2),a=o[0],c=o[1];this.isReadOnlyControl(a)||(r[a]=c)}}catch(e){i.e(e)}finally{i.f()}return r}},{key:"isReadOnlyControl",value:function(e){if(e.includes("_header_")||e.includes("_label")||e.includes("_display"))return!0;var t=this.findControlConfigById(e);return!(!t||"adsr_display"!==t.type&&!0!==t.readonly)}},{key:"findControlConfigById",value:function(e){if(!this.currentConfig||!this.currentConfig.tabs)return null;var n,r=t(this.currentConfig.tabs);try{for(r.s();!(n=r.n()).done;){var i,o=t(n.value.sections);try{for(o.s();!(i=o.n()).done;){var a=i.value;if(a.controls&&Array.isArray(a.controls)){var c=a.controls.find(function(t){return t.id===e});if(c)return c}if(a.subsections&&Array.isArray(a.subsections)){var s,l=t(a.subsections);try{for(l.s();!(s=l.n()).done;){var u=s.value;if(u.controls&&Array.isArray(u.controls)){var d=u.controls.find(function(t){return t.id===e});if(d)return d}}}catch(e){l.e(e)}finally{l.f()}}if(a.template){var f=this.expandTemplate(a.template).find(function(t){return t.id===e});if(f)return f}}}catch(e){o.e(e)}finally{o.f()}}}catch(e){r.e(e)}finally{r.f()}return null}},{key:"ensureAllControlValuesInitialized",value:function(){var e=this;this.currentConfig&&this.currentConfig.tabs&&this.currentConfig.tabs.forEach(function(t){t.sections.forEach(function(t){t.controls&&Array.isArray(t.controls)&&t.controls.forEach(function(t){if(t.id&&!e.controlValues.has(t.id)){var n=e.calculateDefaultValue(t);e.controlValues.set(t.id,n)}}),t.template&&e.expandTemplate(t.template).forEach(function(t){if(t.id&&!e.controlValues.has(t.id)){var n=e.calculateDefaultValue(t);e.controlValues.set(t.id,n)}}),t.subsections&&Array.isArray(t.subsections)&&t.subsections.forEach(function(t){t.controls&&Array.isArray(t.controls)&&t.controls.forEach(function(t){if(t.id&&!e.controlValues.has(t.id)){var n=e.calculateDefaultValue(t);e.controlValues.set(t.id,n)}})})})})}},{key:"loadControlValues",value:function(t){for(var n=0,r=Object.entries(t);n<r.length;n++){var i=e(r[n],2),o=i[0],a=i[1];this.controlValues.set(o,a)}this.updateAllUIElements(),this.clearPatchNameUnsavedIndicator()}},{key:"sendAllParameters",value:function(){if(window.midiManager.isConnected)if(this.currentConfig&&this.currentConfig.tabs){if(window.synthEditor.sysExHandler&&this.hasSysExMappings())try{window.synthEditor.notificationManager.info("Generating and sending patch via SysEx...");var e=window.synthEditor.sysExHandler.generatePatchDump();if(!e)throw new Error("Unable to generate SysEx patch dump");if(window.midiManager.sendSysEx(e))return window.synthEditor.notificationManager.success("Patch sent successfully via SysEx!"),void this.clearPatchNameUnsavedIndicator();window.synthEditor.notificationManager.warning("SysEx send failed, falling back to individual MIDI messages...")}catch(e){console.error("SysEx patch generation failed:",e),window.synthEditor.notificationManager.warning("SysEx generation failed, falling back to individual MIDI messages...")}window.synthEditor.notificationManager.info("Sending parameters via individual MIDI messages..."),this.sendAllParametersViaMIDI()}else window.synthEditor.notificationManager.warning("No synthesizer configuration loaded.");else window.synthEditor.notificationManager.warning("No MIDI device connected. Please connect a MIDI device first.")}},{key:"hasSysExMappings",value:function(){var e,n=t(this.currentConfig.tabs||[]);try{for(n.s();!(e=n.n()).done;){var r,i=t(e.value.sections||[]);try{for(i.s();!(r=i.n()).done;){var o=r.value;if(o.controls){var a,c=t(o.controls);try{for(c.s();!(a=c.n()).done;){var s;if(null!==(s=a.value.sysEx)&&void 0!==s&&s.offsets)return!0}}catch(e){c.e(e)}finally{c.f()}}if(o.subsections){var l,u=t(o.subsections);try{for(u.s();!(l=u.n()).done;){var d=l.value;if(d.controls){var f,m=t(d.controls);try{for(m.s();!(f=m.n()).done;){var v;if(null!==(v=f.value.sysEx)&&void 0!==v&&v.offsets)return!0}}catch(e){m.e(e)}finally{m.f()}}}}catch(e){u.e(e)}finally{u.f()}}}}catch(e){i.e(e)}finally{i.f()}}}catch(e){n.e(e)}finally{n.f()}return!1}},{key:"sendAllParametersViaMIDI",value:function(){var e=this,t=[];this.currentConfig.tabs.forEach(function(n){n.sections&&n.sections.forEach(function(r){r.controls&&Array.isArray(r.controls)&&r.controls.forEach(function(i){if(i.id&&i.midi){var o=e.controlValues.get(i.id),a=void 0!==o?o:void 0!==i.default?i.default:0;t.push({config:i,value:a,location:"".concat(n.name," > ").concat(r.name," > ").concat(i.name)})}}),r.template&&e.expandTemplate(r.template).forEach(function(i){if(i.id&&i.midi){var o=e.controlValues.get(i.id),a=void 0!==o?o:void 0!==i.default?i.default:0;t.push({config:i,value:a,location:"".concat(n.name," > ").concat(r.name," > ").concat(i.name)})}}),r.subsections&&Array.isArray(r.subsections)&&r.subsections.forEach(function(i){i.controls&&Array.isArray(i.controls)&&i.controls.forEach(function(o){if(o.id&&o.midi){var a=e.controlValues.get(o.id),c=void 0!==a?a:void 0!==o.default?o.default:0;t.push({config:o,value:c,location:"".concat(n.name," > ").concat(r.name," > ").concat(i.name," > ").concat(o.name)})}})})})}),0!==t.length?this.sendParametersSequentially(t):alert("No MIDI-enabled parameters found to send.")}},{key:"sendParametersSequentially",value:function(e){var t=this,n=0,r=function(i){if(i>=e.length)return t.clearPatchNameUnsavedIndicator(),void(n>0&&alert("".concat(n," parameters failed to send.")));var o=e[i];try{var a=t.convertControlValueToMidiValue(o.config,o.value);window.midiManager.sendMIDIMessage(o.config.midi,a)||(n++,console.error("✗ Failed to send ".concat(o.location,": ").concat(o.value)))}catch(e){n++,console.error("✗ Error sending ".concat(o.location,":"),e)}setTimeout(function(){return r(i+1)},10)};r(0)}},{key:"sendInitPatch",value:function(){var t;if(!window.midiManager.isConnected)return window.synthEditor.notificationManager.warning("No MIDI device connected. Please connect a MIDI device first."),!1;if(null===(t=this.currentConfig)||void 0===t||!t.initPatch)return window.synthEditor.notificationManager.info("Sending default values via individual MIDI messages..."),this.loadDefaultValues(),this.sendAllParametersViaMIDI(),!0;try{if(window.midiManager.sendSysEx(this.currentConfig.initPatch),window.synthEditor.notificationManager.success("Init patch sent to synthesizer!"),window.synthEditor.sysExHandler)try{var n=window.synthEditor.sysExHandler.convertDumpToParameters(this.currentConfig.initPatch);if(n&&Object.keys(n).length>0){for(var r={},i=0,o=Object.entries(n);i<o.length;i++){var a=e(o[i],2),c=a[0],s=a[1];r[c]=s.controlValue}this.loadControlValues(r),window.synthEditor.notificationManager.success("Init patch loaded with ".concat(Object.keys(n).length," parameter values!"))}else this.loadDefaultValues(),this.clearPatchNameUnsavedIndicator()}catch(e){console.error("Error parsing init patch SysEx:",e),this.loadDefaultValues(),this.clearPatchNameUnsavedIndicator(),window.synthEditor.notificationManager.warning("Init patch sent, using default values (could not parse SysEx)")}else this.loadDefaultValues(),this.clearPatchNameUnsavedIndicator();return!0}catch(e){return console.error("Error sending init patch:",e),window.synthEditor.notificationManager.error("Failed to send init patch: "+e.message),!1}}},{key:"loadDefaultValues",value:function(){var e=this;this.currentConfig.tabs.forEach(function(t){t.sections.forEach(function(t){t.controls&&t.controls.forEach(function(t){var n=e.calculateDefaultValue(t);e.controlValues.set(t.id,n)}),t.template&&e.expandTemplate(t.template).forEach(function(t){var n=e.calculateDefaultValue(t);e.controlValues.set(t.id,n)}),t.subsections&&t.subsections.forEach(function(t){t.controls&&t.controls.forEach(function(t){var n=e.calculateDefaultValue(t);e.controlValues.set(t.id,n)})})})}),this.updateAllUIElements()}},{key:"toggleHelpMode",value:function(){this.helpMode=!this.helpMode;var e=document.getElementById("help-mode-toggle");this.helpMode?(e.style.background="#4a90e2",e.style.color="white",document.body.style.cursor="help",this.addHelpEventListeners()):(e.style.background="",e.style.color="",document.body.style.cursor="",this.removeHelpEventListeners(),this.hideTooltip())}},{key:"addHelpEventListeners",value:function(){var e=this;document.querySelectorAll(".control").forEach(function(t){t.addEventListener("mouseenter",e.boundHandleControlMouseEnter),t.addEventListener("mouseleave",e.boundHandleControlMouseLeave)})}},{key:"removeHelpEventListeners",value:function(){var e=this;document.querySelectorAll(".control").forEach(function(t){t.removeEventListener("mouseenter",e.boundHandleControlMouseEnter),t.removeEventListener("mouseleave",e.boundHandleControlMouseLeave)})}},{key:"handleControlMouseEnter",value:function(e){if(this.helpMode){var t=e.target,n=this.findControlConfig(t);n&&this.showTooltip(e,n)}}},{key:"handleControlMouseLeave",value:function(e){this.helpMode&&this.hideTooltip()}},{key:"findControlConfig",value:function(e){var t=e.querySelector(".knob");if(t&&t._controlConfig)return t._controlConfig;var n=e.querySelector('input[type="range"]');if(n&&n._controlConfig)return n._controlConfig;var r=e.querySelector("select");if(r&&r._controlConfig)return r._controlConfig;var i=e.querySelector("button.control-input");if(i&&i._controlConfig)return i._controlConfig;var o=e.querySelector('input[type="text"]');if(o&&o._controlConfig)return o._controlConfig;var a=e.querySelector('input[type="number"]:not(.control-input)');if(a&&a._controlConfig)return a._controlConfig;var c=e.querySelector("[data-cc], [data-cc-pair], [data-nrpn]");return c&&c._controlConfig?c._controlConfig:null}},{key:"showTooltip",value:function(e,t){this.hideTooltip();var n=document.createElement("div");n.className="help-tooltip",n.style.position="absolute",n.style.background="#2a2a2a",n.style.border="1px solid #555",n.style.borderRadius="4px",n.style.padding="8px",n.style.color="#ccc",n.style.fontSize="12px",n.style.lineHeight="1.4",n.style.maxWidth="300px",n.style.zIndex="9999",n.style.boxShadow="0 4px 8px rgba(0,0,0,0.3)";var r="<strong>".concat(t.name,"</strong><br>");t.midi&&("cc"===t.midi.type?r+="MIDI CC: ".concat(t.midi.number,"<br>"):"cc_pair"===t.midi.type?r+="MIDI CC Pair: MSB ".concat(t.midi.msb,", LSB ").concat(t.midi.lsb,"<br>"):"nrpn"===t.midi.type&&(r+="NRPN: MSB ".concat(t.midi.msb,", LSB ").concat(t.midi.lsb,"<br>")),void 0!==t.midi.min&&void 0!==t.midi.max&&(r+="MIDI Range: ".concat(t.midi.min,"-").concat(t.midi.max,"<br>")));var i="button"===t.type&&this.isToggleButton(t);void 0===t.min||void 0===t.max||i||(r+="Range: ".concat(t.min," to ").concat(t.max,"<br>")),i&&(r+="Off Value: ".concat(this.getButtonOffValue(t),"<br>"),r+="On Value: ".concat(this.getButtonOnValue(t),"<br>")),t.step&&!i&&(r+="Step: ".concat(t.step,"<br>")),void 0!==t.default&&(r+="Default: ".concat(t.default,"<br>")),t.options&&t.midiValues&&(r+="Options:<br>",t.options.forEach(function(e,n){var i=t.midiValues[n];r+="  ".concat(e," (").concat(i,")<br>")})),t.sysEx&&t.sysEx.offsets&&t.sysEx.offsets.length>0&&(r+="SysEx Offset(s): ".concat(t.sysEx.offsets.join(" "),"<br>")),n.innerHTML=r,document.body.appendChild(n);var o=e.target.getBoundingClientRect(),a=n.getBoundingClientRect(),c=o.right+10,s=o.top;c+a.width>window.innerWidth&&(c=o.left-a.width-10),s+a.height>window.innerHeight&&(s=window.innerHeight-a.height-10),n.style.left=c+"px",n.style.top=s+"px",this.currentTooltip=n}},{key:"hideTooltip",value:function(){this.currentTooltip&&(this.currentTooltip.remove(),this.currentTooltip=null)}},{key:"updatePatchNameUnsavedIndicator",value:function(e){void 0===this.savedPatchName&&(this.savedPatchName=this.controlValues.get("patch_name")||""),e!==this.savedPatchName?this.showPatchNameUnsavedIndicator():this.hidePatchNameUnsavedIndicator()}},{key:"showPatchNameUnsavedIndicator",value:function(){var e=this.findControlByIdInDOM("patch_name");if(e){var t=e.querySelector(".control-label");t&&!t.textContent.includes("●")&&(t.textContent=t.textContent+" ●",t.style.color="#ff6b6b",t.title="Patch name changed - use Send All to apply")}}},{key:"hidePatchNameUnsavedIndicator",value:function(){var e=this.findControlByIdInDOM("patch_name");if(e){var t=e.querySelector(".control-label");t&&t.textContent.includes("●")&&(t.textContent=t.textContent.replace(" ●",""),t.style.color="",t.title="")}}},{key:"clearPatchNameUnsavedIndicator",value:function(){var e=this.controlValues.get("patch_name")||"";this.savedPatchName=e,this.hidePatchNameUnsavedIndicator()}},{key:"findControlByIdInDOM",value:function(e){var n,r=t(document.querySelectorAll('input[type="text"]'));try{for(r.s();!(n=r.n()).done;){var i=n.value;if(i._controlConfig&&i._controlConfig.id===e)return i.closest(".control")}}catch(e){r.e(e)}finally{r.f()}return null}}],o&&a(i.prototype,o),Object.defineProperty(i,"prototype",{writable:!1}),i;var i,o}();window.uiManager=new s},938:()=>{function e(t){return e="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},e(t)}function t(e,t){var r="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!r){if(Array.isArray(e)||(r=n(e))||t&&e&&"number"==typeof e.length){r&&(e=r);var i=0,o=function(){};return{s:o,n:function(){return i>=e.length?{done:!0}:{done:!1,value:e[i++]}},e:function(e){throw e},f:o}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var a,c=!0,s=!1;return{s:function(){r=r.call(e)},n:function(){var e=r.next();return c=e.done,e},e:function(e){s=!0,a=e},f:function(){try{c||null==r.return||r.return()}finally{if(s)throw a}}}}function n(e,t){if(e){if("string"==typeof e)return r(e,t);var n={}.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?r(e,t):void 0}}function r(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=Array(t);n<t;n++)r[n]=e[n];return r}function i(){var e,t,n="function"==typeof Symbol?Symbol:{},r=n.iterator||"@@iterator",a=n.toStringTag||"@@toStringTag";function c(n,r,i,a){var c=r&&r.prototype instanceof l?r:l,u=Object.create(c.prototype);return o(u,"_invoke",function(n,r,i){var o,a,c,l=0,u=i||[],d=!1,f={p:0,n:0,v:e,a:m,f:m.bind(e,4),d:function(t,n){return o=t,a=0,c=e,f.n=n,s}};function m(n,r){for(a=n,c=r,t=0;!d&&l&&!i&&t<u.length;t++){var i,o=u[t],m=f.p,v=o[2];n>3?(i=v===r)&&(c=o[(a=o[4])?5:(a=3,3)],o[4]=o[5]=e):o[0]<=m&&((i=n<2&&m<o[1])?(a=0,f.v=r,f.n=o[1]):m<v&&(i=n<3||o[0]>r||r>v)&&(o[4]=n,o[5]=r,f.n=v,a=0))}if(i||n>1)return s;throw d=!0,r}return function(i,u,v){if(l>1)throw TypeError("Generator is already running");for(d&&1===u&&m(u,v),a=u,c=v;(t=a<2?e:c)||!d;){o||(a?a<3?(a>1&&(f.n=-1),m(a,c)):f.n=c:f.v=c);try{if(l=2,o){if(a||(i="next"),t=o[i]){if(!(t=t.call(o,c)))throw TypeError("iterator result is not an object");if(!t.done)return t;c=t.value,a<2&&(a=0)}else 1===a&&(t=o.return)&&t.call(o),a<2&&(c=TypeError("The iterator does not provide a '"+i+"' method"),a=1);o=e}else if((t=(d=f.n<0)?c:n.call(r,f))!==s)break}catch(t){o=e,a=1,c=t}finally{l=1}}return{value:t,done:d}}}(n,i,a),!0),u}var s={};function l(){}function u(){}function d(){}t=Object.getPrototypeOf;var f=[][r]?t(t([][r]())):(o(t={},r,function(){return this}),t),m=d.prototype=l.prototype=Object.create(f);function v(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,d):(e.__proto__=d,o(e,a,"GeneratorFunction")),e.prototype=Object.create(m),e}return u.prototype=d,o(m,"constructor",d),o(d,"constructor",u),u.displayName="GeneratorFunction",o(d,a,"GeneratorFunction"),o(m),o(m,a,"Generator"),o(m,r,function(){return this}),o(m,"toString",function(){return"[object Generator]"}),(i=function(){return{w:c,m:v}})()}function o(e,t,n,r){var i=Object.defineProperty;try{i({},"",{})}catch(e){i=0}o=function(e,t,n,r){function a(t,n){o(e,t,function(e){return this._invoke(t,n,e)})}t?i?i(e,t,{value:n,enumerable:!r,configurable:!r,writable:!r}):e[t]=n:(a("next",0),a("throw",1),a("return",2))},o(e,t,n,r)}function a(e,t,n,r,i,o,a){try{var c=e[o](a),s=c.value}catch(e){return void n(e)}c.done?t(s):Promise.resolve(s).then(r,i)}function c(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,s(r.key),r)}}function s(t){var n=function(t){if("object"!=e(t)||!t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var r=n.call(t,"string");if("object"!=e(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(t);return"symbol"==e(n)?n:n+""}var l=function(){return e=function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.midiAccess=null,this.outputDevice=null,this.inputDevice=null,this.isConnected=!1,this.currentChannel=1,this.ccPairValues=new Map,this.nrpnState={msb:null,lsb:null}},r=[{key:"initialize",value:(o=i().m(function e(){var t;return i().w(function(e){for(;;)switch(e.p=e.n){case 0:if(e.p=0,!navigator.requestMIDIAccess){e.n=2;break}return e.n=1,navigator.requestMIDIAccess({sysex:!0});case 1:return this.midiAccess=e.v,e.a(2,!0);case 2:return console.error("Web MIDI API not supported"),e.a(2,!1);case 3:e.n=5;break;case 4:return e.p=4,t=e.v,console.error("Failed to enable WebMIDI:",t),e.a(2,!1);case 5:return e.a(2)}},e,this,[[0,4]])}),s=function(){var e=this,t=arguments;return new Promise(function(n,r){var i=o.apply(e,t);function c(e){a(i,n,r,c,s,"next",e)}function s(e){a(i,n,r,c,s,"throw",e)}c(void 0)})},function(){return s.apply(this,arguments)})},{key:"getAvailableOutputs",value:function(){if(!this.midiAccess)return[];var e,n=[],r=t(this.midiAccess.outputs.values());try{for(r.s();!(e=r.n()).done;){var i=e.value;n.push({id:i.id,name:i.name,manufacturer:i.manufacturer||"",version:i.version||"",stableId:this.createStableDeviceId(i)})}}catch(e){r.e(e)}finally{r.f()}return n}},{key:"getAvailableInputs",value:function(){if(!this.midiAccess)return[];var e,n=[],r=t(this.midiAccess.inputs.values());try{for(r.s();!(e=r.n()).done;){var i=e.value;n.push({id:i.id,name:i.name,manufacturer:i.manufacturer||"",version:i.version||"",stableId:this.createStableDeviceId(i)})}}catch(e){r.e(e)}finally{r.f()}return n}},{key:"createStableDeviceId",value:function(e){var t=e.manufacturer||"Unknown",n=e.name||"Unknown Device",r=e.type||"unknown",i=e.version||"",o="".concat(t,":").concat(n,":").concat(r);return i&&(o+=":".concat(i)),o}},{key:"findDeviceByStableId",value:function(e){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"output";if(!this.midiAccess)return null;var r,i=t(("output"===n?this.midiAccess.outputs:this.midiAccess.inputs).values());try{for(i.s();!(r=i.n()).done;){var o=r.value;if(this.createStableDeviceId(o)===e)return o}}catch(e){i.e(e)}finally{i.f()}return null}},{key:"connectOutput",value:function(e){if(!this.midiAccess)return console.error("MIDI access not initialized"),!1;try{var t=this.midiAccess.outputs.get(e);return t?(this.outputDevice=t,this.isConnected=!0,!0):(console.error("Output device with ID ".concat(e," not found")),!1)}catch(e){return console.error("Error connecting to output device:",e),!1}}},{key:"connectInput",value:function(e){var t=this;if(!this.midiAccess)return console.error("MIDI access not initialized"),!1;try{var n=this.midiAccess.inputs.get(e);return n?(this.inputDevice=n,n.onmidimessage=function(e){t.handleMIDIInput(e)},!0):(console.error("Input device with ID ".concat(e," not found")),!1)}catch(e){return console.error("Error connecting to input device:",e),!1}}},{key:"disconnect",value:function(){this.inputDevice&&(this.inputDevice.onmidimessage=null),this.outputDevice=null,this.inputDevice=null,this.isConnected=!1}},{key:"setChannel",value:function(e){this.currentChannel=e}},{key:"sendCC",value:function(e,t){if(!this.outputDevice)return console.warn("No MIDI output device connected"),!1;try{var n=this.currentChannel-1+176,r=Math.max(0,Math.min(127,Math.round(t))),i=[n,e,r];return this.outputDevice.send(i),this.logMIDI("out","CC ".concat(e,": ").concat(r," (Ch ").concat(this.currentChannel,")"),i),!0}catch(e){return console.error("Failed to send CC:",e),!1}}},{key:"sendCCPair",value:function(e,t,n){if(!this.outputDevice)return console.warn("No MIDI output device connected"),!1;try{var r=this.currentChannel-1+176,i=Math.max(0,Math.min(255,Math.round(n))),o=i>>1&127,a=(1&i)<<6,c=[r,e,o],s=[r,t,a];return this.outputDevice.send(c),this.outputDevice.send(s),this.logMIDI("out","CC pair ".concat(e,"/").concat(t,": ").concat(i," (MSB:").concat(o,", LSB:").concat(a,") (Ch ").concat(this.currentChannel,")"),[c,s]),!0}catch(e){return console.error("Failed to send CC pair:",e),!1}}},{key:"sendNRPN",value:function(e,t,n){var r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0,i=arguments.length>4&&void 0!==arguments[4]&&arguments[4];if(!this.outputDevice)return console.warn("No MIDI output device connected"),!1;try{var o=this.currentChannel-1+176,a=[o,99,e];this.outputDevice.send(a),this.logMIDI("out","NRPN MSB: ".concat(e),a);var c=[o,98,t];this.outputDevice.send(c),this.logMIDI("out","NRPN LSB: ".concat(t),c);var s=[o,6,n];if(this.outputDevice.send(s),this.logMIDI("out","Data MSB: ".concat(n),s),!i){var l=[o,38,r];this.outputDevice.send(l),this.logMIDI("out","Data LSB: ".concat(r),l)}var u=i?"".concat(n," (MSB only)"):"".concat(n,":").concat(r);return this.logMIDI("out","NRPN ".concat(e,":").concat(t," = ").concat(u," (Ch ").concat(this.currentChannel,")")),!0}catch(e){return console.error("Failed to send NRPN:",e),!1}}},{key:"shouldSendNRPNLSB",value:function(){return!window.uiManager||!window.uiManager.currentConfig||!1!==window.uiManager.currentConfig.nrpnSendLSB}},{key:"sendProgramChange",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;if(!this.outputDevice)return console.warn("No MIDI output device connected"),!1;try{var n=t||this.currentChannel,r=[n-1+192,Math.max(0,Math.min(127,e))];return this.outputDevice.send(r),this.logMIDI("out","Program Change: ".concat(e," (Ch ").concat(n,")"),r),!0}catch(e){return console.error("Failed to send Program Change:",e),!1}}},{key:"sendSysEx",value:function(e){if(!this.outputDevice)return console.warn("No MIDI output device connected"),!1;try{var t;if("string"==typeof e)t=e.split(" ").map(function(e){return parseInt(e,16)});else{if(!Array.isArray(e))return console.error("Invalid SysEx data format"),!1;t=e}return this.outputDevice.send(t),this.logMIDI("out","SysEx: ".concat(e),t),!0}catch(e){return console.error("Failed to send SysEx:",e),!1}}},{key:"sendMIDIMessage",value:function(e,t){switch(e.type){case"cc":return this.sendCC(e.number,t);case"cc_pair":return this.sendCCPair(e.msb,e.lsb,t);case"nrpn":var n=Math.max(0,Math.min(127,Math.round(t))),r=this.shouldSendNRPNLSB();return this.sendNRPN(e.msb,e.lsb,n,0,!r);case"sysex":var i=e.template;if("string"==typeof t){var o=Array.from(t).map(function(e){return e.charCodeAt(0).toString(16).padStart(2,"0")}).join(" ");i=i.replace("{data}",o)}else i=i.replace("{data}",t.toString(16).padStart(2,"0"));return this.sendSysEx(i);default:return console.warn("Unknown MIDI message type:",e.type),!1}}},{key:"handleMIDIInput",value:function(e){var t=Array.from(e.data),n=t[0],r=1+(15&n),i="",o=!1;switch(240&n){case 128:i="Note Off: ".concat(t[1]," velocity ").concat(t[2]," (Ch ").concat(r,")");break;case 144:i="Note On: ".concat(t[1]," velocity ").concat(t[2]," (Ch ").concat(r,")");break;case 176:99===t[1]?(i="NRPN MSB: ".concat(t[2]," (Ch ").concat(r,")"),this.nrpnState.msb=t[2]):98===t[1]?(i="NRPN LSB: ".concat(t[2]," (Ch ").concat(r,")"),this.nrpnState.lsb=t[2]):6===t[1]?(i="Data Entry MSB: ".concat(t[2]," (Ch ").concat(r,")"),null!==this.nrpnState.msb&&null!==this.nrpnState.lsb&&this.updateUIFromNRPN(this.nrpnState.msb,this.nrpnState.lsb,t[2],r)):38===t[1]?(i="Data Entry LSB: ".concat(t[2]," (Ch ").concat(r,")"),null===this.nrpnState.msb&&null===this.nrpnState.lsb&&(o=!0)):(i="CC ".concat(t[1],": ").concat(t[2]," (Ch ").concat(r,")"),o=!0);break;case 192:i="Program Change: ".concat(t[1]," (Ch ").concat(r,")");break;case 224:var a=t[1]+(t[2]<<7);i="Pitch Bend: ".concat(a," (Ch ").concat(r,")");break;case 240:i=240===n?"SysEx: ".concat(t.map(function(e){return e.toString(16).padStart(2,"0")}).join(" ")):"System: ".concat(n.toString(16)," (").concat(t.slice(1).join(" "),")");break;default:i="Unknown: ".concat(t.join(" "))}this.logMIDI("in",i,t),o&&this.updateUIFromCC(t[1],t[2],r)}},{key:"updateUIFromCC",value:function(e,t,n){n!==this.currentChannel&&1!==n||(this.handleCCPairUpdate(e,t,n),document.querySelectorAll('[data-cc="'.concat(e,'"]')).forEach(function(e){if("INPUT"===e.tagName&&"range"===e.type){var n=parseFloat(e.min)||0,r=parseFloat(e.max)||127,i=n+t/127*(r-n);e.value=Math.round(i);var o=e.parentElement.querySelector('input[type="number"]');o&&(o.value=Math.round(i));var a=e._controlConfig;a&&window.uiManager&&window.uiManager.updateControlValue(a,Math.round(i),null,null,!0)}else if("INPUT"===e.tagName&&"number"===e.type){e.value=t;var c=e._controlConfig;c&&window.uiManager&&window.uiManager.updateControlValue(c,t,null,null,!0)}else if(e.classList.contains("knob")){var s=e._controlConfig;if(s){var l=s.min+t/127*(s.max-s.min),u=(l-s.min)/(s.max-s.min)*270-135;e.style.transform="rotate(".concat(u,"deg)");var d=e.parentElement.querySelector(".control-input");d&&(d.value=Math.round(l)),window.uiManager&&window.uiManager.updateControlValue(s,Math.round(l),null,null,!0)}}else if("SELECT"===e.tagName){e.value=t;var f=e._controlConfig;f&&window.uiManager&&window.uiManager.updateControlValue(f,parseInt(t),null,null,!0)}}))}},{key:"updateUIFromNRPN",value:function(e,t,n,r){if(r===this.currentChannel||1===r){var i='[data-nrpn="'.concat(e,":").concat(t,'"]');document.querySelectorAll(i).forEach(function(e){var t=e._controlConfig;if(t){var r=n;if(void 0!==t.midi.min&&void 0!==t.midi.max){var i=t.midi.min,o=t.midi.max-i,a=t.min||0,c=(t.max||127)-a,s=(n-i)/o;r=Math.round(a+s*c)}if("INPUT"===e.tagName&&"range"===e.type){e.value=r;var l=e.parentElement.querySelector('input[type="number"]');l&&(l.value=r)}else if("INPUT"===e.tagName&&"number"===e.type)e.value=r;else if(e.classList.contains("knob")){var u=t.min||0,d=(r-u)/((t.max||127)-u)*100/100*270-135;e.style.transform="rotate(".concat(d,"deg)");var f=e.parentElement.querySelector('input[type="number"]');f&&(f.value=r)}else"SELECT"===e.tagName&&(e.value=r);window.uiManager&&window.uiManager.updateControlValue(t,r,null,null,!0)}})}}},{key:"logMIDI",value:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null,r=(new Date).toLocaleTimeString(),i=document.getElementById("midi-log"),o=document.getElementById("modal-midi-log"),a=document.getElementById("mapper-midi-log"),c=document.createElement("div");c.className="midi-message ".concat("out"===e?"outgoing":"incoming");var s='<span class="midi-timestamp">'.concat(r,"</span> ");if(s+='<span class="midi-direction">'.concat(e.toUpperCase(),":</span> "),s+='<span class="midi-data">'.concat(t,"</span>"),n&&Array.isArray(n)){var l=n.map(function(e){return e.toString(16).padStart(2,"0").toUpperCase()}).join(" ");s+='<br><span class="midi-raw">['.concat(l,"]</span>")}if(c.innerHTML=s,i){var u=c.cloneNode(!0);i.appendChild(u);var d=document.getElementById("midi-monitor-content");d&&!d.classList.contains("hidden")&&(d.scrollTop=d.scrollHeight);var f=i.children;f.length>100&&i.removeChild(f[0])}if(o){var m=c.cloneNode(!0);o.appendChild(m),o.scrollTop=o.scrollHeight;var v=o.children;v.length>100&&o.removeChild(v[0])}if(a){var p=c.cloneNode(!0);a.appendChild(p),a.scrollTop=a.scrollHeight;var h=a.children;h.length>100&&a.removeChild(h[0])}}},{key:"handleCCPairUpdate",value:function(e,t,r){var i=this;document.querySelectorAll("[data-cc-pair]").forEach(function(r){var o=r.getAttribute("data-cc-pair").split(",").map(function(e){return parseInt(e.trim())}),a=function(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var n=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=n){var r,i,o,a,c=[],s=!0,l=!1;try{if(o=(n=n.call(e)).next,0===t){if(Object(n)!==n)return;s=!1}else for(;!(s=(r=o.call(n)).done)&&(c.push(r.value),c.length!==t);s=!0);}catch(e){l=!0,i=e}finally{try{if(!s&&null!=n.return&&(a=n.return(),Object(a)!==a))return}finally{if(l)throw i}}return c}}(e,t)||n(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}(o,2),c=a[0],s=a[1];if(e===c||e===s){var l="".concat(c,",").concat(s);i.ccPairValues.has(l)||i.ccPairValues.set(l,{msb:0,lsb:0});var u=i.ccPairValues.get(l);e===c?u.msb=t:e===s&&(u.lsb=t);var d=u.msb<<1|u.lsb>>6&1;i.updateUIElementFromCCPair(r,d)}})}},{key:"updateUIElementFromCCPair",value:function(e,t){var n=e._controlConfig;if(n){var r=t;if(void 0!==n.midi.min&&void 0!==n.midi.max){var i=n.midi.min,o=n.midi.max-i,a=n.min||0,c=(n.max||127)-a,s=(t-i)/o;r=Math.round(a+s*c)}if("INPUT"===e.tagName&&"range"===e.type){e.value=r;var l=e.parentElement.querySelector('input[type="number"]');l&&(l.value=r)}else if(e.classList.contains("knob")){var u=n.min||0,d=(r-u)/((n.max||255)-u)*100/100*270-135;e.style.transform="rotate(".concat(d,"deg)");var f=e.parentElement.querySelector('input[type="number"]');f&&(f.value=r)}window.uiManager&&window.uiManager.updateControlValue(n,r,null,null,!0)}}}],r&&c(e.prototype,r),Object.defineProperty(e,"prototype",{writable:!1}),e;var e,r,o,s}();window.midiManager=new l}},o={};function a(e){var t=o[e];if(void 0!==t)return t.exports;var n=o[e]={exports:{}};return i[e](n,n.exports,a),n.exports}a.m=i,t=Object.getPrototypeOf?e=>Object.getPrototypeOf(e):e=>e.__proto__,a.t=function(n,r){if(1&r&&(n=this(n)),8&r)return n;if("object"==typeof n&&n){if(4&r&&n.__esModule)return n;if(16&r&&"function"==typeof n.then)return n}var i=Object.create(null);a.r(i);var o={};e=e||[null,t({}),t([]),t(t)];for(var c=2&r&&n;("object"==typeof c||"function"==typeof c)&&!~e.indexOf(c);c=t(c))Object.getOwnPropertyNames(c).forEach(e=>o[e]=()=>n[e]);return o.default=()=>n,a.d(i,o),i},a.d=(e,t)=>{for(var n in t)a.o(t,n)&&!a.o(e,n)&&Object.defineProperty(e,n,{enumerable:!0,get:t[n]})},a.f={},a.e=e=>Promise.all(Object.keys(a.f).reduce((t,n)=>(a.f[n](e,t),t),[])),a.u=e=>e+".bundle.js",a.miniCssF=e=>{},a.g=function(){if("object"==typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(e){if("object"==typeof window)return window}}(),a.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),n={},r="arcsynth-editor:",a.l=(e,t,i,o)=>{if(n[e])n[e].push(t);else{var c,s;if(void 0!==i)for(var l=document.getElementsByTagName("script"),u=0;u<l.length;u++){var d=l[u];if(d.getAttribute("src")==e||d.getAttribute("data-webpack")==r+i){c=d;break}}c||(s=!0,(c=document.createElement("script")).charset="utf-8",c.timeout=120,a.nc&&c.setAttribute("nonce",a.nc),c.setAttribute("data-webpack",r+i),c.src=e),n[e]=[t];var f=(t,r)=>{c.onerror=c.onload=null,clearTimeout(m);var i=n[e];if(delete n[e],c.parentNode&&c.parentNode.removeChild(c),i&&i.forEach(e=>e(r)),t)return t(r)},m=setTimeout(f.bind(null,void 0,{type:"timeout",target:c}),12e4);c.onerror=f.bind(null,c.onerror),c.onload=f.bind(null,c.onload),s&&document.head.appendChild(c)}},a.r=e=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},(()=>{var e;a.g.importScripts&&(e=a.g.location+"");var t=a.g.document;if(!e&&t&&(t.currentScript&&"SCRIPT"===t.currentScript.tagName.toUpperCase()&&(e=t.currentScript.src),!e)){var n=t.getElementsByTagName("script");if(n.length)for(var r=n.length-1;r>-1&&(!e||!/^http(s?):/.test(e));)e=n[r--].src}if(!e)throw new Error("Automatic publicPath is not supported in this browser");e=e.replace(/^blob:/,"").replace(/#.*$/,"").replace(/\?.*$/,"").replace(/\/[^\/]+$/,"/"),a.p=e})(),(()=>{var e={792:0};a.f.j=(t,n)=>{var r=a.o(e,t)?e[t]:void 0;if(0!==r)if(r)n.push(r[2]);else{var i=new Promise((n,i)=>r=e[t]=[n,i]);n.push(r[2]=i);var o=a.p+a.u(t),c=new Error;a.l(o,n=>{if(a.o(e,t)&&(0!==(r=e[t])&&(e[t]=void 0),r)){var i=n&&("load"===n.type?"missing":n.type),o=n&&n.target&&n.target.src;c.message="Loading chunk "+t+" failed.\n("+i+": "+o+")",c.name="ChunkLoadError",c.type=i,c.request=o,r[1](c)}},"chunk-"+t,t)}};var t=(t,n)=>{var r,i,[o,c,s]=n,l=0;if(o.some(t=>0!==e[t])){for(r in c)a.o(c,r)&&(a.m[r]=c[r]);s&&s(a)}for(t&&t(n);l<o.length;l++)i=o[l],a.o(e,i)&&e[i]&&e[i][0](),e[i]=0},n=self.webpackChunkarcsynth_editor=self.webpackChunkarcsynth_editor||[];n.forEach(t.bind(null,0)),n.push=t.bind(null,n.push.bind(n))})(),(()=>{"use strict";var e="undefined"!=typeof window&&!window.require;const t={isWeb:e,isElectron:!e,defaultConfigPath:"configs/novation-summit.json",showLoadConfigButton:!e,showFileMenus:!e,autoLoadDefaultConfig:e};function n(e){return n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},n(e)}var r,i,o;function c(){var e,t,n="function"==typeof Symbol?Symbol:{},r=n.iterator||"@@iterator",i=n.toStringTag||"@@toStringTag";function o(n,r,i,o){var c=r&&r.prototype instanceof l?r:l,u=Object.create(c.prototype);return s(u,"_invoke",function(n,r,i){var o,c,s,l=0,u=i||[],d=!1,f={p:0,n:0,v:e,a:m,f:m.bind(e,4),d:function(t,n){return o=t,c=0,s=e,f.n=n,a}};function m(n,r){for(c=n,s=r,t=0;!d&&l&&!i&&t<u.length;t++){var i,o=u[t],m=f.p,v=o[2];n>3?(i=v===r)&&(s=o[(c=o[4])?5:(c=3,3)],o[4]=o[5]=e):o[0]<=m&&((i=n<2&&m<o[1])?(c=0,f.v=r,f.n=o[1]):m<v&&(i=n<3||o[0]>r||r>v)&&(o[4]=n,o[5]=r,f.n=v,c=0))}if(i||n>1)return a;throw d=!0,r}return function(i,u,v){if(l>1)throw TypeError("Generator is already running");for(d&&1===u&&m(u,v),c=u,s=v;(t=c<2?e:s)||!d;){o||(c?c<3?(c>1&&(f.n=-1),m(c,s)):f.n=s:f.v=s);try{if(l=2,o){if(c||(i="next"),t=o[i]){if(!(t=t.call(o,s)))throw TypeError("iterator result is not an object");if(!t.done)return t;s=t.value,c<2&&(c=0)}else 1===c&&(t=o.return)&&t.call(o),c<2&&(s=TypeError("The iterator does not provide a '"+i+"' method"),c=1);o=e}else if((t=(d=f.n<0)?s:n.call(r,f))!==a)break}catch(t){o=e,c=1,s=t}finally{l=1}}return{value:t,done:d}}}(n,i,o),!0),u}var a={};function l(){}function u(){}function d(){}t=Object.getPrototypeOf;var f=[][r]?t(t([][r]())):(s(t={},r,function(){return this}),t),m=d.prototype=l.prototype=Object.create(f);function v(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,d):(e.__proto__=d,s(e,i,"GeneratorFunction")),e.prototype=Object.create(m),e}return u.prototype=d,s(m,"constructor",d),s(d,"constructor",u),u.displayName="GeneratorFunction",s(d,i,"GeneratorFunction"),s(m),s(m,i,"Generator"),s(m,r,function(){return this}),s(m,"toString",function(){return"[object Generator]"}),(c=function(){return{w:o,m:v}})()}function s(e,t,n,r){var i=Object.defineProperty;try{i({},"",{})}catch(e){i=0}s=function(e,t,n,r){function o(t,n){s(e,t,function(e){return this._invoke(t,n,e)})}t?i?i(e,t,{value:n,enumerable:!r,configurable:!r,writable:!r}):e[t]=n:(o("next",0),o("throw",1),o("return",2))},s(e,t,n,r)}function l(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,u(r.key),r)}}function u(e){var t=function(e){if("object"!=n(e)||!e)return e;var t=e[Symbol.toPrimitive];if(void 0!==t){var r=t.call(e,"string");if("object"!=n(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"==n(t)?t:t+""}function d(e,t,n,r,i,o,a){try{var c=e[o](a),s=c.value}catch(e){return void n(e)}c.done?t(s):Promise.resolve(s).then(r,i)}function f(e){return function(){var t=this,n=arguments;return new Promise(function(r,i){var o=e.apply(t,n);function a(e){d(o,r,i,a,c,"next",e)}function c(e){d(o,r,i,a,c,"throw",e)}a(void 0)})}}var m="undefined"!=typeof window&&window.require,v="undefined"!=typeof process&&(null===(r=process.versions)||void 0===r?void 0:r.node);function p(){return h.apply(this,arguments)}function h(){return h=f(c().m(function e(){var t,n;return c().w(function(e){for(;;)switch(e.p=e.n){case 0:if(!v||m){e.n=6;break}return e.p=1,e.n=2,a.e(603).then(a.t.bind(a,603,23));case 2:return t=e.v,e.n=3,a.e(247).then(a.t.bind(a,247,23));case 3:n=e.v,i=t,o=n,e.n=5;break;case 4:e.p=4,e.v;case 5:e.n=7;break;case 6:if(m)try{i=window.require("fs"),o=window.require("path")}catch(e){}case 7:return e.a(2)}},e,null,[[1,4]])})),h.apply(this,arguments)}var y=new(function(){return e=function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.maxLogSize=5242880,this.isMainProcess="undefined"==typeof window,this.initialized=!1,this.initialize()},t=[{key:"initialize",value:(r=f(c().m(function e(){return c().w(function(e){for(;;)switch(e.n){case 0:if(this.initialized){e.n=2;break}return e.n=1,p();case 1:o&&(this.logFilePath=o.join(process.cwd(),"arcsynth-editor.log")),this.initialized=!0;case 2:return e.a(2)}},e,this)})),function(){return r.apply(this,arguments)})},{key:"formatMessage",value:function(e,t){var n=(new Date).toISOString();return"[".concat(n,"] ").concat(e.toUpperCase(),": ").concat(t)}},{key:"writeToFile",value:(n=f(c().m(function e(t){var n;return c().w(function(e){for(;;)switch(e.n){case 0:return e.n=1,this.initialize();case 1:if(i&&this.logFilePath){e.n=2;break}return e.a(2);case 2:try{i.existsSync(this.logFilePath)&&i.statSync(this.logFilePath).size>this.maxLogSize&&(n=this.logFilePath.replace(".log","-".concat(Date.now(),".log")),i.renameSync(this.logFilePath,n)),i.appendFileSync(this.logFilePath,t+"\n","utf8")}catch(e){console.error("Failed to write to log file:",e.message)}case 3:return e.a(2)}},e,this)})),function(e){return n.apply(this,arguments)})},{key:"error",value:function(e){var t=this.formatMessage("error",e);if(console.error(e),this.isMainProcess)this.writeToFile(t);else if(m)try{window.require("electron").ipcRenderer.invoke("log-error",t).catch(function(){})}catch(e){}}},{key:"warn",value:function(e){console.warn(e)}},{key:"info",value:function(e){console.log(e)}},{key:"debug",value:function(e){}}],t&&l(e.prototype,t),Object.defineProperty(e,"prototype",{writable:!1}),e;var e,t,n,r}());const g=y;var b=function(e){return y.error(e)};function w(e){return w="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},w(e)}function C(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var n=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=n){var r,i,o,a,c=[],s=!0,l=!1;try{if(o=(n=n.call(e)).next,0===t){if(Object(n)!==n)return;s=!1}else for(;!(s=(r=o.call(n)).done)&&(c.push(r.value),c.length!==t);s=!0);}catch(e){l=!0,i=e}finally{try{if(!s&&null!=n.return&&(a=n.return(),Object(a)!==a))return}finally{if(l)throw i}}return c}}(e,t)||M(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function E(e,t){var n="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!n){if(Array.isArray(e)||(n=M(e))||t&&e&&"number"==typeof e.length){n&&(e=n);var r=0,i=function(){};return{s:i,n:function(){return r>=e.length?{done:!0}:{done:!1,value:e[r++]}},e:function(e){throw e},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var o,a=!0,c=!1;return{s:function(){n=n.call(e)},n:function(){var e=n.next();return a=e.done,e},e:function(e){c=!0,o=e},f:function(){try{a||null==n.return||n.return()}finally{if(c)throw o}}}}function M(e,t){if(e){if("string"==typeof e)return S(e,t);var n={}.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?S(e,t):void 0}}function S(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=Array(t);n<t;n++)r[n]=e[n];return r}function I(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,x(r.key),r)}}function x(e){var t=function(e){if("object"!=w(e)||!e)return e;var t=e[Symbol.toPrimitive];if(void 0!==t){var n=t.call(e,"string");if("object"!=w(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"==w(t)?t:t+""}a(938),a(501);var k=function(){return e=function e(t){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.synthEditor=t,this.baselineSysEx=null,this.currentTestSysEx=null,this.parameterList=[],this.currentParameterIndex=0,this.mappingResults={},this.currentParameterResults=[],this.isAutoRunning=!1,this.autoRunTimeout=null,this.dumpMappingData=null,this.convertedParameters=null,this.sysexListener=null,this.dumpListener=null},t=[{key:"setupDumpReceiver",value:function(){var e=this,t=document.getElementById("get-dump"),n=document.getElementById("start-dump-receiver"),r=document.getElementById("stop-dump-receiver"),i=document.getElementById("apply-dump-values");this.checkDumpMappingAvailability(),t.addEventListener("click",function(){e.getDumpFromSynth()}),n.addEventListener("click",function(){e.dumpMappingData?e.startDumpReceiving():e.synthEditor.notificationManager.error("No SysEx mapping data found. Create mapping first in SysEx Mapper tab.")}),r.addEventListener("click",function(){e.stopDumpReceiving()}),i.addEventListener("click",function(){e.applyConvertedValues()})}},{key:"checkDumpMappingAvailability",value:function(){var e=document.getElementById("dump-mapping-status");if(!window.uiManager.currentConfig)return e.textContent="No synthesizer configuration loaded.",void(e.className="status-message error");this.dumpMappingData=this.extractSysExMappingFromConfig(),this.dumpMappingData&&Object.keys(this.dumpMappingData).length>0?(e.textContent="✓ Found SysEx mapping in config: ".concat(Object.keys(this.dumpMappingData).length," parameters"),e.className="status-message success"):(this.dumpMappingData=null,e.textContent="No SysEx mapping found in config. Use SysEx Mapper to create mapping.",e.className="status-message warning")}},{key:"extractSysExMappingFromConfig",value:function(){var e=window.uiManager.currentConfig;if(!e)return{};var t,n={},r=E(e.tabs||[]);try{for(r.s();!(t=r.n()).done;){var i,o=E(t.value.sections||[]);try{for(o.s();!(i=o.n()).done;){var a=i.value;this.extractSysExFromSection(a,n)}}catch(e){o.e(e)}finally{o.f()}}}catch(e){r.e(e)}finally{r.f()}return n}},{key:"extractSysExFromSection",value:function(e,t){var n,r=E(e.controls||[]);try{for(r.s();!(n=r.n()).done;){var i=n.value;i.sysEx&&i.id&&(t[i.id]=i.sysEx)}}catch(e){r.e(e)}finally{r.f()}if(e.template){var o,a=E(this.expandTemplate(e.template));try{for(a.s();!(o=a.n()).done;){var c=o.value;c.sysEx&&c.id&&(t[c.id]=c.sysEx)}}catch(e){a.e(e)}finally{a.f()}}var s,l=E(e.subsections||[]);try{for(l.s();!(s=l.n()).done;){var u=s.value;this.extractSysExFromSection(u,t)}}catch(e){l.e(e)}finally{l.f()}}},{key:"startDumpReceiving",value:function(){var e=this;if(window.midiManager.inputDevice){var t=document.getElementById("start-dump-receiver"),n=document.getElementById("stop-dump-receiver"),r=document.getElementById("dump-conversion-status");t.style.display="none",n.style.display="inline-block",r.textContent="Listening for SysEx dumps...",r.className="status-message info",this.dumpListener=function(t){if(t.data&&t.data.length>2&&240===t.data[0]&&247===t.data[t.data.length-1]){var n=Array.from(t.data).map(function(e){return e.toString(16).toUpperCase().padStart(2,"0")}).join(" ");e.processDumpData(n)}},window.midiManager.inputDevice.addEventListener("midimessage",this.dumpListener)}else this.synthEditor.notificationManager.error("No MIDI input device connected.")}},{key:"stopDumpReceiving",value:function(){document.getElementById("start-dump-receiver").style.display="inline-block",document.getElementById("stop-dump-receiver").style.display="none",window.midiManager.inputDevice&&this.dumpListener&&(window.midiManager.inputDevice.removeEventListener("midimessage",this.dumpListener),this.dumpListener=null)}},{key:"processDumpData",value:function(e){document.getElementById("received-dump").value=e;var t=document.getElementById("dump-conversion-status");try{this.convertedParameters=this.convertDumpToParameters(e),this.displayConvertedParameters(),t.textContent="✓ Dump converted: ".concat(Object.keys(this.convertedParameters).length," parameters found"),t.className="status-message success",document.getElementById("apply-dump-values").disabled=!1}catch(e){t.textContent="Conversion failed: ".concat(e.message),t.className="status-message error",console.error("Dump conversion error:",e)}}},{key:"convertDumpToParameters",value:function(e){if(!this.dumpMappingData)throw new Error("No mapping data available");for(var t=e.split(" "),n={},r=0,i=Object.entries(this.dumpMappingData);r<i.length;r++){var o=C(i[r],2),a=o[0],c=o[1];try{var s=this.extractParameterValue(t,c);if(null!==s){var l=this.findParameterInConfig(a),u=this.convertRawToControlValue(s,c,l);n[a]={name:(null==l?void 0:l.name)||a,rawValue:s,controlValue:u,mappingInfo:c,paramConfig:l}}}catch(e){console.warn("Failed to extract parameter ".concat(a,":"),e)}}return n}},{key:"extractParameterValue",value:function(e,t){var n=t.type,r=t.offsets;if(!r||!Array.isArray(r)||0===r.length)return null;if("standard-7bit"===n||"select-7bit"===n||"toggle-7bit"===n||"range-7bit"===n){var i=r[0];if(i>=0&&i<e.length)return parseInt(e[i],16)}if("precision-7bit"===n&&r.length>=2){var o=r[0],a=r[1];if(o>=0&&o<e.length&&a>=0&&a<e.length)return{msb:parseInt(e[o],16),lsb:parseInt(e[a],16)}}if("text-16"===n&&r.length>=16){for(var c=[],s=0;s<16;s++){var l=r[s];if(!(l>=0&&l<e.length))return null;var u=parseInt(e[l],16);c.push(u)}return c}return null}},{key:"convertRawToControlValue",value:function(e,t,n){var r=null==n?void 0:n.type;if("select-7bit"===t.type){if("select"===r&&null!=n&&n.midiValues&&null!=n&&n.options){var i=n.midiValues,o=i.indexOf(e);return o>=0&&o<n.options.length?e:(console.warn("select-7bit: raw value ".concat(e," not found in midiValues for ").concat(n.id||"unknown")),i[0]||0)}return e}if("standard-7bit"===t.type){var a,c,s=null!==(a=null==n?void 0:n.min)&&void 0!==a?a:0,l=null!==(c=null==n?void 0:n.max)&&void 0!==c?c:127;return 0===s&&127===l?e:128==l-s+1?Math.round(e/127*(l-s)+s):e}if("toggle-7bit"===t.type)return"button"===r&&void 0!==(null==n?void 0:n.onValue)&&void 0!==(null==n?void 0:n.offValue)?e===n.onValue?1:(e===n.offValue||console.warn("toggle-7bit: raw value ".concat(e," doesn't match onValue (").concat(n.onValue,") or offValue (").concat(n.offValue,") for ").concat(n.id||"unknown")),0):127===e?1:0;if("range-7bit"===t.type){var u,d,f,m,v=null!==(u=null==n?void 0:n.min)&&void 0!==u?u:0,p=null!==(d=null==n?void 0:n.max)&&void 0!==d?d:127;if(void 0!==(null==n||null===(f=n.midi)||void 0===f?void 0:f.min)&&void 0!==(null==n||null===(m=n.midi)||void 0===m?void 0:m.max)){var h=n.midi.min,y=n.midi.max-h,g=p-v;if(0===y)return console.warn("range-7bit: MIDI range is zero for ".concat(n.id||"unknown")),v;var b=(e-h)/y*g+v;return Math.round(100*b)/100}return e}if("precision-7bit"===t.type){var C;if(e&&"object"===w(e)&&void 0!==e.msb&&void 0!==e.lsb){var E,M,S,I,x=e.msb,k=e.lsb,P=null!==(E=null==n?void 0:n.min)&&void 0!==E?E:0,D=null!==(M=null==n?void 0:n.max)&&void 0!==M?M:127,A=null==n||null===(S=n.midi)||void 0===S?void 0:S.min,T=null==n||null===(I=n.midi)||void 0===I?void 0:I.max;if(void 0!==A&&void 0!==T){var N=P+(2*x+(64===k?1:0)-A)/(T-A)*(D-P);return Math.max(P,Math.min(D,N))}var V,L=null!==(V=null==n?void 0:n.step)&&void 0!==V?V:1,j=P+(2*x+(64===k?1:0))*L,O=Math.max(P,Math.min(D,j)),B=L<1?Math.max(0,-Math.floor(Math.log10(L))):0;return Math.round(O*Math.pow(10,B))/Math.pow(10,B)}return null!==(C=null==n?void 0:n.min)&&void 0!==C?C:0}if("text-16"===t.type){if(Array.isArray(e)&&e.length>=16){for(var _="",F=0;F<16;F++){var q=e[F];_+=q>=32&&q<=126?String.fromCharCode(q):" "}return _.trimEnd()}return"Unknown"}return e}},{key:"generatePatchDump",value:function(){var e=window.uiManager.currentConfig;if(!e)throw new Error("No configuration loaded");if(!e.initPatch)return console.warn("No initPatch template available for SysEx dump generation"),null;var t=this.parseHexTemplate(e.initPatch);return this.populateParameterValues(t),t}},{key:"parseHexTemplate",value:function(e){return e.trim().split(/\s+/).map(function(e){return parseInt(e,16)})}},{key:"populateParameterValues",value:function(e){var t,n=E(window.uiManager.currentConfig.tabs||[]);try{for(n.s();!(t=n.n()).done;){var r,i=E(t.value.sections||[]);try{for(i.s();!(r=i.n()).done;){var o=r.value;this.populateFromSection(o,e)}}catch(e){i.e(e)}finally{i.f()}}}catch(e){n.e(e)}finally{n.f()}}},{key:"populateFromSection",value:function(e,t){var n=0;if(e.controls){var r,i=E(e.controls);try{for(i.s();!(r=i.n()).done;){var o=r.value;n++,o.sysEx&&this.populateControlValue(o,t)}}catch(e){i.e(e)}finally{i.f()}}if(e.subsections){var a,c=E(e.subsections);try{for(c.s();!(a=c.n()).done;){var s=a.value;if(s.controls){var l,u=E(s.controls);try{for(u.s();!(l=u.n()).done;){var d=l.value;n++,d.sysEx&&this.populateControlValue(d,t)}}catch(e){u.e(e)}finally{u.f()}}}}catch(e){c.e(e)}finally{c.f()}}return n}},{key:"populateControlValue",value:function(e,t){if(e.sysEx&&e.sysEx.offsets&&e.id){var n=window.uiManager.controlValues.get(e.id);if(void 0===n&&(n=e.default),void 0!==n){var r=e.sysEx.type,i=e.sysEx.offsets;try{this.writeValueToSysEx(n,r,i,e,t)}catch(t){console.warn("✗ Failed to write ".concat(e.id," to SysEx:"),t)}}else console.warn("No value available for control ".concat(e.id,", leaving SysEx bytes as 0x00"))}}},{key:"writeValueToSysEx",value:function(e,t,n,r,i){switch(t){case"standard-7bit":case"select-7bit":case"toggle-7bit":case"range-7bit":if(n.length>0){var o=this.convertControlToRawValue(e,t,r);i[n[0]]=Math.max(0,Math.min(127,o))}break;case"precision-7bit":if(n.length>=2){var a=this.convertControlToPrecisionBytes(e,r),c=a.msb,s=a.lsb;i[n[0]]=c,i[n[1]]=s}break;case"text-16":if(n.length>=16)for(var l=this.convertControlToTextBytes(e),u=0;u<16;u++)i[n[u]]=l[u];break;default:console.warn("Unknown SysEx type: ".concat(t))}}},{key:"convertControlToRawValue",value:function(e,t,n){if("select-7bit"===t)return e;var r,i,o,a;if("toggle-7bit"===t)return 1===e?null!==(r=n.onValue)&&void 0!==r?r:127:null!==(i=n.offValue)&&void 0!==i?i:0;if("range-7bit"===t&&void 0!==(null===(o=n.midi)||void 0===o?void 0:o.min)&&void 0!==(null===(a=n.midi)||void 0===a?void 0:a.max)){var c,s,l=null!==(c=n.min)&&void 0!==c?c:0,u=null!==(s=n.max)&&void 0!==s?s:127,d=n.midi.min,f=n.midi.max,m=(e-l)/(u-l);return Math.round(d+m*(f-d))}if("standard-7bit"===t){var v,p,h=null!==(v=null==n?void 0:n.min)&&void 0!==v?v:0,y=null!==(p=null==n?void 0:n.max)&&void 0!==p?p:127;return 0===h&&127===y?Math.round(e):128==y-h+1?Math.round((e-h)/(y-h)*127):Math.round(e)}return Math.round(e)}},{key:"convertControlToPrecisionBytes",value:function(e,t){var n,r,i,o,a,c=null!==(n=t.min)&&void 0!==n?n:0,s=null!==(r=t.max)&&void 0!==r?r:127,l=null==t||null===(i=t.midi)||void 0===i?void 0:i.min,u=null==t||null===(o=t.midi)||void 0===o?void 0:o.max;if(void 0!==l&&void 0!==u){var d=u-l,f=(e-c)/(s-c);a=Math.round(l+f*d)}else{var m,v=null!==(m=t.step)&&void 0!==m?m:1;a=Math.round((e-c)/v)}var p=Math.floor(a/2),h=a%2==1?64:0;return{msb:Math.max(0,Math.min(127,p)),lsb:h}}},{key:"convertControlToTextBytes",value:function(e){for(var t=String(e||"").substring(0,16),n=new Array(16).fill(32),r=0;r<t.length;r++){var i=t.charCodeAt(r);n[r]=i>=32&&i<=126?i:32}return n}},{key:"displayConvertedParameters",value:function(){var e=document.getElementById("converted-params"),t=document.getElementById("param-list");if(this.convertedParameters&&0!==Object.keys(this.convertedParameters).length){for(var n="",r=0,i=Object.entries(this.convertedParameters);r<i.length;r++){var o,a=C(i[r],2)[1];o=Array.isArray(a.rawValue)?"[".concat(a.rawValue.join(", "),"]"):"object"===w(a.rawValue)&&null!==a.rawValue?"{".concat(Object.entries(a.rawValue).map(function(e){var t=C(e,2),n=t[0],r=t[1];return"".concat(n,":").concat(r)}).join(", "),"}"):a.rawValue,n+='<div style="margin-bottom: 0.5rem; padding: 0.25rem; border-left: 3px solid #4a90e2; background: rgba(74, 144, 226, 0.05);">\n                <strong>'.concat(a.name,"</strong>: ").concat(a.controlValue,'\n                <span style="color: #888; font-size: 0.8rem;"> (raw: ').concat(o,")</span>\n            </div>")}t.innerHTML=n,e.style.display="block"}else e.style.display="none"}},{key:"applyConvertedValuesToUI",value:function(){if(this.convertedParameters)if(window.uiManager&&window.uiManager.currentConfig){for(var e=0,t=0,n=0,r=Object.entries(this.convertedParameters);n<r.length;n++){var i=C(r[n],2),o=i[0],a=i[1],c=this.findControlConfig(o);c?(window.uiManager.controlValues.set(o,a.controlValue),window.uiManager.updateSingleUIElement(c),e++):t++}e>0&&this.synthEditor.notificationManager.success("Applied ".concat(e," parameter values to editor controls.")),t>0&&console.warn("".concat(t," parameters not found in current configuration."))}else this.synthEditor.notificationManager.error("No synthesizer configuration loaded.");else this.synthEditor.notificationManager.warning("No converted parameters to apply.")}},{key:"applyConvertedValues",value:function(){if(this.convertedParameters)if(window.uiManager&&window.uiManager.currentConfig)if(window.midiManager.isConnected){this.applyConvertedValuesToUI();var e=Object.keys(this.convertedParameters).length;e>0&&(this.synthEditor.notificationManager.info("Sending ".concat(e," parameter values to synthesizer...")),window.uiManager.sendAllParameters())}else this.synthEditor.notificationManager.info("No MIDI device connected. Please connect a MIDI device first.");else this.synthEditor.notificationManager.error("No synthesizer configuration loaded.");else this.synthEditor.notificationManager.warning("No converted parameters to apply.")}},{key:"getDumpFromSynth",value:function(){var e,t,n,r=this;if(window.midiManager.isConnected)if(null!==(e=window.uiManager)&&void 0!==e&&e.currentConfig){var i=window.uiManager.currentConfig;null!==(t=i.patchDumpRequest)&&void 0!==t&&t.type&&null!==(n=i.patchDumpRequest)&&void 0!==n&&n.data?(this.synthEditor.notificationManager.info("Requesting patch dump from synthesizer..."),this.requestPatchDump()?this.listenForSysEx(function(e){r.synthEditor.notificationManager.success("Patch dump received!"),r.processDumpData(e),r.convertedParameters&&Object.keys(r.convertedParameters).length>0&&r.applyConvertedValuesToUI()}):this.synthEditor.notificationManager.info("Failed to send patch dump request. Please check your MIDI connection.","error")):this.synthEditor.notificationManager.info("This synthesizer configuration does not support automatic patch dump requests.")}else this.synthEditor.notificationManager.warning("No synthesizer configuration loaded.");else this.synthEditor.notificationManager.info("No MIDI device connected. Please connect a MIDI device first.")}},{key:"findParameterInConfig",value:function(e){var t,n,r=E((null===(t=window.uiManager.currentConfig)||void 0===t?void 0:t.tabs)||[]);try{for(r.s();!(n=r.n()).done;){var i,o=E(n.value.sections||[]);try{for(o.s();!(i=o.n()).done;){var a=i.value,c=this.findParameterInSection(a,e);if(c)return c}}catch(e){o.e(e)}finally{o.f()}}}catch(e){r.e(e)}finally{r.f()}return null}},{key:"findParameterInSection",value:function(e,t){var n,r,i=E(e.controls||[]);try{for(i.s();!(r=i.n()).done;){var o=r.value;if(o.id===t)return o}}catch(e){i.e(e)}finally{i.f()}if(e.template&&null!==(n=window.uiManager)&&void 0!==n&&n.expandTemplate){var a,c=E(window.uiManager.expandTemplate(e.template));try{for(c.s();!(a=c.n()).done;){var s=a.value;if(s.id===t)return s}}catch(e){c.e(e)}finally{c.f()}}var l,u=E(e.subsections||[]);try{for(u.s();!(l=u.n()).done;){var d=l.value,f=this.findParameterInSection(d,t);if(f)return f}}catch(e){u.e(e)}finally{u.f()}return null}},{key:"findControlConfig",value:function(e){var t,n,r=E((null===(t=window.uiManager.currentConfig)||void 0===t?void 0:t.tabs)||[]);try{for(r.s();!(n=r.n()).done;){var i,o=E(n.value.sections||[]);try{for(o.s();!(i=o.n()).done;){var a=i.value,c=this.findControlInSection(a,e);if(c)return c}}catch(e){o.e(e)}finally{o.f()}}}catch(e){r.e(e)}finally{r.f()}return null}},{key:"findControlInSection",value:function(e,t){var n,r=E(e.controls||[]);try{for(r.s();!(n=r.n()).done;){var i=n.value;if(i.id===t)return i}}catch(e){r.e(e)}finally{r.f()}if(e.template){var o,a=E(this.expandTemplate(e.template));try{for(a.s();!(o=a.n()).done;){var c=o.value;if(c.id===t)return c}}catch(e){a.e(e)}finally{a.f()}}var s,l=E(e.subsections||[]);try{for(l.s();!(s=l.n()).done;){var u=s.value,d=this.findControlInSection(u,t);if(d)return d}}catch(e){l.e(e)}finally{l.f()}return null}},{key:"requestPatchDump",value:function(){var e,t,n=null===(e=window.uiManager)||void 0===e?void 0:e.currentConfig;if("sysex"===(null==n||null===(t=n.patchDumpRequest)||void 0===t?void 0:t.type)&&window.midiManager.isConnected){var r=n.patchDumpRequest.data.split(" ").map(function(e){return parseInt(e,16)});return window.midiManager.sendSysEx(r),!0}return!1}},{key:"listenForSysEx",value:function(e){var t=this;this.stopListening(),this.sysexListener=function(n){if(n.data&&240===n.data[0]&&247===n.data[n.data.length-1]){var r=Array.from(n.data).map(function(e){return e.toString(16).toUpperCase().padStart(2,"0")}).join(" ");e(r),t.stopListening()}},window.midiManager.inputDevice&&window.midiManager.inputDevice.addEventListener("midimessage",this.sysexListener)}},{key:"stopListening",value:function(){window.midiManager.inputDevice&&this.sysexListener&&(window.midiManager.inputDevice.removeEventListener("midimessage",this.sysexListener),this.sysexListener=null)}}],t&&I(e.prototype,t),Object.defineProperty(e,"prototype",{writable:!1}),e;var e,t}();const P=k;function D(e){return D="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},D(e)}function A(){var e,t,n="function"==typeof Symbol?Symbol:{},r=n.iterator||"@@iterator",i=n.toStringTag||"@@toStringTag";function o(n,r,i,o){var s=r&&r.prototype instanceof c?r:c,l=Object.create(s.prototype);return T(l,"_invoke",function(n,r,i){var o,c,s,l=0,u=i||[],d=!1,f={p:0,n:0,v:e,a:m,f:m.bind(e,4),d:function(t,n){return o=t,c=0,s=e,f.n=n,a}};function m(n,r){for(c=n,s=r,t=0;!d&&l&&!i&&t<u.length;t++){var i,o=u[t],m=f.p,v=o[2];n>3?(i=v===r)&&(s=o[(c=o[4])?5:(c=3,3)],o[4]=o[5]=e):o[0]<=m&&((i=n<2&&m<o[1])?(c=0,f.v=r,f.n=o[1]):m<v&&(i=n<3||o[0]>r||r>v)&&(o[4]=n,o[5]=r,f.n=v,c=0))}if(i||n>1)return a;throw d=!0,r}return function(i,u,v){if(l>1)throw TypeError("Generator is already running");for(d&&1===u&&m(u,v),c=u,s=v;(t=c<2?e:s)||!d;){o||(c?c<3?(c>1&&(f.n=-1),m(c,s)):f.n=s:f.v=s);try{if(l=2,o){if(c||(i="next"),t=o[i]){if(!(t=t.call(o,s)))throw TypeError("iterator result is not an object");if(!t.done)return t;s=t.value,c<2&&(c=0)}else 1===c&&(t=o.return)&&t.call(o),c<2&&(s=TypeError("The iterator does not provide a '"+i+"' method"),c=1);o=e}else if((t=(d=f.n<0)?s:n.call(r,f))!==a)break}catch(t){o=e,c=1,s=t}finally{l=1}}return{value:t,done:d}}}(n,i,o),!0),l}var a={};function c(){}function s(){}function l(){}t=Object.getPrototypeOf;var u=[][r]?t(t([][r]())):(T(t={},r,function(){return this}),t),d=l.prototype=c.prototype=Object.create(u);function f(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,l):(e.__proto__=l,T(e,i,"GeneratorFunction")),e.prototype=Object.create(d),e}return s.prototype=l,T(d,"constructor",l),T(l,"constructor",s),s.displayName="GeneratorFunction",T(l,i,"GeneratorFunction"),T(d),T(d,i,"Generator"),T(d,r,function(){return this}),T(d,"toString",function(){return"[object Generator]"}),(A=function(){return{w:o,m:f}})()}function T(e,t,n,r){var i=Object.defineProperty;try{i({},"",{})}catch(e){i=0}T=function(e,t,n,r){function o(t,n){T(e,t,function(e){return this._invoke(t,n,e)})}t?i?i(e,t,{value:n,enumerable:!r,configurable:!r,writable:!r}):e[t]=n:(o("next",0),o("throw",1),o("return",2))},T(e,t,n,r)}function N(e,t,n,r,i,o,a){try{var c=e[o](a),s=c.value}catch(e){return void n(e)}c.done?t(s):Promise.resolve(s).then(r,i)}function V(e){return function(){var t=this,n=arguments;return new Promise(function(r,i){var o=e.apply(t,n);function a(e){N(o,r,i,a,c,"next",e)}function c(e){N(o,r,i,a,c,"throw",e)}a(void 0)})}}function L(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,j(r.key),r)}}function j(e){var t=function(e){if("object"!=D(e)||!e)return e;var t=e[Symbol.toPrimitive];if(void 0!==t){var n=t.call(e,"string");if("object"!=D(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"==D(t)?t:t+""}var O,B,_,F="undefined"!=typeof window&&window.require,q="undefined"!=typeof window&&!window.require;!function(){if(F)try{O=window.require("fs"),B=window.require("path");var e=window.require("electron");_=e.ipcRenderer}catch(e){console.warn("Node integration not available in Electron renderer")}}();var U=function(){return e=function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.userConfigPath=B?B.join(process.cwd(),"user-config.json"):"user-config",this.userConfig=this.loadUserConfig()},t=[{key:"getConfigsPath",value:function(){return q?"configs":process.resourcesPath?B.join(process.resourcesPath,"configs"):B.join(process.cwd(),"configs")}},{key:"loadUserConfig",value:function(){try{if(O&&O.existsSync&&O.existsSync(this.userConfigPath))return JSON.parse(O.readFileSync(this.userConfigPath,"utf8"));if(q){var e=localStorage.getItem(this.userConfigPath);if(e)return JSON.parse(e)}}catch(e){b("Error loading user config: "+e.message)}return{lastMidiOutput:null,lastMidiInput:null,lastConfigFile:null,lastPatchFolder:null,midiChannel:1}}},{key:"saveUserConfig",value:function(){try{O&&O.writeFileSync?O.writeFileSync(this.userConfigPath,JSON.stringify(this.userConfig,null,2)):q&&localStorage.setItem(this.userConfigPath,JSON.stringify(this.userConfig))}catch(e){b("Error saving user config: "+e.message)}}},{key:"saveUserSetting",value:function(e,t){this.userConfig[e]=t,this.saveUserConfig()}},{key:"loadConfigFile",value:(i=V(A().m(function e(){var t,n,r,i,o,a;return A().w(function(e){for(;;)switch(e.p=e.n){case 0:if(!q){e.n=1;break}return e.a(2,this.loadConfigFileBrowser());case 1:e.p=1,t={title:"Load Synthesizer Configuration",filters:[{name:"JSON Configs",extensions:["json"]}],properties:["openFile"]};try{this.userConfig.lastConfigFile&&"string"==typeof this.userConfig.lastConfigFile?(n=B.dirname(this.userConfig.lastConfigFile))&&"string"==typeof n&&O.existsSync(n)&&(t.defaultPath=n):(r=this.getConfigsPath())&&"string"==typeof r&&O.existsSync(r)&&(t.defaultPath=r)}catch(e){b("Error setting default path for config dialog: "+e.message)}return e.n=2,_.invoke("show-open-dialog",t);case 2:if(!(i=e.v)){e.n=3;break}return o=JSON.parse(O.readFileSync(i,"utf8")),this.userConfig.lastConfigFile=i,this.saveUserConfig(),e.a(2,{config:o,filePath:i});case 3:return e.a(2,null);case 4:throw e.p=4,a=e.v,b("Error in loadConfigFile: "+a.message+" | Stack: "+a.stack),new Error("Error loading configuration: "+a.message);case 5:return e.a(2)}},e,this,[[1,4]])})),function(){return i.apply(this,arguments)})},{key:"loadConfigFileBrowser",value:function(){var e=this;return new Promise(function(t){var n=document.createElement("input");n.type="file",n.accept=".json",n.onchange=function(){var n=V(A().m(function n(r){var i,o,a,c;return A().w(function(n){for(;;)switch(n.p=n.n){case 0:if(!(i=r.target.files[0])){n.n=5;break}return n.p=1,n.n=2,i.text();case 2:o=n.v,a=JSON.parse(o),e.userConfig.lastConfigFile=i.name,e.saveUserConfig(),t({config:a,filePath:i.name}),n.n=4;break;case 3:n.p=3,c=n.v,b("Error parsing config file: "+c.message),t(null);case 4:n.n=6;break;case 5:t(null);case 6:return n.a(2)}},n,null,[[1,3]])}));return function(e){return n.apply(this,arguments)}}(),n.click()})}},{key:"loadConfigFromPath",value:(r=V(A().m(function e(t){var n,r,i,o;return A().w(function(e){for(;;)switch(e.p=e.n){case 0:if(e.p=0,!O||!O.readFileSync){e.n=1;break}return n=JSON.parse(O.readFileSync(t,"utf8")),e.a(2,n);case 1:if(!q){e.n=4;break}return e.n=2,fetch(t);case 2:if(!(r=e.v).ok){e.n=4;break}return e.n=3,r.json();case 3:return i=e.v,e.a(2,i);case 4:e.n=6;break;case 5:return e.p=5,o=e.v,b("Error auto-loading config: "+o.message),e.a(2,null);case 6:return e.a(2,null)}},e,null,[[0,5]])})),function(e){return r.apply(this,arguments)})},{key:"getAvailableConfigs",value:(n=V(A().m(function e(){var t,n,r;return A().w(function(e){for(;;)switch(e.p=e.n){case 0:if(e.p=0,t=this.getConfigsPath(),!(O&&O.existsSync&&O.readdirSync)){e.n=2;break}if(O.existsSync(t)){e.n=1;break}return e.a(2,[]);case 1:return n=O.readdirSync(t),e.a(2,n.filter(function(e){return e.endsWith(".json")}).map(function(e){return{name:e,path:B.join(t,e)}}));case 2:if(!q){e.n=3;break}return e.a(2,[{name:"example-synth.json",path:"configs/example-synth.json"},{name:"novation-summit.json",path:"configs/novation-summit.json"}]);case 3:return e.a(2,[]);case 4:return e.p=4,r=e.v,b("Error listing configs: "+r.message),e.a(2,[])}},e,this,[[0,4]])})),function(){return n.apply(this,arguments)})},{key:"validateConfig",value:function(e){if(!e||"object"!==D(e))throw new Error("Invalid configuration format");if(!e.name)throw new Error('Configuration missing required "name" field');if(!e.tabs||!Array.isArray(e.tabs))throw new Error('Configuration missing required "tabs" array');return!0}}],t&&L(e.prototype,t),Object.defineProperty(e,"prototype",{writable:!1}),e;var e,t,n,r,i}();const R=U;function H(e){return H="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},H(e)}function z(){var e,t,n="function"==typeof Symbol?Symbol:{},r=n.iterator||"@@iterator",i=n.toStringTag||"@@toStringTag";function o(n,r,i,o){var s=r&&r.prototype instanceof c?r:c,l=Object.create(s.prototype);return G(l,"_invoke",function(n,r,i){var o,c,s,l=0,u=i||[],d=!1,f={p:0,n:0,v:e,a:m,f:m.bind(e,4),d:function(t,n){return o=t,c=0,s=e,f.n=n,a}};function m(n,r){for(c=n,s=r,t=0;!d&&l&&!i&&t<u.length;t++){var i,o=u[t],m=f.p,v=o[2];n>3?(i=v===r)&&(s=o[(c=o[4])?5:(c=3,3)],o[4]=o[5]=e):o[0]<=m&&((i=n<2&&m<o[1])?(c=0,f.v=r,f.n=o[1]):m<v&&(i=n<3||o[0]>r||r>v)&&(o[4]=n,o[5]=r,f.n=v,c=0))}if(i||n>1)return a;throw d=!0,r}return function(i,u,v){if(l>1)throw TypeError("Generator is already running");for(d&&1===u&&m(u,v),c=u,s=v;(t=c<2?e:s)||!d;){o||(c?c<3?(c>1&&(f.n=-1),m(c,s)):f.n=s:f.v=s);try{if(l=2,o){if(c||(i="next"),t=o[i]){if(!(t=t.call(o,s)))throw TypeError("iterator result is not an object");if(!t.done)return t;s=t.value,c<2&&(c=0)}else 1===c&&(t=o.return)&&t.call(o),c<2&&(s=TypeError("The iterator does not provide a '"+i+"' method"),c=1);o=e}else if((t=(d=f.n<0)?s:n.call(r,f))!==a)break}catch(t){o=e,c=1,s=t}finally{l=1}}return{value:t,done:d}}}(n,i,o),!0),l}var a={};function c(){}function s(){}function l(){}t=Object.getPrototypeOf;var u=[][r]?t(t([][r]())):(G(t={},r,function(){return this}),t),d=l.prototype=c.prototype=Object.create(u);function f(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,l):(e.__proto__=l,G(e,i,"GeneratorFunction")),e.prototype=Object.create(d),e}return s.prototype=l,G(d,"constructor",l),G(l,"constructor",s),s.displayName="GeneratorFunction",G(l,i,"GeneratorFunction"),G(d),G(d,i,"Generator"),G(d,r,function(){return this}),G(d,"toString",function(){return"[object Generator]"}),(z=function(){return{w:o,m:f}})()}function G(e,t,n,r){var i=Object.defineProperty;try{i({},"",{})}catch(e){i=0}G=function(e,t,n,r){function o(t,n){G(e,t,function(e){return this._invoke(t,n,e)})}t?i?i(e,t,{value:n,enumerable:!r,configurable:!r,writable:!r}):e[t]=n:(o("next",0),o("throw",1),o("return",2))},G(e,t,n,r)}function W(e,t,n,r,i,o,a){try{var c=e[o](a),s=c.value}catch(e){return void n(e)}c.done?t(s):Promise.resolve(s).then(r,i)}function J(e){return function(){var t=this,n=arguments;return new Promise(function(r,i){var o=e.apply(t,n);function a(e){W(o,r,i,a,c,"next",e)}function c(e){W(o,r,i,a,c,"throw",e)}a(void 0)})}}function $(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,K(r.key),r)}}function K(e){var t=function(e){if("object"!=H(e)||!e)return e;var t=e[Symbol.toPrimitive];if(void 0!==t){var n=t.call(e,"string");if("object"!=H(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"==H(t)?t:t+""}var Y,X,Q,Z="undefined"!=typeof window&&window.require;!function(){if(Z)try{Y=window.require("fs"),X=window.require("path");var e=window.require("electron");Q=e.ipcRenderer}catch(e){console.warn("Node integration not available in Electron renderer")}}();const ee=function(){return e=function e(t){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.configManager=t},t=[{key:"exportPatch",value:(r=J(z().m(function e(){var t,n,r,i,o,a,c;return z().w(function(e){for(;;)switch(e.n){case 0:if(null!==(t=window.uiManager)&&void 0!==t&&t.currentConfig){e.n=1;break}throw new Error("No synthesizer configuration loaded.");case 1:if(n={version:"1.0",synthesizer:{name:window.uiManager.currentConfig.name,manufacturer:window.uiManager.currentConfig.manufacturer},parameters:window.uiManager.getAllControlValues()},r=window.uiManager.currentConfig.name||"patch",n.parameters.patch_name&&"string"==typeof n.parameters.patch_name&&(r=n.parameters.patch_name.trim()),r=r.replace(/[^a-z0-9\s]/gi,"_").toLowerCase(),!window.AppConfig.isWeb){e.n=2;break}return i=new Blob([JSON.stringify(n,null,2)],{type:"application/json"}),o=URL.createObjectURL(i),(a=document.createElement("a")).href=o,a.download="".concat(r,".patch.json"),document.body.appendChild(a),a.click(),document.body.removeChild(a),URL.revokeObjectURL(o),e.a(2,{success:!0,patchName:r});case 2:return e.n=3,Q.invoke("show-save-dialog",{title:"Export Patch",defaultPath:this.configManager.userConfig.lastPatchFolder?X.join(this.configManager.userConfig.lastPatchFolder,"".concat(r,".patch.json")):"".concat(r,".patch.json"),filters:[{name:"Patch Files",extensions:["patch.json","json"]}]});case 3:if(!(c=e.v)){e.n=4;break}return Y.writeFileSync(c,JSON.stringify(n,null,2)),this.configManager.userConfig.lastPatchFolder=X.dirname(c),this.configManager.saveUserConfig(),e.a(2,{success:!0,patchName:r});case 4:return e.a(2,{success:!1});case 5:return e.a(2)}},e,this)})),function(){return r.apply(this,arguments)})},{key:"importPatch",value:(n=J(z().m(function e(){var t,n,r,i,o,a;return z().w(function(e){for(;;)switch(e.n){case 0:if(null!==(t=window.uiManager)&&void 0!==t&&t.currentConfig){e.n=1;break}throw new Error("No synthesizer configuration loaded.");case 1:if(!window.AppConfig.isWeb){e.n=2;break}return e.a(2,new Promise(function(e,t){var n=document.createElement("input");n.type="file",n.accept=".json,.patch.json",n.onchange=function(n){var r=n.target.files[0];if(r){var i=new FileReader;i.onload=function(n){try{var i=JSON.parse(n.target.result);if(!i.version||!i.parameters)return void t(new Error("Invalid patch file."));window.uiManager.loadControlValues(i.parameters),e({success:!0,patchName:r.name})}catch(e){t(new Error("Error reading patch file: "+e.message))}},i.readAsText(r)}else e({success:!1})},n.click()}));case 2:return e.n=3,Q.invoke("show-open-dialog",{title:"Import Patch",defaultPath:this.configManager.userConfig.lastPatchFolder,filters:[{name:"Patch Files",extensions:["patch.json","json"]}],properties:["openFile"]});case 3:if(n=e.v){e.n=4;break}return e.a(2,{success:!1});case 4:if((r=JSON.parse(Y.readFileSync(n,"utf8"))).version&&r.parameters){e.n=5;break}throw new Error("Invalid patch file.");case 5:return i=window.uiManager.currentConfig,o=r.synthesizer&&(r.synthesizer.name!==i.name||r.synthesizer.manufacturer!==i.manufacturer),window.uiManager.loadControlValues(r.parameters),this.configManager.userConfig.lastPatchFolder=X.dirname(n),this.configManager.saveUserConfig(),a=r.parameters.patch_name&&"string"==typeof r.parameters.patch_name?r.parameters.patch_name.trim():"Imported patch",e.a(2,{success:!0,patchName:a,synthMismatch:o});case 6:return e.a(2)}},e,this)})),function(){return n.apply(this,arguments)})},{key:"validatePatch",value:function(e){if(!e||"object"!==H(e))throw new Error("Invalid patch format");if(!e.version)throw new Error("Patch missing version information");if(!e.parameters||"object"!==H(e.parameters))throw new Error("Patch missing parameters");return!0}}],t&&$(e.prototype,t),Object.defineProperty(e,"prototype",{writable:!1}),e;var e,t,n,r}();function te(e){return te="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},te(e)}function ne(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,re(r.key),r)}}function re(e){var t=function(e){if("object"!=te(e)||!e)return e;var t=e[Symbol.toPrimitive];if(void 0!==t){var n=t.call(e,"string");if("object"!=te(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"==te(t)?t:t+""}const ie=function(){return e=function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e)},t=[{key:"showConfirm",value:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"Yes",r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:"No",i=document.createElement("div");i.className="dialog-overlay";var o=document.createElement("div");o.className="dialog-content",o.innerHTML='\n            <div style="margin-bottom: 20px; text-align: center;">'.concat(e,'</div>\n            <div style="display: flex; gap: 10px; justify-content: center;">\n                <button id="no-btn" class="btn-secondary">').concat(r,'</button>\n                <button id="yes-btn" class="btn-primary">').concat(n,"</button>\n            </div>\n        "),document.body.appendChild(i),i.appendChild(o);var a=function(e){document.body.removeChild(i),t(e)};o.querySelector("#no-btn").addEventListener("click",function(){return a(!1)}),o.querySelector("#yes-btn").addEventListener("click",function(){return a(!0)}),o.querySelector("#yes-btn").focus()}},{key:"showConfirmPromise",value:function(e){var t=this,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"Yes",r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"No";return new Promise(function(i){return t.showConfirm(e,i,n,r)})}},{key:"showTextInput",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"",n=arguments.length>2?arguments[2]:void 0,r=document.createElement("div");r.className="dialog-overlay";var i=document.createElement("div");i.className="dialog-content",i.innerHTML='\n            <h3 style="margin: 0 0 15px 0;">'.concat(e,'</h3>\n            <input id="text-input" type="text" value="').concat(t,'" class="control-input" style="width: 100%; margin-bottom: 15px;">\n            <div style="text-align: right; gap: 10px; display: flex; justify-content: flex-end;">\n                <button id="cancel-btn" class="btn-secondary">Cancel</button>\n                <button id="ok-btn" class="btn-primary">OK</button>\n            </div>\n        '),document.body.appendChild(r),r.appendChild(i);var o=i.querySelector("#text-input");setTimeout(function(){o.focus(),o.select()},10);var a=function(e){document.body.removeChild(r),n(e)};i.querySelector("#cancel-btn").addEventListener("click",function(){return a(null)}),i.querySelector("#ok-btn").addEventListener("click",function(){var e=o.value.trim();a(e||null)}),o.addEventListener("keydown",function(e){"Enter"===e.key&&i.querySelector("#ok-btn").click(),"Escape"===e.key&&i.querySelector("#cancel-btn").click()})}},{key:"showTextInputPromise",value:function(e){var t=this,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"";return new Promise(function(r){return t.showTextInput(e,n,r)})}},{key:"showAlert",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"Alert",n=document.createElement("div");n.className="dialog-overlay";var r=document.createElement("div");r.className="dialog-content",r.innerHTML='\n            <h3 style="margin: 0 0 15px 0;">'.concat(t,'</h3>\n            <div style="margin-bottom: 20px;">').concat(e,'</div>\n            <div style="text-align: right;">\n                <button id="ok-btn" class="btn-primary">OK</button>\n            </div>\n        '),document.body.appendChild(n),n.appendChild(r);var i=function(){document.body.removeChild(n)};r.querySelector("#ok-btn").addEventListener("click",i),r.querySelector("#ok-btn").focus();var o=function(e){"Escape"===e.key&&(i(),document.removeEventListener("keydown",o))};document.addEventListener("keydown",o)}}],t&&ne(e.prototype,t),Object.defineProperty(e,"prototype",{writable:!1}),e;var e,t}();function oe(e){return oe="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},oe(e)}function ae(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,ce(r.key),r)}}function ce(e){var t=function(e){if("object"!=oe(e)||!e)return e;var t=e[Symbol.toPrimitive];if(void 0!==t){var n=t.call(e,"string");if("object"!=oe(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"==oe(t)?t:t+""}const se=function(){return e=function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e)},t=[{key:"getContainer",value:function(){return this.container||(this.container=document.getElementById("notification-container")),this.container}},{key:"show",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"info",n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:3e3,r=this.getContainer();if(r){var i=document.createElement("div");i.className="notification ".concat(t),i.textContent=e,i.style.cursor="pointer";var o=function(){r.contains(i)&&(i.classList.remove("show"),setTimeout(function(){r.contains(i)&&r.removeChild(i)},300))};i.addEventListener("click",o),r.appendChild(i),setTimeout(function(){return i.classList.add("show")},10),setTimeout(o,n)}else console.warn("Notification container not found")}},{key:"success",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:3e3;this.show(e,"success",t)}},{key:"error",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:5e3;this.show(e,"error",t)}},{key:"warning",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:4e3;this.show(e,"warning",t)}},{key:"info",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:3e3;this.show(e,"info",t)}},{key:"clear",value:function(){var e=this.getContainer();e&&(e.innerHTML="")}}],t&&ae(e.prototype,t),Object.defineProperty(e,"prototype",{writable:!1}),e;var e,t}();function le(e){return le="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},le(e)}function ue(){var e,t,n="function"==typeof Symbol?Symbol:{},r=n.iterator||"@@iterator",i=n.toStringTag||"@@toStringTag";function o(n,r,i,o){var s=r&&r.prototype instanceof c?r:c,l=Object.create(s.prototype);return de(l,"_invoke",function(n,r,i){var o,c,s,l=0,u=i||[],d=!1,f={p:0,n:0,v:e,a:m,f:m.bind(e,4),d:function(t,n){return o=t,c=0,s=e,f.n=n,a}};function m(n,r){for(c=n,s=r,t=0;!d&&l&&!i&&t<u.length;t++){var i,o=u[t],m=f.p,v=o[2];n>3?(i=v===r)&&(s=o[(c=o[4])?5:(c=3,3)],o[4]=o[5]=e):o[0]<=m&&((i=n<2&&m<o[1])?(c=0,f.v=r,f.n=o[1]):m<v&&(i=n<3||o[0]>r||r>v)&&(o[4]=n,o[5]=r,f.n=v,c=0))}if(i||n>1)return a;throw d=!0,r}return function(i,u,v){if(l>1)throw TypeError("Generator is already running");for(d&&1===u&&m(u,v),c=u,s=v;(t=c<2?e:s)||!d;){o||(c?c<3?(c>1&&(f.n=-1),m(c,s)):f.n=s:f.v=s);try{if(l=2,o){if(c||(i="next"),t=o[i]){if(!(t=t.call(o,s)))throw TypeError("iterator result is not an object");if(!t.done)return t;s=t.value,c<2&&(c=0)}else 1===c&&(t=o.return)&&t.call(o),c<2&&(s=TypeError("The iterator does not provide a '"+i+"' method"),c=1);o=e}else if((t=(d=f.n<0)?s:n.call(r,f))!==a)break}catch(t){o=e,c=1,s=t}finally{l=1}}return{value:t,done:d}}}(n,i,o),!0),l}var a={};function c(){}function s(){}function l(){}t=Object.getPrototypeOf;var u=[][r]?t(t([][r]())):(de(t={},r,function(){return this}),t),d=l.prototype=c.prototype=Object.create(u);function f(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,l):(e.__proto__=l,de(e,i,"GeneratorFunction")),e.prototype=Object.create(d),e}return s.prototype=l,de(d,"constructor",l),de(l,"constructor",s),s.displayName="GeneratorFunction",de(l,i,"GeneratorFunction"),de(d),de(d,i,"Generator"),de(d,r,function(){return this}),de(d,"toString",function(){return"[object Generator]"}),(ue=function(){return{w:o,m:f}})()}function de(e,t,n,r){var i=Object.defineProperty;try{i({},"",{})}catch(e){i=0}de=function(e,t,n,r){function o(t,n){de(e,t,function(e){return this._invoke(t,n,e)})}t?i?i(e,t,{value:n,enumerable:!r,configurable:!r,writable:!r}):e[t]=n:(o("next",0),o("throw",1),o("return",2))},de(e,t,n,r)}function fe(e,t,n,r,i,o,a){try{var c=e[o](a),s=c.value}catch(e){return void n(e)}c.done?t(s):Promise.resolve(s).then(r,i)}function me(e){return function(){var t=this,n=arguments;return new Promise(function(r,i){var o=e.apply(t,n);function a(e){fe(o,r,i,a,c,"next",e)}function c(e){fe(o,r,i,a,c,"throw",e)}a(void 0)})}}function ve(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,pe(r.key),r)}}function pe(e){var t=function(e){if("object"!=le(e)||!e)return e;var t=e[Symbol.toPrimitive];if(void 0!==t){var n=t.call(e,"string");if("object"!=le(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"==le(t)?t:t+""}var he;if("undefined"!=typeof window&&window.require)try{he=window.require("fs")}catch(e){console.warn("Node integration not available")}var ye=function(){return e=function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.isDialogOpen=!1,this.configManager=new R,this.dialogManager=new ie,this.notificationManager=new se,this.patchManager=new ee(this.configManager),this.sysExHandler=new P(this),"undefined"!=typeof window&&window.require&&this.initialize()},t=[{key:"initialize",value:(l=me(ue().m(function e(){return ue().w(function(e){for(;;)switch(e.n){case 0:return this.configureWebUI(),e.n=1,window.midiManager.initialize();case 1:if(this.setupEventListeners(),this.updateMIDIStatus(),this.initializeMIDIChannelSelector(),this.attemptAutoConnect(),!window.AppConfig.autoLoadDefaultConfig){e.n=3;break}return e.n=2,this.loadConfigFromPath(window.AppConfig.defaultConfigPath);case 2:e.n=4;break;case 3:if(!(this.configManager.userConfig.lastConfigFile&&he&&he.existsSync&&he.existsSync(this.configManager.userConfig.lastConfigFile))){e.n=4;break}return e.n=4,this.loadConfigFromPath(this.configManager.userConfig.lastConfigFile);case 4:window.addEventListener("beforeunload",function(){window.midiManager.isConnected&&window.midiManager.disconnect()});case 5:return e.a(2)}},e,this)})),function(){return l.apply(this,arguments)})},{key:"setupEventListeners",value:function(){var e=this;document.getElementById("connect-midi").addEventListener("click",function(){return e.handleMIDIButtonClick()}),document.getElementById("midi-channel").addEventListener("change",function(t){return e.handleMIDIChannelChange(t)}),document.getElementById("load-config-header").addEventListener("click",function(){return e.loadConfigFile()}),document.getElementById("load-config").addEventListener("click",function(){return e.loadConfigFile()}),document.getElementById("reset-all-defaults").addEventListener("click",function(){window.uiManager&&e.dialogManager.showConfirm("Send init patch to synthesizer? This will reset all parameters to default values.",function(e){e&&window.uiManager.sendInitPatch()})}),document.getElementById("get-patch").addEventListener("click",function(){e.getPatchFromSynth()}),document.getElementById("send-all-parameters").addEventListener("click",function(){window.uiManager&&e.dialogManager.showConfirm("Send all parameters to your synthesizer?",function(e){e&&window.uiManager.sendAllParameters()})}),document.getElementById("export-patch").addEventListener("click",function(){return e.exportPatch()}),document.getElementById("import-patch").addEventListener("click",function(){return e.importPatch()}),document.getElementById("toggle-monitor").addEventListener("click",function(){return e.toggleMIDIMonitor()}),document.getElementById("clear-monitor").addEventListener("click",function(){return e.clearMIDIMonitor()}),document.getElementById("expand-monitor").addEventListener("click",function(){return e.showMIDITesterModal()}),document.getElementById("close-midi-tester").addEventListener("click",function(){return e.closeMIDITesterModal()}),document.getElementById("help-mode-toggle").addEventListener("click",function(){return e.toggleHelpMode()}),document.querySelectorAll(".tester-tab").forEach(function(t){t.addEventListener("click",function(){return e.switchTesterTab(t.dataset.tab)})}),document.getElementById("modal-clear-monitor").addEventListener("click",function(){return e.clearModalMIDIMonitor()}),this.setupCCTester(),this.setupCCPairTester(),this.setupNRPNTester(),this.setupSysExTester(),this.setupProgramTester(),this.sysExHandler.setupDumpReceiver(),window.addEventListener("resize",function(){return e.updateMIDIStatus()})}},{key:"configureWebUI",value:function(){var e=[];window.AppConfig.showLoadConfigButton||e.push(document.getElementById("load-config-header"),document.getElementById("load-config"),document.getElementById("dump-mapping-status"),document.getElementById("welcome")),e.forEach(function(e){e&&(e.style.display="none")})}},{key:"showMIDIDeviceDialog",value:(s=me(ue().m(function e(){var t,n,r,i,o,a,c,s,l,u=this;return ue().w(function(e){for(;;)switch(e.n){case 0:if(!this.isDialogOpen){e.n=1;break}return e.a(2);case 1:this.isDialogOpen=!0;try{t=[],n=[],window.midiManager.midiAccess&&(t=Array.from(window.midiManager.midiAccess.outputs.values()),n=Array.from(window.midiManager.midiAccess.inputs.values())),(r=document.createElement("div")).className="dialog-overlay",(i=document.createElement("div")).className="dialog-content",i.innerHTML='\n                <h3 style="margin: 0 0 15px 0;">Select MIDI Devices</h3>\n                <h4 style="margin: 10px 0 5px 0;">Output Devices:</h4>\n                <select id="midi-output-select" style="width: 100%; padding: 5px; background: #3a3a3a; color: white; border: 1px solid #4a4a4a;"></select>\n                <div id="input-device-section"></div>\n                <div id="connection-status" style="margin: 10px 0; min-height: 20px;"></div>\n                <div style="text-align: right; margin-top: 15px;">\n                    <button id="cancel-midi" style="margin-right: 10px; background: #666; color: white; border: none; padding: 8px 16px; border-radius: 4px; cursor: pointer;">Cancel</button>\n                    <button id="connect-midi-button" style="background: #4a90e2; color: white; border: none; padding: 8px 16px; border-radius: 4px; cursor: pointer;">Connect</button>\n                </div>\n            ',document.body.appendChild(r),r.appendChild(i),o=i.querySelector("#midi-output-select"),a=i.querySelector("#input-device-section"),c=i.querySelector("#connection-status"),o.innerHTML='<option value="">Select output device...</option>',t.forEach(function(e){var t=document.createElement("option");t.value=e.id,t.textContent=e.name,o.appendChild(t)}),n.length>0&&(a.innerHTML='\n                    <h4 style="margin: 10px 0 5px 0;">Input Device (Optional):</h4>\n                    <select id="midi-input-select" style="width: 100%; padding: 5px; background: #3a3a3a; color: white; border: 1px solid #4a4a4a;">\n                        <option value="">No input device</option>\n                    </select>\n                ',s=i.querySelector("#midi-input-select"),n.forEach(function(e){var t=document.createElement("option");t.value=e.id,t.textContent=e.name,s.appendChild(t)}),this.configManager.userConfig.lastMidiInput&&(s.value=this.configManager.userConfig.lastMidiInput)),this.configManager.userConfig.lastMidiOutput&&(o.value=this.configManager.userConfig.lastMidiOutput),l=function(){document.body.removeChild(r),u.isDialogOpen=!1},i.querySelector("#connect-midi-button").addEventListener("click",me(ue().m(function e(){var t,n,r,a,s,d;return ue().w(function(e){for(;;)switch(e.p=e.n){case 0:if(n=o.value,r=(null===(t=i.querySelector("#midi-input-select"))||void 0===t?void 0:t.value)||null,n){e.n=1;break}return c.textContent="Please select an output device.",c.style.color="#e74c3c",e.a(2);case 1:return e.p=1,c.textContent="Connecting...",c.style.color="#4a90e2",e.n=2,window.midiManager.connectOutput(n);case 2:if(!r){e.n=3;break}return e.n=3,window.midiManager.connectInput(r);case 3:u.configManager.userConfig.lastMidiOutput=n,u.configManager.userConfig.lastMidiInput=r,u.configManager.saveUserConfig(),u.updateMIDIStatus(),s=(null===(a=window.midiManager.outputDevice)||void 0===a?void 0:a.name)||"MIDI device",u.notificationManager.success("Connected to ".concat(s)),l(),e.n=5;break;case 4:e.p=4,d=e.v,c.textContent="Connection failed: "+d.message,c.style.color="#e74c3c";case 5:return e.a(2)}},e,null,[[1,4]])}))),i.querySelector("#cancel-midi").addEventListener("click",l)}catch(e){this.notificationManager.error("Error accessing MIDI devices: "+e.message)}case 2:return e.a(2)}},e,this)})),function(){return s.apply(this,arguments)})},{key:"handleMIDIButtonClick",value:function(){window.midiManager.isConnected?(window.midiManager.disconnect(),this.updateMIDIStatus(),this.notificationManager.info("MIDI device disconnected")):this.showMIDIDeviceDialog()}},{key:"handleMIDIChannelChange",value:function(e){var t=parseInt(e.target.value);window.midiManager.setChannel(t),this.configManager.saveUserSetting("midiChannel",t)}},{key:"initializeMIDIChannelSelector",value:function(){var e=document.getElementById("midi-channel"),t=this.configManager.userConfig.midiChannel||1;e.value=t,window.midiManager.setChannel(t)}},{key:"updateMIDIStatus",value:function(){var e=document.getElementById("midi-status"),t=document.getElementById("connect-midi");if(window.midiManager.isConnected){var n,r=(null===(n=window.midiManager.outputDevice)||void 0===n?void 0:n.name)||"Unknown Device";e.textContent="MIDI: ".concat(r),t.textContent="Disconnect"}else e.textContent="MIDI: Disconnected",t.textContent="Connect"}},{key:"loadConfigFile",value:(c=me(ue().m(function e(){var t,n;return ue().w(function(e){for(;;)switch(e.p=e.n){case 0:return e.p=0,e.n=1,this.configManager.loadConfigFile();case 1:if(!(t=e.v)){e.n=2;break}return e.n=2,this.loadSynthConfig(t.config);case 2:e.n=4;break;case 3:e.p=3,n=e.v,this.notificationManager.error(n.message);case 4:return e.a(2)}},e,this,[[0,3]])})),function(){return c.apply(this,arguments)})},{key:"loadConfigFromPath",value:(a=me(ue().m(function e(t){var n,r;return ue().w(function(e){for(;;)switch(e.p=e.n){case 0:return e.p=0,e.n=1,this.configManager.loadConfigFromPath(t);case 1:(n=e.v)&&(window.uiManager.loadConfig(n),window.AppConfig.isWeb?(document.title="ArcSynth Editor - ".concat(n.name),document.querySelector("header h1").textContent="ArcSynth Editor - ".concat(n.name)):document.title="ArcSynth Editor - ".concat(n.name),this.sysExHandler.checkDumpMappingAvailability()),e.n=3;break;case 2:e.p=2,r=e.v,console.error("Error auto-loading config:",r);case 3:return e.a(2)}},e,this,[[0,2]])})),function(e){return a.apply(this,arguments)})},{key:"loadSynthConfig",value:(o=me(ue().m(function e(t){return ue().w(function(e){for(;;)switch(e.n){case 0:if(!(this.sysExHandler.baselineSysEx||Object.keys(this.sysExHandler.mappingResults).length>0)){e.n=2;break}return e.n=1,this.dialogManager.showConfirmPromise("Loading a new config will reset the SysEx mapping session. Continue?");case 1:if(e.v){e.n=2;break}return e.a(2);case 2:window.uiManager.loadConfig(t),window.AppConfig.isWeb?(document.title="ArcSynth Editor - ".concat(t.name),document.querySelector("header h1").textContent="ArcSynth Editor - ".concat(t.name)):document.title="ArcSynth Editor - ".concat(t.name),this.sysExHandler.checkDumpMappingAvailability();case 3:return e.a(2)}},e,this)})),function(e){return o.apply(this,arguments)})},{key:"toggleMIDIMonitor",value:function(){var e=document.getElementById("midi-monitor-content"),t=document.getElementById("toggle-monitor");e.classList.toggle("hidden"),t.textContent=e.classList.contains("hidden")?"Show":"Hide",e.classList.contains("hidden")||(e.scrollTop=e.scrollHeight)}},{key:"clearMIDIMonitor",value:function(){var e=document.getElementById("midi-log");e&&(e.innerHTML="")}},{key:"attemptAutoConnect",value:function(){var e=this.configManager.userConfig,t=e.lastMidiOutput,n=e.lastMidiInput;t&&window.midiManager.midiAccess&&Array.from(window.midiManager.midiAccess.outputs.values()).find(function(e){return e.id===t})&&(window.midiManager.connectOutput(t),this.updateMIDIStatus(),this.configManager.saveUserConfig()),n&&window.midiManager.midiAccess&&Array.from(window.midiManager.midiAccess.inputs.values()).find(function(e){return e.id===n})&&window.midiManager.connectInput(n)}},{key:"exportPatch",value:(i=me(ue().m(function e(){var t,n;return ue().w(function(e){for(;;)switch(e.p=e.n){case 0:return e.p=0,e.n=1,this.patchManager.exportPatch();case 1:(t=e.v).success&&this.notificationManager.success('Patch "'.concat(t.patchName,'" exported!')),e.n=3;break;case 2:e.p=2,n=e.v,this.notificationManager.error(n.message);case 3:return e.a(2)}},e,this,[[0,2]])})),function(){return i.apply(this,arguments)})},{key:"importPatch",value:(r=me(ue().m(function e(){var t,n;return ue().w(function(e){for(;;)switch(e.p=e.n){case 0:return e.p=0,e.n=1,this.patchManager.importPatch();case 1:if(!(t=e.v).success){e.n=4;break}if(!t.synthMismatch){e.n=3;break}return e.n=2,this.dialogManager.showConfirmPromise("Patch is for a different synth. Continue anyway?");case 2:if(e.v){e.n=3;break}return e.a(2);case 3:this.notificationManager.success('Patch "'.concat(t.patchName,'" loaded!')),t.shouldSendToSynth&&this.dialogManager.showConfirm("Send all parameters to synth?",function(e){e&&window.uiManager.sendAllParameters()});case 4:e.n=6;break;case 5:e.p=5,n=e.v,this.notificationManager.error(n.message);case 6:return e.a(2)}},e,this,[[0,5]])})),function(){return r.apply(this,arguments)})},{key:"showMIDITesterModal",value:function(){document.getElementById("midi-tester-modal").classList.remove("hidden"),this.syncMIDILogToModal()}},{key:"closeMIDITesterModal",value:function(){document.getElementById("midi-tester-modal").classList.add("hidden")}},{key:"switchTesterTab",value:function(e){document.querySelectorAll(".tester-tab").forEach(function(t){return t.classList.toggle("active",t.dataset.tab===e)}),document.querySelectorAll(".tester-content").forEach(function(t){return t.classList.toggle("active",t.id==="".concat(e,"-tester"))})}},{key:"setupCCTester",value:function(){var e=this,t=document.getElementById("cc-value"),n=document.getElementById("cc-value-slider");t.addEventListener("input",function(){return n.value=t.value}),n.addEventListener("input",function(){return t.value=n.value}),document.getElementById("send-cc").addEventListener("click",function(){if(!window.midiManager.isConnected)return e.notificationManager.warning("Not connected.");var n=parseInt(document.getElementById("cc-channel").value),r=window.midiManager.currentChannel;window.midiManager.currentChannel=n,window.midiManager.sendCC(parseInt(document.getElementById("cc-number").value),parseInt(t.value)),window.midiManager.currentChannel=r})}},{key:"setupCCPairTester",value:function(){var e=this,t=document.getElementById("cc-pair-value"),n=document.getElementById("cc-pair-value-slider");t.addEventListener("input",function(){return n.value=t.value}),n.addEventListener("input",function(){return t.value=n.value}),document.getElementById("send-cc-pair").addEventListener("click",function(){if(!window.midiManager.isConnected)return e.notificationManager.warning("Not connected.");var n=parseInt(document.getElementById("cc-pair-channel").value),r=window.midiManager.currentChannel;window.midiManager.currentChannel=n,window.midiManager.sendCCPair(parseInt(document.getElementById("cc-pair-msb").value),parseInt(document.getElementById("cc-pair-lsb").value),parseInt(t.value)),window.midiManager.currentChannel=r})}},{key:"setupNRPNTester",value:function(){var e=this,t=document.getElementById("nrpn-value-msb"),n=document.getElementById("nrpn-value-msb-slider"),r=document.getElementById("nrpn-value-lsb"),i=document.getElementById("nrpn-value-lsb-slider");t.addEventListener("input",function(){return n.value=t.value}),n.addEventListener("input",function(){return t.value=n.value}),r.addEventListener("input",function(){return i.value=r.value}),i.addEventListener("input",function(){return r.value=i.value}),document.getElementById("send-nrpn").addEventListener("click",function(){if(!window.midiManager.isConnected)return e.notificationManager.warning("Not connected.");var n=parseInt(document.getElementById("nrpn-channel").value),i=window.midiManager.currentChannel;window.midiManager.currentChannel=n,window.midiManager.sendNRPN(parseInt(document.getElementById("nrpn-msb").value),parseInt(document.getElementById("nrpn-lsb").value),parseInt(t.value),parseInt(r.value),document.getElementById("nrpn-exclude-lsb").checked),window.midiManager.currentChannel=i})}},{key:"setupSysExTester",value:function(){var e=this;document.getElementById("send-sysex").addEventListener("click",function(){if(!window.midiManager.isConnected)return e.notificationManager.warning("Not connected.");var t=document.getElementById("sysex-data").value.trim();if(!t)return e.notificationManager.warning("SysEx data required.");var n=t.split(/\s+/).map(function(e){return e.toUpperCase()});if("F0"!==n[0]&&n.unshift("F0"),"F7"!==n[n.length-1]&&n.push("F7"),n.some(function(e){return!/^[0-9A-F]{1,2}$/.test(e)}))return e.notificationManager.error("Invalid hex byte found.");window.midiManager.sendSysEx(n.join(" "))})}},{key:"setupProgramTester",value:function(){var e=this,t=document.getElementById("program-number"),n=document.getElementById("program-number-slider");t.addEventListener("input",function(){return n.value=t.value}),n.addEventListener("input",function(){return t.value=n.value});var r=function(n){if(!window.midiManager.isConnected)return e.notificationManager.warning("Not connected.");var r=parseInt(document.getElementById("program-channel").value),i=window.midiManager.currentChannel;window.midiManager.currentChannel=r;var o=parseInt(t.value),a=parseInt(document.getElementById("bank-msb").value),c=parseInt(document.getElementById("bank-lsb").value);"all"!==n&&"bank"!==n||(document.getElementById("send-bank-msb").checked&&window.midiManager.sendCC(0,a),document.getElementById("send-bank-lsb").checked&&window.midiManager.sendCC(32,c)),"all"!==n&&"program"!==n||window.midiManager.sendProgramChange(o),window.midiManager.currentChannel=i};document.getElementById("send-program-only").addEventListener("click",function(){return r("program")}),document.getElementById("send-bank-only").addEventListener("click",function(){return r("bank")}),document.getElementById("send-program-change").addEventListener("click",function(){return r("all")})}},{key:"syncMIDILogToModal",value:function(){var e=document.getElementById("midi-log"),t=document.getElementById("modal-midi-log");e&&t&&(t.innerHTML=e.innerHTML,t.scrollTop=t.scrollHeight)}},{key:"clearModalMIDIMonitor",value:function(){var e=document.getElementById("modal-midi-log");e&&(e.innerHTML="")}},{key:"getPatchFromSynth",value:(n=me(ue().m(function e(){var t;return ue().w(function(e){for(;;)switch(e.p=e.n){case 0:return e.p=0,e.n=1,this.sysExHandler.getDumpFromSynth();case 1:e.n=3;break;case 2:e.p=2,t=e.v,this.notificationManager.error("Error getting patch from synth: "+t.message);case 3:return e.a(2)}},e,this,[[0,2]])})),function(){return n.apply(this,arguments)})},{key:"toggleHelpMode",value:function(){window.uiManager&&window.uiManager.toggleHelpMode()}}],t&&ve(e.prototype,t),Object.defineProperty(e,"prototype",{writable:!1}),e;var e,t,n,r,i,o,a,c,s,l}();function ge(){var e,t,n="function"==typeof Symbol?Symbol:{},r=n.iterator||"@@iterator",i=n.toStringTag||"@@toStringTag";function o(n,r,i,o){var s=r&&r.prototype instanceof c?r:c,l=Object.create(s.prototype);return be(l,"_invoke",function(n,r,i){var o,c,s,l=0,u=i||[],d=!1,f={p:0,n:0,v:e,a:m,f:m.bind(e,4),d:function(t,n){return o=t,c=0,s=e,f.n=n,a}};function m(n,r){for(c=n,s=r,t=0;!d&&l&&!i&&t<u.length;t++){var i,o=u[t],m=f.p,v=o[2];n>3?(i=v===r)&&(s=o[(c=o[4])?5:(c=3,3)],o[4]=o[5]=e):o[0]<=m&&((i=n<2&&m<o[1])?(c=0,f.v=r,f.n=o[1]):m<v&&(i=n<3||o[0]>r||r>v)&&(o[4]=n,o[5]=r,f.n=v,c=0))}if(i||n>1)return a;throw d=!0,r}return function(i,u,v){if(l>1)throw TypeError("Generator is already running");for(d&&1===u&&m(u,v),c=u,s=v;(t=c<2?e:s)||!d;){o||(c?c<3?(c>1&&(f.n=-1),m(c,s)):f.n=s:f.v=s);try{if(l=2,o){if(c||(i="next"),t=o[i]){if(!(t=t.call(o,s)))throw TypeError("iterator result is not an object");if(!t.done)return t;s=t.value,c<2&&(c=0)}else 1===c&&(t=o.return)&&t.call(o),c<2&&(s=TypeError("The iterator does not provide a '"+i+"' method"),c=1);o=e}else if((t=(d=f.n<0)?s:n.call(r,f))!==a)break}catch(t){o=e,c=1,s=t}finally{l=1}}return{value:t,done:d}}}(n,i,o),!0),l}var a={};function c(){}function s(){}function l(){}t=Object.getPrototypeOf;var u=[][r]?t(t([][r]())):(be(t={},r,function(){return this}),t),d=l.prototype=c.prototype=Object.create(u);function f(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,l):(e.__proto__=l,be(e,i,"GeneratorFunction")),e.prototype=Object.create(d),e}return s.prototype=l,be(d,"constructor",l),be(l,"constructor",s),s.displayName="GeneratorFunction",be(l,i,"GeneratorFunction"),be(d),be(d,i,"Generator"),be(d,r,function(){return this}),be(d,"toString",function(){return"[object Generator]"}),(ge=function(){return{w:o,m:f}})()}function be(e,t,n,r){var i=Object.defineProperty;try{i({},"",{})}catch(e){i=0}be=function(e,t,n,r){function o(t,n){be(e,t,function(e){return this._invoke(t,n,e)})}t?i?i(e,t,{value:n,enumerable:!r,configurable:!r,writable:!r}):e[t]=n:(o("next",0),o("throw",1),o("return",2))},be(e,t,n,r)}function we(e,t,n,r,i,o,a){try{var c=e[o](a),s=c.value}catch(e){return void n(e)}c.done?t(s):Promise.resolve(s).then(r,i)}function Ce(e){return function(){var t=this,n=arguments;return new Promise(function(r,i){var o=e.apply(t,n);function a(e){we(o,r,i,a,c,"next",e)}function c(e){we(o,r,i,a,c,"throw",e)}a(void 0)})}}"undefined"!=typeof window&&window.require&&(window.synthEditor=new ye),window.AppConfig=t,window.logger=g,window.logError=function(e){return g.error(e)},window.logWarn=function(e){return g.warn(e)},window.logInfo=function(e){return g.info(e)},window.logDebug=function(e){return g.debug(e)};var Ee=function(){var e=new URLSearchParams(window.location.search).get("config");if(!e){var t=new URL(window.location);return t.searchParams.set("config","novation-summit"),window.history.replaceState({},"",t),"configs/novation-summit.json"}var n={"novation-summit":"configs/novation-summit.json","example-synth":"configs/example-synth.json"};if(n[e])return n[e];var r=new URL(window.location);return r.searchParams.set("config","novation-summit"),window.history.replaceState({},"",r),"configs/novation-summit.json"}();window.AppConfig.defaultConfigPath=Ee;var Me=new URLSearchParams(window.location.search).get("config");if(Me){var Se={"novation-summit":"Novation Summit","example-synth":"Example Synth"}[Me]||Me;document.title="ArcSynth Editor - ".concat(Se)}"loading"===document.readyState?document.addEventListener("DOMContentLoaded",Ce(ge().m(function e(){return ge().w(function(e){for(;;)switch(e.n){case 0:return window.synthEditor=new ye,e.n=1,window.synthEditor.initialize();case 1:return e.a(2)}},e)}))):(window.synthEditor=new ye,window.synthEditor.initialize()),console.log("ArcSynth Editor (Web) initialized")})()})();